!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).RongIMLib={})}(this,(function(e){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(e){return e&&e.Math==Math&&e},r=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||function(){return this}()||Function("return this")(),i={},o=function(e){try{return!!e()}catch(e){return!0}},s=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a=!o((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),c=a,u=Function.prototype.call,l=c?u.bind(u):function(){return u.apply(u,arguments)},h={},d={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,p=f&&!d.call({1:2},1);h.f=p?function(e){var t=f(this,e);return!!t&&t.enumerable}:d;var v,y,m=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_=a,C=Function.prototype,E=C.bind,T=C.call,I=_&&E.bind(T,T),R=_?function(e){return e&&I(e)}:function(e){return e&&function(){return T.apply(e,arguments)}},S=R,M=S({}.toString),N=S("".slice),O=function(e){return N(M(e),8,-1)},w=R,A=o,U=O,b=r.Object,L=w("".split),P=A((function(){return!b("z").propertyIsEnumerable(0)}))?function(e){return"String"==U(e)?L(e,""):b(e)}:b,D=r.TypeError,x=function(e){if(null==e)throw D("Can't call method on "+e);return e},k=P,V=x,B=function(e){return k(V(e))},G=function(e){return"function"==typeof e},F=G,K=function(e){return"object"==typeof e?null!==e:F(e)},q=r,H=G,j=function(e){return H(e)?e:void 0},Y=function(e,t){return arguments.length<2?j(q[e]):q[e]&&q[e][t]},W=R({}.isPrototypeOf),Q=Y("navigator","userAgent")||"",J=r,z=Q,X=J.process,Z=J.Deno,$=X&&X.versions||Z&&Z.version,ee=$&&$.v8;ee&&(y=(v=ee.split("."))[0]>0&&v[0]<4?1:+(v[0]+v[1])),!y&&z&&(!(v=z.match(/Edge\/(\d+)/))||v[1]>=74)&&(v=z.match(/Chrome\/(\d+)/))&&(y=+v[1]);var te=y,ne=te,re=o,ie=!!Object.getOwnPropertySymbols&&!re((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ne&&ne<41})),oe=ie&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,se=Y,ae=G,ce=W,ue=oe,le=r.Object,he=ue?function(e){return"symbol"==typeof e}:function(e){var t=se("Symbol");return ae(t)&&ce(t.prototype,le(e))},de=r.String,fe=function(e){try{return de(e)}catch(e){return"Object"}},pe=G,ge=fe,ve=r.TypeError,ye=function(e){if(pe(e))return e;throw ve(ge(e)+" is not a function")},me=ye,_e=function(e,t){var n=e[t];return null==n?void 0:me(n)},Ce=l,Ee=G,Te=K,Ie=r.TypeError,Re={exports:{}},Se=r,Me=Object.defineProperty,Ne=function(e,t){try{Me(Se,e,{value:t,configurable:!0,writable:!0})}catch(n){Se[e]=t}return t},Oe=Ne,we="__core-js_shared__",Ae=r[we]||Oe(we,{}),Ue=Ae;(Re.exports=function(e,t){return Ue[e]||(Ue[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.22.3",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.22.3/LICENSE",source:"https://github.com/zloirock/core-js"});var be=x,Le=r.Object,Pe=function(e){return Le(be(e))},De=Pe,xe=R({}.hasOwnProperty),ke=Object.hasOwn||function(e,t){return xe(De(e),t)},Ve=R,Be=0,Ge=Math.random(),Fe=Ve(1..toString),Ke=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Fe(++Be+Ge,36)},qe=r,He=Re.exports,je=ke,Ye=Ke,We=ie,Qe=oe,Je=He("wks"),ze=qe.Symbol,Xe=ze&&ze.for,Ze=Qe?ze:ze&&ze.withoutSetter||Ye,$e=function(e){if(!je(Je,e)||!We&&"string"!=typeof Je[e]){var t="Symbol."+e;We&&je(ze,e)?Je[e]=ze[e]:Je[e]=Qe&&Xe?Xe(t):Ze(t)}return Je[e]},et=l,nt=K,rt=he,it=_e,ot=function(e,t){var n,r;if("string"===t&&Ee(n=e.toString)&&!Te(r=Ce(n,e)))return r;if(Ee(n=e.valueOf)&&!Te(r=Ce(n,e)))return r;if("string"!==t&&Ee(n=e.toString)&&!Te(r=Ce(n,e)))return r;throw Ie("Can't convert object to primitive value")},st=$e,at=r.TypeError,ct=st("toPrimitive"),ut=function(e,t){if(!nt(e)||rt(e))return e;var n,r=it(e,ct);if(r){if(void 0===t&&(t="default"),n=et(r,e,t),!nt(n)||rt(n))return n;throw at("Can't convert object to primitive value")}return void 0===t&&(t="number"),ot(e,t)},lt=ut,ht=he,dt=function(e){var t=lt(e,"string");return ht(t)?t:t+""},ft=K,pt=r.document,gt=ft(pt)&&ft(pt.createElement),vt=function(e){return gt?pt.createElement(e):{}},yt=vt,mt=!s&&!o((function(){return 7!=Object.defineProperty(yt("div"),"a",{get:function(){return 7}}).a})),_t=s,Ct=l,Et=h,Tt=m,It=B,Rt=dt,St=ke,Mt=mt,Nt=Object.getOwnPropertyDescriptor;i.f=_t?Nt:function(e,t){if(e=It(e),t=Rt(t),Mt)try{return Nt(e,t)}catch(e){}if(St(e,t))return Tt(!Ct(Et.f,e,t),e[t])};var Ot={},wt=s&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),At=r,Ut=K,bt=At.String,Lt=At.TypeError,Pt=function(e){if(Ut(e))return e;throw Lt(bt(e)+" is not an object")},Dt=s,xt=mt,kt=wt,Vt=Pt,Bt=dt,Gt=r.TypeError,Ft=Object.defineProperty,Kt=Object.getOwnPropertyDescriptor,qt="enumerable",Ht="configurable",jt="writable";Ot.f=Dt?kt?function(e,t,n){if(Vt(e),t=Bt(t),Vt(n),"function"==typeof e&&"prototype"===t&&"value"in n&&jt in n&&!n.writable){var r=Kt(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:Ht in n?n.configurable:r.configurable,enumerable:qt in n?n.enumerable:r.enumerable,writable:!1})}return Ft(e,t,n)}:Ft:function(e,t,n){if(Vt(e),t=Bt(t),Vt(n),xt)try{return Ft(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Gt("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Yt=Ot,Wt=m,Qt=s?function(e,t,n){return Yt.f(e,t,Wt(1,n))}:function(e,t,n){return e[t]=n,e},Jt={exports:{}},zt=G,Xt=Ae,Zt=R(Function.toString);zt(Xt.inspectSource)||(Xt.inspectSource=function(e){return Zt(e)});var $t,en,tn,nn=Xt.inspectSource,rn=G,on=nn,sn=r.WeakMap,an=rn(sn)&&/native code/.test(on(sn)),cn=Re.exports,un=Ke,ln=cn("keys"),hn=function(e){return ln[e]||(ln[e]=un(e))},dn={},fn=an,pn=r,gn=R,vn=K,yn=Qt,mn=ke,_n=Ae,Cn=hn,En=dn,Tn="Object already initialized",In=pn.TypeError,Rn=pn.WeakMap;if(fn||_n.state){var Sn=_n.state||(_n.state=new Rn),Mn=gn(Sn.get),Nn=gn(Sn.has),On=gn(Sn.set);$t=function(e,t){if(Nn(Sn,e))throw new In(Tn);return t.facade=e,On(Sn,e,t),t},en=function(e){return Mn(Sn,e)||{}},tn=function(e){return Nn(Sn,e)}}else{var wn=Cn("state");En[wn]=!0,$t=function(e,t){if(mn(e,wn))throw new In(Tn);return t.facade=e,yn(e,wn,t),t},en=function(e){return mn(e,wn)?e[wn]:{}},tn=function(e){return mn(e,wn)}}var An={set:$t,get:en,has:tn,enforce:function(e){return tn(e)?en(e):$t(e,{})},getterFor:function(e){return function(t){var n;if(!vn(t)||(n=en(t)).type!==e)throw In("Incompatible receiver, "+e+" required");return n}}},Un=s,bn=ke,Ln=Function.prototype,Pn=Un&&Object.getOwnPropertyDescriptor,Dn=bn(Ln,"name"),xn={EXISTS:Dn,PROPER:Dn&&"something"===function(){}.name,CONFIGURABLE:Dn&&(!Un||Un&&Pn(Ln,"name").configurable)},kn=r,Vn=G,Bn=ke,Gn=Qt,Fn=Ne,Kn=nn,qn=xn.CONFIGURABLE,Hn=An.get,jn=An.enforce,Yn=String(String).split("String");(Jt.exports=function(e,t,n,r){var i,o=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,c=r&&void 0!==r.name?r.name:t;Vn(n)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Bn(n,"name")||qn&&n.name!==c)&&Gn(n,"name",c),(i=jn(n)).source||(i.source=Yn.join("string"==typeof c?c:""))),e!==kn?(o?!a&&e[t]&&(s=!0):delete e[t],s?e[t]=n:Gn(e,t,n)):s?e[t]=n:Fn(t,n)})(Function.prototype,"toString",(function(){return Vn(this)&&Hn(this).source||Kn(this)}));var Wn={},Qn=Math.ceil,Jn=Math.floor,zn=function(e){var t=+e;return t!=t||0===t?0:(t>0?Jn:Qn)(t)},Xn=zn,Zn=Math.max,$n=Math.min,er=function(e,t){var n=Xn(e);return n<0?Zn(n+t,0):$n(n,t)},tr=zn,nr=Math.min,rr=function(e){return e>0?nr(tr(e),9007199254740991):0},ir=rr,or=function(e){return ir(e.length)},sr=B,ar=er,cr=or,ur=function(e){return function(t,n,r){var i,o=sr(t),s=cr(o),a=ar(r,s);if(e&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===n)return e||a||0;return!e&&-1}},lr={includes:ur(!0),indexOf:ur(!1)},hr=ke,dr=B,fr=lr.indexOf,pr=dn,gr=R([].push),vr=function(e,t){var n,r=dr(e),i=0,o=[];for(n in r)!hr(pr,n)&&hr(r,n)&&gr(o,n);for(;t.length>i;)hr(r,n=t[i++])&&(~fr(o,n)||gr(o,n));return o},yr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mr=vr,_r=yr.concat("length","prototype");Wn.f=Object.getOwnPropertyNames||function(e){return mr(e,_r)};var Cr={};Cr.f=Object.getOwnPropertySymbols;var Er,Tr=Y,Ir=Wn,Rr=Cr,Sr=Pt,Mr=R([].concat),Nr=Tr("Reflect","ownKeys")||function(e){var t=Ir.f(Sr(e)),n=Rr.f;return n?Mr(t,n(e)):t},Or=ke,wr=Nr,Ar=i,Ur=Ot,br=o,Lr=G,Pr=/#|\.prototype\./,Dr=function(e,t){var n=kr[xr(e)];return n==Br||n!=Vr&&(Lr(t)?br(t):!!t)},xr=Dr.normalize=function(e){return String(e).replace(Pr,".").toLowerCase()},kr=Dr.data={},Vr=Dr.NATIVE="N",Br=Dr.POLYFILL="P",Gr=Dr,Fr=r,Kr=i.f,qr=Qt,Hr=Jt.exports,jr=Ne,Yr=function(e,t,n){for(var r=wr(t),i=Ur.f,o=Ar.f,s=0;s<r.length;s++){var a=r[s];Or(e,a)||n&&Or(n,a)||i(e,a,o(t,a))}},Wr=Gr,Qr=function(e,t){var n,r,i,o,s,a=e.target,c=e.global,u=e.stat;if(n=c?Fr:u?Fr[a]||jr(a,{}):(Fr[a]||{}).prototype)for(r in t){if(o=t[r],i=e.noTargetGet?(s=Kr(n,r))&&s.value:n[r],!Wr(c?r:a+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Yr(o,i)}(e.sham||i&&i.sham)&&qr(o,"sham",!0),Hr(n,r,o,e)}};Qr({global:!0},{globalThis:r}),function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED",e[e.UNREAD=0]="UNREAD"}(Er||(Er={}));var Jr=Er;function zr(e){return zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zr(e)}var Xr={};Xr[$e("toStringTag")]="z";var Zr="[object z]"===String(Xr),$r=r,ei=Zr,ti=G,ni=O,ri=$e("toStringTag"),ii=$r.Object,oi="Arguments"==ni(function(){return arguments}()),si=ei?ni:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=ii(e),ri))?n:oi?ni(t):"Object"==(r=ni(t))&&ti(t.callee)?"Arguments":r},ai=si,ci=r.String,ui=function(e){if("Symbol"===ai(e))throw TypeError("Cannot convert a Symbol value to a string");return ci(e)},li=Pt,hi=function(){var e=li(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},di=o,fi=r.RegExp,pi=di((function(){var e=fi("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),gi=pi||di((function(){return!fi("a","y").sticky})),vi={BROKEN_CARET:pi||di((function(){var e=fi("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:gi,UNSUPPORTED_Y:pi},yi={},mi=vr,_i=yr,Ci=Object.keys||function(e){return mi(e,_i)},Ei=s,Ti=wt,Ii=Ot,Ri=Pt,Si=B,Mi=Ci;yi.f=Ei&&!Ti?Object.defineProperties:function(e,t){Ri(e);for(var n,r=Si(t),i=Mi(t),o=i.length,s=0;o>s;)Ii.f(e,n=i[s++],r[n]);return e};var Ni,Oi=Y("document","documentElement"),wi=Pt,Ai=yi,Ui=yr,bi=dn,Li=Oi,Pi=vt,Di=hn("IE_PROTO"),xi=function(){},ki=function(e){return"<script>"+e+"</"+"script>"},Vi=function(e){e.write(ki("")),e.close();var t=e.parentWindow.Object;return e=null,t},Bi=function(){try{Ni=new ActiveXObject("htmlfile")}catch(e){}var e,t;Bi="undefined"!=typeof document?document.domain&&Ni?Vi(Ni):((t=Pi("iframe")).style.display="none",Li.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(ki("document.F=Object")),e.close(),e.F):Vi(Ni);for(var n=Ui.length;n--;)delete Bi.prototype[Ui[n]];return Bi()};bi[Di]=!0;var Gi=Object.create||function(e,t){var n;return null!==e?(xi.prototype=wi(e),n=new xi,xi.prototype=null,n[Di]=e):n=Bi(),void 0===t?n:Ai.f(n,t)},Fi=o,Ki=r.RegExp,qi=Fi((function(){var e=Ki(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Hi=o,ji=r.RegExp,Yi=Hi((function(){var e=ji("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Wi=l,Qi=R,Ji=ui,zi=hi,Xi=vi,Zi=Re.exports,$i=Gi,eo=An.get,to=qi,no=Yi,ro=Zi("native-string-replace",String.prototype.replace),io=RegExp.prototype.exec,oo=io,so=Qi("".charAt),ao=Qi("".indexOf),co=Qi("".replace),uo=Qi("".slice),lo=function(){var e=/a/,t=/b*/g;return Wi(io,e,"a"),Wi(io,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),ho=Xi.BROKEN_CARET,fo=void 0!==/()??/.exec("")[1];(lo||fo||ho||to||no)&&(oo=function(e){var t,n,r,i,o,s,a,c=this,u=eo(c),l=Ji(e),h=u.raw;if(h)return h.lastIndex=c.lastIndex,t=Wi(oo,h,l),c.lastIndex=h.lastIndex,t;var d=u.groups,f=ho&&c.sticky,p=Wi(zi,c),g=c.source,v=0,y=l;if(f&&(p=co(p,"y",""),-1===ao(p,"g")&&(p+="g"),y=uo(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==so(l,c.lastIndex-1))&&(g="(?: "+g+")",y=" "+y,v++),n=new RegExp("^(?:"+g+")",p)),fo&&(n=new RegExp("^"+g+"$(?!\\s)",p)),lo&&(r=c.lastIndex),i=Wi(io,f?n:c,y),f?i?(i.input=uo(i.input,v),i[0]=uo(i[0],v),i.index=c.lastIndex,c.lastIndex+=i[0].length):c.lastIndex=0:lo&&i&&(c.lastIndex=c.global?i.index+i[0].length:r),fo&&i&&i.length>1&&Wi(ro,i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&d)for(i.groups=s=$i(null),o=0;o<d.length;o++)s[(a=d[o])[0]]=i[a[1]];return i});var po=oo;Qr({target:"RegExp",proto:!0,forced:/./.exec!==po},{exec:po});var go=R,vo=Jt.exports,yo=po,mo=o,_o=$e,Co=Qt,Eo=_o("species"),To=RegExp.prototype,Io=function(e,t,n,r){var i=_o(e),o=!mo((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),s=o&&!mo((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[Eo]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!o||!s||n){var a=go(/./[i]),c=t(i,""[e],(function(e,t,n,r,i){var s=go(e),c=t.exec;return c===yo||c===To.exec?o&&!i?{done:!0,value:a(t,n,r)}:{done:!0,value:s(n,t,r)}:{done:!1}}));vo(String.prototype,e,c[0]),vo(To,i,c[1])}r&&Co(To[i],"sham",!0)},Ro=R,So=zn,Mo=ui,No=x,Oo=Ro("".charAt),wo=Ro("".charCodeAt),Ao=Ro("".slice),Uo=function(e){return function(t,n){var r,i,o=Mo(No(t)),s=So(n),a=o.length;return s<0||s>=a?e?"":void 0:(r=wo(o,s))<55296||r>56319||s+1===a||(i=wo(o,s+1))<56320||i>57343?e?Oo(o,s):r:e?Ao(o,s,s+2):i-56320+(r-55296<<10)+65536}},bo={codeAt:Uo(!1),charAt:Uo(!0)},Lo=bo.charAt,Po=function(e,t,n){return t+(n?Lo(e,t).length:1)},Do=l,xo=Pt,ko=G,Vo=O,Bo=po,Go=r.TypeError,Fo=function(e,t){var n=e.exec;if(ko(n)){var r=Do(n,e,t);return null!==r&&xo(r),r}if("RegExp"===Vo(e))return Do(Bo,e,t);throw Go("RegExp#exec called on incompatible receiver")},Ko=l,qo=Pt,Ho=rr,jo=ui,Yo=x,Wo=_e,Qo=Po,Jo=Fo;Io("match",(function(e,t,n){return[function(t){var n=Yo(this),r=null==t?void 0:Wo(t,e);return r?Ko(r,t,n):new RegExp(t)[e](jo(n))},function(e){var r=qo(this),i=jo(e),o=n(t,r,i);if(o.done)return o.value;if(!r.global)return Jo(r,i);var s=r.unicode;r.lastIndex=0;for(var a,c=[],u=0;null!==(a=Jo(r,i));){var l=jo(a[0]);c[u]=l,""===l&&(r.lastIndex=Qo(i,Ho(r.lastIndex),s)),u++}return 0===u?null:c}]}));var zo=O,Xo=Array.isArray||function(e){return"Array"==zo(e)},Zo=dt,$o=Ot,es=m,ts=function(e,t,n){var r=Zo(t);r in e?$o.f(e,r,es(0,n)):e[r]=n},ns=R,rs=o,is=G,os=si,ss=nn,as=function(){},cs=[],us=Y("Reflect","construct"),ls=/^\s*(?:class|function)\b/,hs=ns(ls.exec),ds=!ls.exec(as),fs=function(e){if(!is(e))return!1;try{return us(as,cs,e),!0}catch(e){return!1}},ps=function(e){if(!is(e))return!1;switch(os(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ds||!!hs(ls,ss(e))}catch(e){return!0}};ps.sham=!0;var gs=!us||rs((function(){var e;return fs(fs.call)||!fs(Object)||!fs((function(){e=!0}))||e}))?ps:fs,vs=r,ys=Xo,ms=gs,_s=K,Cs=$e("species"),Es=vs.Array,Ts=function(e){var t;return ys(e)&&(t=e.constructor,(ms(t)&&(t===Es||ys(t.prototype))||_s(t)&&null===(t=t[Cs]))&&(t=void 0)),void 0===t?Es:t},Is=function(e,t){return new(Ts(e))(0===t?0:t)},Rs=o,Ss=te,Ms=$e("species"),Ns=function(e){return Ss>=51||!Rs((function(){var t=[];return(t.constructor={})[Ms]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Os=Qr,ws=r,As=o,Us=Xo,bs=K,Ls=Pe,Ps=or,Ds=ts,xs=Is,ks=Ns,Vs=te,Bs=$e("isConcatSpreadable"),Gs=9007199254740991,Fs="Maximum allowed index exceeded",Ks=ws.TypeError,qs=Vs>=51||!As((function(){var e=[];return e[Bs]=!1,e.concat()[0]!==e})),Hs=ks("concat"),js=function(e){if(!bs(e))return!1;var t=e[Bs];return void 0!==t?!!t:Us(e)};Os({target:"Array",proto:!0,forced:!qs||!Hs},{concat:function(e){var t,n,r,i,o,s=Ls(this),a=xs(s,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(js(o=-1===t?s:arguments[t])){if(c+(i=Ps(o))>Gs)throw Ks(Fs);for(n=0;n<i;n++,c++)n in o&&Ds(a,c,o[n])}else{if(c>=Gs)throw Ks(Fs);Ds(a,c++,o)}return a.length=c,a}});var Ys,Ws,Qs=72e5,Js=5e3,zs=["https://nav.cn.ronghub.com","https://nav2-cn.ronghub.com"],Xs=["wsproxy.cn.ronghub.com","wsap-cn.ronghub.com"],Zs=["cometproxy-cn.ronghub.com","mini-cn.ronghub.com"],$s=3e4,ea=131072,ta=18e4,na="RCV4-",ra={"RC:TxtMsg":{isCounted:!0,isPersited:!0},"RC:ImgMsg":{isCounted:!0,isPersited:!0},"RC:VcMsg":{isCounted:!0,isPersited:!0},"RC:ImgTextMsg":{isCounted:!0,isPersited:!0},"RC:FileMsg":{isCounted:!0,isPersited:!0},"RC:HQVCMsg":{isCounted:!0,isPersited:!0},"RC:LBSMsg":{isCounted:!0,isPersited:!0},"RC:PSImgTxtMsg":{isCounted:!0,isPersited:!0},"RC:PSMultiImgTxtMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpMsg":{isCounted:!0,isPersited:!0},"RCJrmf:RpOpendMsg":{isCounted:!0,isPersited:!0},"RC:CombineMsg":{isCounted:!0,isPersited:!0},"RC:ReferenceMsg":{isCounted:!0,isPersited:!0},"RC:SightMsg":{isCounted:!0,isPersited:!0},"RC:GIFMsg":{isCounted:!0,isPersited:!0},"RC:InfoNtf":{isCounted:!1,isPersited:!0},"RC:ContactNtf":{isCounted:!1,isPersited:!0},"RC:ProfileNtf":{isCounted:!1,isPersited:!0},"RC:CmdNtf":{isCounted:!1,isPersited:!0},"RC:GrpNtf":{isCounted:!1,isPersited:!0},"RC:RcCmd":{isCounted:!1,isPersited:!0},"RC:CmdMsg":{isCounted:!1,isPersited:!1},"RC:TypSts":{isCounted:!1,isPersited:!1},"RC:PSCmd":{isCounted:!1,isPersited:!1},"RC:SRSMsg":{isCounted:!1,isPersited:!1},"RC:RRReqMsg":{isCounted:!1,isPersited:!1},"RC:RRRspMsg":{isCounted:!1,isPersited:!1},"RC:CsChaR":{isCounted:!1,isPersited:!1},"RC:CSCha":{isCounted:!1,isPersited:!1},"RC:CsEva":{isCounted:!1,isPersited:!1},"RC:CsContact":{isCounted:!1,isPersited:!1},"RC:CsHs":{isCounted:!1,isPersited:!1},"RC:CsHsR":{isCounted:!1,isPersited:!1},"RC:CsSp":{isCounted:!1,isPersited:!1},"RC:CsEnd":{isCounted:!1,isPersited:!1},"RC:CsUpdate":{isCounted:!1,isPersited:!1},"RC:ReadNtf":{isCounted:!1,isPersited:!1},"RC:chrmKVNotiMsg":{isCounted:!1,isPersited:!1},"RC:VCAccept":{isCounted:!1,isPersited:!1},"RC:VCRinging":{isCounted:!1,isPersited:!1},"RC:VCSummary":{isCounted:!1,isPersited:!1},"RC:VCHangup":{isCounted:!1,isPersited:!1},"RC:VCInvite":{isCounted:!1,isPersited:!1},"RC:VCModifyMedia":{isCounted:!1,isPersited:!1},"RC:VCModifyMem":{isCounted:!1,isPersited:!1},"RC:MsgExMsg":{isCounted:!1,isPersited:!1},"RC:RRMsg":{isCounted:!1,isPersited:!1},"RC:LogCmdMsg":{isCounted:!1,isPersited:!1},"RC:InterceptMsg":{isCounted:!1,isPersited:!1}},ia=["RC:TypSts","RC:InterceptMsg"];!function(e){e.WEBSOCKET="websocket",e.COMET="comet"}(Ys||(Ys={}));var oa=function(e){return Ws||(Ws={set:function(t,n){e.localStorage.setItem(t,JSON.stringify(n))},get:function(t){var n;try{n=JSON.parse(e.localStorage.getItem(t))}catch(e){n=null}return n},remove:function(t){return e.localStorage.removeItem(t)},getKeys:function(){var t=[];for(var n in e.localStorage)t.push(n);return t}}),Ws},sa=function(){function e(e){this._caches={},e&&(this._caches=e)}return e.prototype.set=function(e,t){this._caches[e]=t},e.prototype.remove=function(e){var t=this.get(e);return delete this._caches[e],t},e.prototype.get=function(e){return this._caches[e]},e.prototype.getKeys=function(){var e=[];for(var t in this._caches)e.push(t);return e},e}(),aa=function(){function e(e,t){var n,r=t?"".concat(na).concat(t):na;this._rootStorage=oa(e);var i=this._rootStorage.get(r)||{};this._cache=new sa(((n={})[r]=i,n)),this._storageKey=r}return e.prototype._get=function(){var e=this._storageKey;return this._cache.get(e)||{}},e.prototype._set=function(e){var t=this._storageKey;e=e||{},this._cache.set(t,e),this._rootStorage.set(t,e)},e.prototype.set=function(e,t){var n=this._get();n[e]=t,this._set(n)},e.prototype.remove=function(e){var t=this._get();delete t[e],this._set(t)},e.prototype.clear=function(){var e=this._storageKey;this._rootStorage.remove(e),this._cache.remove(e)},e.prototype.get=function(e){return this._get()[e]},e.prototype.getKeys=function(){var e=this._get(),t=[];for(var n in e)t.push(n);return t},e.prototype.getValues=function(){return this._get()||{}},e}(),ca=function(e,t){return ca=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ca(e,t)};function ua(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ca(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var la=function(){return la=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},la.apply(this,arguments)};function ha(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function da(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function fa(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var pa=function(e){function t(t){return e.call(this,"TODO => ".concat(t))||this}return ua(t,e),t}(Error),ga=function(e){return new pa(e)},va=R([].slice),ya=Qr,ma=r,_a=Xo,Ca=gs,Ea=K,Ta=er,Ia=or,Ra=B,Sa=ts,Ma=$e,Na=va,Oa=Ns("slice"),wa=Ma("species"),Aa=ma.Array,Ua=Math.max;ya({target:"Array",proto:!0,forced:!Oa},{slice:function(e,t){var n,r,i,o=Ra(this),s=Ia(o),a=Ta(e,s),c=Ta(void 0===t?s:t,s);if(_a(o)&&(n=o.constructor,(Ca(n)&&(n===Aa||_a(n.prototype))||Ea(n)&&null===(n=n[wa]))&&(n=void 0),n===Aa||void 0===n))return Na(o,a,c);for(r=new(void 0===n?Aa:n)(Ua(c-a,0)),i=0;a<c;a++,i++)a in o&&Sa(r,i,o[a]);return r.length=i,r}});var ba=a,La=Function.prototype,Pa=La.apply,Da=La.call,xa="object"==typeof Reflect&&Reflect.apply||(ba?Da.bind(Pa):function(){return Da.apply(Pa,arguments)}),ka=R,Va=Pe,Ba=Math.floor,Ga=ka("".charAt),Fa=ka("".replace),Ka=ka("".slice),qa=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,Ha=/\$([$&'`]|\d{1,2})/g,ja=xa,Ya=l,Wa=R,Qa=Io,Ja=o,za=Pt,Xa=G,Za=zn,$a=rr,ec=ui,tc=x,nc=Po,rc=_e,ic=function(e,t,n,r,i,o){var s=n+e.length,a=r.length,c=Ha;return void 0!==i&&(i=Va(i),c=qa),Fa(o,c,(function(o,c){var u;switch(Ga(c,0)){case"$":return"$";case"&":return e;case"`":return Ka(t,0,n);case"'":return Ka(t,s);case"<":u=i[Ka(c,1,-1)];break;default:var l=+c;if(0===l)return o;if(l>a){var h=Ba(l/10);return 0===h?o:h<=a?void 0===r[h-1]?Ga(c,1):r[h-1]+Ga(c,1):o}u=r[l-1]}return void 0===u?"":u}))},oc=Fo,sc=$e("replace"),ac=Math.max,cc=Math.min,uc=Wa([].concat),lc=Wa([].push),hc=Wa("".indexOf),dc=Wa("".slice),fc="$0"==="a".replace(/./,"$0"),pc=!!/./[sc]&&""===/./[sc]("a","$0");Qa("replace",(function(e,t,n){var r=pc?"$":"$0";return[function(e,n){var r=tc(this),i=null==e?void 0:rc(e,sc);return i?Ya(i,e,r,n):Ya(t,ec(r),e,n)},function(e,i){var o=za(this),s=ec(e);if("string"==typeof i&&-1===hc(i,r)&&-1===hc(i,"$<")){var a=n(t,o,s,i);if(a.done)return a.value}var c=Xa(i);c||(i=ec(i));var u=o.global;if(u){var l=o.unicode;o.lastIndex=0}for(var h=[];;){var d=oc(o,s);if(null===d)break;if(lc(h,d),!u)break;""===ec(d[0])&&(o.lastIndex=nc(s,$a(o.lastIndex),l))}for(var f,p="",g=0,v=0;v<h.length;v++){for(var y=ec((d=h[v])[0]),m=ac(cc(Za(d.index),s.length),0),_=[],C=1;C<d.length;C++)lc(_,void 0===(f=d[C])?f:String(f));var E=d.groups;if(c){var T=uc([y],_,m,s);void 0!==E&&lc(T,E);var I=ec(ja(i,void 0,T))}else I=ic(y,s,m,_,E,i);m>=g&&(p+=dc(s,g,m)+I,g=m+y.length)}return p+dc(s,g)}]}),!!Ja((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!fc||pc);var gc=ye,vc=a,yc=R(R.bind),mc=function(e,t){return gc(e),void 0===t?e:vc?yc(e,t):function(){return e.apply(t,arguments)}},_c=mc,Cc=P,Ec=Pe,Tc=or,Ic=Is,Rc=R([].push),Sc=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,u,l,h){for(var d,f,p=Ec(c),g=Cc(p),v=_c(u,l),y=Tc(g),m=0,_=h||Ic,C=t?_(c,y):n||s?_(c,0):void 0;y>m;m++)if((a||m in g)&&(f=v(d=g[m],m,p),e))if(t)C[m]=f;else if(f)switch(e){case 3:return!0;case 5:return d;case 6:return m;case 2:Rc(C,d)}else switch(e){case 4:return!1;case 7:Rc(C,d)}return o?-1:r||i?i:C}},Mc={forEach:Sc(0),map:Sc(1),filter:Sc(2),some:Sc(3),every:Sc(4),find:Sc(5),findIndex:Sc(6),filterReject:Sc(7)},Nc=Mc.filter;Qr({target:"Array",proto:!0,forced:!Ns("filter")},{filter:function(e){return Nc(this,e,arguments.length>1?arguments[1]:void 0)}});var Oc=si,wc=Zr?{}.toString:function(){return"[object "+Oc(this)+"]"},Ac=Zr,Uc=Jt.exports,bc=wc;Ac||Uc(Object.prototype,"toString",bc,{unsafe:!0});var Lc=Mc.map;Qr({target:"Array",proto:!0,forced:!Ns("map")},{map:function(e){return Lc(this,e,arguments.length>1?arguments[1]:void 0)}});var Pc=Pe,Dc=Ci;Qr({target:"Object",stat:!0,forced:o((function(){Dc(1)}))},{keys:function(e){return Dc(Pc(e))}});var xc=o,kc=function(e,t){var n=[][e];return!!n&&xc((function(){n.call(null,t||function(){return 1},1)}))},Vc=Qr,Bc=P,Gc=B,Fc=kc,Kc=R([].join),qc=Bc!=Object,Hc=Fc("join",",");Vc({target:"Array",proto:!0,forced:qc||!Hc},{join:function(e){return Kc(Gc(this),void 0===e?",":e)}});var jc=function(e,t,n){if(void 0===t||void 0===n)return e.toUpperCase();var r=e.slice(t,n);return e=e.replace(r,(function(e){return e.toUpperCase()}))},Yc=function(e,t){void 0===t&&(t="utf-8");var n,r=0;if("utf-16"===t)for(var i=0,o=e.length;i<o;i++)r+=(n=e.charCodeAt(i))<=65535?2:4;else for(i=0,o=e.length;i<o;i++)r+=(n=e.charCodeAt(i))<127?1:n<=2047?2:n<=65535?3:4;return r},Wc=function(e,t){if(e=e.replace(/\?$/,""),!t)return e;var n=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).filter((function(e){return!!e}));return n.length?[e,n.join("&")].join("?"):e},Qc=function(e){return e.match(/\d+(\.\d+){2}/)[0]},Jc=s,zc=xn.EXISTS,Xc=R,Zc=Ot.f,$c=Function.prototype,eu=Xc($c.toString),tu=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,nu=Xc(tu.exec);Jc&&!zc&&Zc($c,"name",{configurable:!0,get:function(){try{return nu(tu,eu(this))[1]}catch(e){return""}}});var ru=Gi,iu=Ot,ou=$e("unscopables"),su=Array.prototype;null==su[ou]&&iu.f(su,ou,{configurable:!0,value:ru(null)});var au=function(e){su[ou][e]=!0},cu=lr.includes,uu=au;Qr({target:"Array",proto:!0,forced:o((function(){return!Array(1).includes()}))},{includes:function(e){return cu(this,e,arguments.length>1?arguments[1]:void 0)}}),uu("includes");var lu=r.TypeError,hu=function(e,t){if(e<t)throw lu("Not enough arguments");return e},du=r,fu=xa,pu=G,gu=va,vu=hu,yu=/MSIE .\./.test(Q),mu=du.Function,_u=function(e){return yu?function(t,n){var r=vu(arguments.length,1)>2,i=pu(t)?t:mu(t),o=r?gu(arguments,2):void 0;return e(r?function(){fu(i,this,o)}:i,n)}:e},Cu={setTimeout:_u(du.setTimeout),setInterval:_u(du.setInterval)},Eu=Cu.setInterval;Qr({global:!0,bind:!0,forced:r.setInterval!==Eu},{setInterval:Eu});var Tu=Cu.setTimeout;Qr({global:!0,bind:!0,forced:r.setTimeout!==Tu},{setTimeout:Tu});var Iu,Ru,Su,Mu,Nu="process"==O(r.process),Ou=Jt.exports,wu=function(e,t,n){for(var r in t)Ou(e,r,t[r],n);return e},Au=r,Uu=G,bu=Au.String,Lu=Au.TypeError,Pu=R,Du=Pt,xu=function(e){if("object"==typeof e||Uu(e))return e;throw Lu("Can't set "+bu(e)+" as a prototype")},ku=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Pu(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return Du(n),xu(r),t?e(n,r):n.__proto__=r,n}}():void 0),Vu=Ot.f,Bu=ke,Gu=$e("toStringTag"),Fu=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Bu(e,Gu)&&Vu(e,Gu,{configurable:!0,value:t})},Ku=Y,qu=Ot,Hu=s,ju=$e("species"),Yu=function(e){var t=Ku(e),n=qu.f;Hu&&t&&!t[ju]&&n(t,ju,{configurable:!0,get:function(){return this}})},Wu=W,Qu=r.TypeError,Ju=function(e,t){if(Wu(t,e))return e;throw Qu("Incorrect invocation")},zu=gs,Xu=fe,Zu=r.TypeError,$u=function(e){if(zu(e))return e;throw Zu(Xu(e)+" is not a constructor")},el=Pt,tl=$u,nl=$e("species"),rl=function(e,t){var n,r=el(e).constructor;return void 0===r||null==(n=el(r)[nl])?t:tl(n)},il=/(?:ipad|iphone|ipod).*applewebkit/i.test(Q),ol=r,sl=xa,al=mc,cl=G,ul=ke,ll=o,hl=Oi,dl=va,fl=vt,pl=hu,gl=il,vl=Nu,yl=ol.setImmediate,ml=ol.clearImmediate,_l=ol.process,Cl=ol.Dispatch,El=ol.Function,Tl=ol.MessageChannel,Il=ol.String,Rl=0,Sl={},Ml="onreadystatechange";try{Iu=ol.location}catch(e){}var Nl=function(e){if(ul(Sl,e)){var t=Sl[e];delete Sl[e],t()}},Ol=function(e){return function(){Nl(e)}},wl=function(e){Nl(e.data)},Al=function(e){ol.postMessage(Il(e),Iu.protocol+"//"+Iu.host)};yl&&ml||(yl=function(e){pl(arguments.length,1);var t=cl(e)?e:El(e),n=dl(arguments,1);return Sl[++Rl]=function(){sl(t,void 0,n)},Ru(Rl),Rl},ml=function(e){delete Sl[e]},vl?Ru=function(e){_l.nextTick(Ol(e))}:Cl&&Cl.now?Ru=function(e){Cl.now(Ol(e))}:Tl&&!gl?(Mu=(Su=new Tl).port2,Su.port1.onmessage=wl,Ru=al(Mu.postMessage,Mu)):ol.addEventListener&&cl(ol.postMessage)&&!ol.importScripts&&Iu&&"file:"!==Iu.protocol&&!ll(Al)?(Ru=Al,ol.addEventListener("message",wl,!1)):Ru=Ml in fl("script")?function(e){hl.appendChild(fl("script")).onreadystatechange=function(){hl.removeChild(this),Nl(e)}}:function(e){setTimeout(Ol(e),0)});var Ul,bl,Ll,Pl,Dl,xl,kl,Vl,Bl={set:yl,clear:ml},Gl=r,Fl=/ipad|iphone|ipod/i.test(Q)&&void 0!==Gl.Pebble,Kl=/web0s(?!.*chrome)/i.test(Q),ql=r,Hl=mc,jl=i.f,Yl=Bl.set,Wl=il,Ql=Fl,Jl=Kl,zl=Nu,Xl=ql.MutationObserver||ql.WebKitMutationObserver,Zl=ql.document,$l=ql.process,eh=ql.Promise,th=jl(ql,"queueMicrotask"),nh=th&&th.value;nh||(Ul=function(){var e,t;for(zl&&(e=$l.domain)&&e.exit();bl;){t=bl.fn,bl=bl.next;try{t()}catch(e){throw bl?Pl():Ll=void 0,e}}Ll=void 0,e&&e.enter()},Wl||zl||Jl||!Xl||!Zl?!Ql&&eh&&eh.resolve?((kl=eh.resolve(void 0)).constructor=eh,Vl=Hl(kl.then,kl),Pl=function(){Vl(Ul)}):zl?Pl=function(){$l.nextTick(Ul)}:(Yl=Hl(Yl,ql),Pl=function(){Yl(Ul)}):(Dl=!0,xl=Zl.createTextNode(""),new Xl(Ul).observe(xl,{characterData:!0}),Pl=function(){xl.data=Dl=!Dl}));var rh=nh||function(e){var t={fn:e,next:void 0};Ll&&(Ll.next=t),bl||(bl=t,Pl()),Ll=t},ih=r,oh=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},sh=function(){this.head=null,this.tail=null};sh.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var ah=sh,ch=r.Promise,uh="object"==typeof window&&"object"!=typeof Deno,lh=r,hh=ch,dh=G,fh=Gr,ph=nn,gh=$e,vh=uh,yh=te;hh&&hh.prototype;var mh=gh("species"),_h=!1,Ch=dh(lh.PromiseRejectionEvent),Eh=fh("Promise",(function(){var e=ph(hh),t=e!==String(hh);if(!t&&66===yh)return!0;if(yh>=51&&/native code/.test(e))return!1;var n=new hh((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[mh]=r,!(_h=n.then((function(){}))instanceof r)||!t&&vh&&!Ch})),Th={CONSTRUCTOR:Eh,REJECTION_EVENT:Ch,SUBCLASSING:_h},Ih={},Rh=ye,Sh=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Rh(t),this.reject=Rh(n)};Ih.f=function(e){return new Sh(e)};var Mh,Nh,Oh,wh=Qr,Ah=Nu,Uh=r,bh=l,Lh=Jt.exports,Ph=wu,Dh=ku,xh=Fu,kh=Yu,Vh=ye,Bh=G,Gh=K,Fh=Ju,Kh=rl,qh=Bl.set,Hh=rh,jh=function(e,t){var n=ih.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))},Yh=oh,Wh=ah,Qh=An,Jh=ch,zh=Ih,Xh="Promise",Zh=Th.CONSTRUCTOR,$h=Th.REJECTION_EVENT,ed=Th.SUBCLASSING,td=Qh.getterFor(Xh),nd=Qh.set,rd=Jh&&Jh.prototype,id=Jh,od=rd,sd=Uh.TypeError,ad=Uh.document,cd=Uh.process,ud=zh.f,ld=ud,hd=!!(ad&&ad.createEvent&&Uh.dispatchEvent),dd="unhandledrejection",fd=function(e){var t;return!(!Gh(e)||!Bh(t=e.then))&&t},pd=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&_d(t),t.rejection=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&(l.exit(),i=!0)),n===e.promise?u(sd("Promise-chain cycle")):(r=fd(n))?bh(r,n,c,u):c(n)):u(o)}catch(e){l&&!i&&l.exit(),u(e)}},gd=function(e,t){e.notified||(e.notified=!0,Hh((function(){for(var n,r=e.reactions;n=r.get();)pd(n,e);e.notified=!1,t&&!e.rejection&&yd(e)})))},vd=function(e,t,n){var r,i;hd?((r=ad.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),Uh.dispatchEvent(r)):r={promise:t,reason:n},!$h&&(i=Uh["on"+e])?i(r):e===dd&&jh("Unhandled promise rejection",n)},yd=function(e){bh(qh,Uh,(function(){var t,n=e.facade,r=e.value;if(md(e)&&(t=Yh((function(){Ah?cd.emit("unhandledRejection",r,n):vd(dd,n,r)})),e.rejection=Ah||md(e)?2:1,t.error))throw t.value}))},md=function(e){return 1!==e.rejection&&!e.parent},_d=function(e){bh(qh,Uh,(function(){var t=e.facade;Ah?cd.emit("rejectionHandled",t):vd("rejectionhandled",t,e.value)}))},Cd=function(e,t,n){return function(r){e(t,r,n)}},Ed=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,gd(e,!0))},Td=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw sd("Promise can't be resolved itself");var r=fd(t);r?Hh((function(){var n={done:!1};try{bh(r,t,Cd(Td,n,e),Cd(Ed,n,e))}catch(t){Ed(n,t,e)}})):(e.value=t,e.state=1,gd(e,!1))}catch(t){Ed({done:!1},t,e)}}};if(Zh&&(od=(id=function(e){Fh(this,od),Vh(e),bh(Mh,this);var t=td(this);try{e(Cd(Td,t),Cd(Ed,t))}catch(e){Ed(t,e)}}).prototype,(Mh=function(e){nd(this,{type:Xh,done:!1,notified:!1,parent:!1,reactions:new Wh,rejection:!1,state:0,value:void 0})}).prototype=Ph(od,{then:function(e,t){var n=td(this),r=ud(Kh(this,id));return n.parent=!0,r.ok=!Bh(e)||e,r.fail=Bh(t)&&t,r.domain=Ah?cd.domain:void 0,0==n.state?n.reactions.add(r):Hh((function(){pd(r,n)})),r.promise}}),Nh=function(){var e=new Mh,t=td(e);this.promise=e,this.resolve=Cd(Td,t),this.reject=Cd(Ed,t)},zh.f=ud=function(e){return e===id||undefined===e?new Nh(e):ld(e)},Bh(Jh)&&rd!==Object.prototype)){Oh=rd.then,ed||Lh(rd,"then",(function(e,t){var n=this;return new id((function(e,t){bh(Oh,n,e,t)})).then(e,t)}),{unsafe:!0});try{delete rd.constructor}catch(e){}Dh&&Dh(rd,od)}wh({global:!0,wrap:!0,forced:Zh},{Promise:id}),xh(id,Xh,!1),kh(Xh);var Id={},Rd=Id,Sd=$e("iterator"),Md=Array.prototype,Nd=function(e){return void 0!==e&&(Rd.Array===e||Md[Sd]===e)},Od=si,wd=_e,Ad=Id,Ud=$e("iterator"),bd=function(e){if(null!=e)return wd(e,Ud)||wd(e,"@@iterator")||Ad[Od(e)]},Ld=l,Pd=ye,Dd=Pt,xd=fe,kd=bd,Vd=r.TypeError,Bd=function(e,t){var n=arguments.length<2?kd(e):t;if(Pd(n))return Dd(Ld(n,e));throw Vd(xd(e)+" is not iterable")},Gd=l,Fd=Pt,Kd=_e,qd=mc,Hd=l,jd=Pt,Yd=fe,Wd=Nd,Qd=or,Jd=W,zd=Bd,Xd=bd,Zd=function(e,t,n){var r,i;Fd(e);try{if(!(r=Kd(e,"return"))){if("throw"===t)throw n;return n}r=Gd(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return Fd(r),n},$d=r.TypeError,ef=function(e,t){this.stopped=e,this.result=t},tf=ef.prototype,nf=function(e,t,n){var r,i,o,s,a,c,u,l=n&&n.that,h=!(!n||!n.AS_ENTRIES),d=!(!n||!n.IS_ITERATOR),f=!(!n||!n.INTERRUPTED),p=qd(t,l),g=function(e){return r&&Zd(r,"normal",e),new ef(!0,e)},v=function(e){return h?(jd(e),f?p(e[0],e[1],g):p(e[0],e[1])):f?p(e,g):p(e)};if(d)r=e;else{if(!(i=Xd(e)))throw $d(Yd(e)+" is not iterable");if(Wd(i)){for(o=0,s=Qd(e);s>o;o++)if((a=v(e[o]))&&Jd(tf,a))return a;return new ef(!1)}r=zd(e,i)}for(c=r.next;!(u=Hd(c,r)).done;){try{a=v(u.value)}catch(e){Zd(r,"throw",e)}if("object"==typeof a&&a&&Jd(tf,a))return a}return new ef(!1)},rf=$e("iterator"),of=!1;try{var sf=0,af={next:function(){return{done:!!sf++}},return:function(){of=!0}};af[rf]=function(){return this},Array.from(af,(function(){throw 2}))}catch(e){}var cf=function(e,t){if(!t&&!of)return!1;var n=!1;try{var r={};r[rf]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},uf=ch,lf=Th.CONSTRUCTOR||!cf((function(e){uf.all(e).then(void 0,(function(){}))})),hf=l,df=ye,ff=Ih,pf=oh,gf=nf;Qr({target:"Promise",stat:!0,forced:lf},{all:function(e){var t=this,n=ff.f(t),r=n.resolve,i=n.reject,o=pf((function(){var n=df(t.resolve),o=[],s=0,a=1;gf(e,(function(e){var c=s++,u=!1;a++,hf(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise}});var vf=Qr,yf=Th.CONSTRUCTOR,mf=ch,_f=Y,Cf=G,Ef=Jt.exports,Tf=mf&&mf.prototype;if(vf({target:"Promise",proto:!0,forced:yf,real:!0},{catch:function(e){return this.then(void 0,e)}}),Cf(mf)){var If=_f("Promise").prototype.catch;Tf.catch!==If&&Ef(Tf,"catch",If,{unsafe:!0})}var Rf=l,Sf=ye,Mf=Ih,Nf=oh,Of=nf;Qr({target:"Promise",stat:!0,forced:lf},{race:function(e){var t=this,n=Mf.f(t),r=n.reject,i=Nf((function(){var i=Sf(t.resolve);Of(e,(function(e){Rf(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var wf=l,Af=Ih;Qr({target:"Promise",stat:!0,forced:Th.CONSTRUCTOR},{reject:function(e){var t=Af.f(this);return wf(t.reject,void 0,e),t.promise}});var Uf=Pt,bf=K,Lf=Ih,Pf=Qr,Df=Th.CONSTRUCTOR,xf=function(e,t){if(Uf(e),bf(t)&&t.constructor===e)return t;var n=Lf.f(e);return(0,n.resolve)(t),n.promise};Y("Promise"),Pf({target:"Promise",stat:!0,forced:Df},{resolve:function(e){return xf(this,e)}});var kf=function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,i={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var o in i)if(i.hasOwnProperty(o)){var s=r.match(i[o]);if(s){n=o,t=s[1]||s[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}},Vf=K,Bf=O,Gf=$e("match"),Ff=function(e){var t;return Vf(e)&&(void 0!==(t=e[Gf])?!!t:"RegExp"==Bf(e))},Kf=er,qf=or,Hf=ts,jf=r.Array,Yf=Math.max,Wf=function(e,t,n){for(var r=qf(e),i=Kf(t,r),o=Kf(void 0===n?r:n,r),s=jf(Yf(o-i,0)),a=0;i<o;i++,a++)Hf(s,a,e[i]);return s.length=a,s},Qf=xa,Jf=l,zf=R,Xf=Io,Zf=Ff,$f=Pt,ep=x,tp=rl,np=Po,rp=rr,ip=ui,op=_e,sp=Wf,ap=Fo,cp=po,up=o,lp=vi.UNSUPPORTED_Y,hp=4294967295,dp=Math.min,fp=[].push,pp=zf(/./.exec),gp=zf(fp),vp=zf("".slice),yp=!up((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));Xf("split",(function(e,t,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,n){var r=ip(ep(this)),i=void 0===n?hp:n>>>0;if(0===i)return[];if(void 0===e)return[r];if(!Zf(e))return Jf(t,r,e,i);for(var o,s,a,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,h=new RegExp(e.source,u+"g");(o=Jf(cp,h,r))&&!((s=h.lastIndex)>l&&(gp(c,vp(r,l,o.index)),o.length>1&&o.index<r.length&&Qf(fp,c,sp(o,1)),a=o[0].length,l=s,c.length>=i));)h.lastIndex===o.index&&h.lastIndex++;return l===r.length?!a&&pp(h,"")||gp(c,""):gp(c,vp(r,l)),c.length>i?sp(c,0,i):c}:"0".split(void 0,0).length?function(e,n){return void 0===e&&0===n?[]:Jf(t,this,e,n)}:t,[function(t,n){var i=ep(this),o=null==t?void 0:op(t,e);return o?Jf(o,t,i,n):Jf(r,ip(i),t,n)},function(e,i){var o=$f(this),s=ip(e),a=n(r,o,s,i,r!==t);if(a.done)return a.value;var c=tp(o,RegExp),u=o.unicode,l=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(lp?"g":"y"),h=new c(lp?"^(?:"+o.source+")":o,l),d=void 0===i?hp:i>>>0;if(0===d)return[];if(0===s.length)return null===ap(h,s)?[s]:[];for(var f=0,p=0,g=[];p<s.length;){h.lastIndex=lp?0:p;var v,y=ap(h,lp?vp(s,p):s);if(null===y||(v=dp(rp(h.lastIndex+(lp?p:0)),s.length))===f)p=np(s,p,u);else{if(gp(g,vp(s,f,p)),g.length===d)return g;for(var m=1;m<=y.length-1;m++)if(gp(g,y[m]),g.length===d)return g;p=f=v}}return gp(g,vp(s,f)),g}]}),!yp,lp);var mp=l,_p=ke,Cp=W,Ep=hi,Tp=RegExp.prototype,Ip=function(e){var t=e.flags;return void 0!==t||"flags"in Tp||_p(e,"flags")||!Cp(Tp,e)?t:mp(Ep,e)},Rp=xn.PROPER,Sp=Jt.exports,Mp=Pt,Np=ui,Op=o,wp=Ip,Ap="toString",Up=RegExp.prototype.toString,bp=Op((function(){return"/a/b"!=Up.call({source:"a",flags:"b"})})),Lp=Rp&&Up.name!=Ap;(bp||Lp)&&Sp(RegExp.prototype,Ap,(function(){var e=Mp(this);return"/"+Np(e.source)+"/"+Np(wp(e))}),{unsafe:!0});var Pp=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Dp=function(){var e=Pp();if(e=e.replace(/-/g,"")+"a",(e=function(e){var t="0123456789abcdefghigklmnopqrstuvwxyzABCDEFGHIGKLMNOPQRSTUVWXYZa0".split(""),n=t.length+1,r=+e,i=[];do{var o=r%n;r=(r-o)/n,i.unshift(t[o])}while(r);return i.join("")}(e=parseInt(e,16))).length>22&&(e=e.slice(0,22)),e.length<22)for(var t=22-e.length,n=0;n<t;n++)e+="0";return e},xp=function(e){var t="RCDeviceId",n=oa(e),r="",i=n.get(t);return i?r=i:(r=Dp(),n.set(t,r)),r},kp={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Vp=vt("span").classList,Bp=Vp&&Vp.constructor&&Vp.constructor.prototype,Gp=Bp===Object.prototype?void 0:Bp,Fp=Mc.forEach,Kp=kc("forEach")?[].forEach:function(e){return Fp(this,e,arguments.length>1?arguments[1]:void 0)},qp=r,Hp=kp,jp=Gp,Yp=Kp,Wp=Qt,Qp=function(e){if(e&&e.forEach!==Yp)try{Wp(e,"forEach",Yp)}catch(t){e.forEach=Yp}};for(var Jp in Hp)Hp[Jp]&&Qp(qp[Jp]&&qp[Jp].prototype);Qp(jp);var zp="RC_Logs";function Xp(e){var t=e.target.result;1===e.oldVersion&&t.deleteObjectStore(zp),function(e,t,n){var r;if(!e.objectStoreNames.contains(t)){var i=la({},n.objectStoreParams);r=e.createObjectStore(t,i),n.indexs&&n.indexs.length>0&&n.indexs.forEach((function(e){r.createIndex(e.indexName,e.key,{unique:e.unique})}))}}(t,zp,{indexs:[{indexName:"time",key:"time",unique:!1}],objectStoreParams:{autoIncrement:!0}})}var Zp,$p=function(){function e(){}return e.init=function(){if("undefined"!=typeof window&&window&&window.indexedDB){var t=window.indexedDB.open("RC_ENGINE_DB",2);t.onerror=function(e){console.warn("open indexDB request failed "+e.target.error)},t.onsuccess=function(t){e._db=t.target.result,e._db&&(e._db.onclose=function(t){var n;console.warn("The database ".concat(null===(n=e._db)||void 0===n?void 0:n.name," has unexpectedly closed."),t),e._db=null,e._instance=null},e._db.onerror=function(t){var n;console.warn("The database ".concat(null===(n=e._db)||void 0===n?void 0:n.name," has opening error."),t),e._db=null,e._instance=null},e._db.onabort=function(t){var n;console.warn("The database ".concat(null===(n=e._db)||void 0===n?void 0:n.name," has opening aborted."),t),e._db=null,e._instance=null}),e._instance=new e},t.onupgradeneeded=function(t){e._db=t.target.result,Xp(t)}}else console.debug("IndexDB is not currently supported in the environment!")},e.getInstance=function(){return e._instance},e.prototype.addList=function(t,n){return new Promise((function(r){if(e._db){var i=e._db.transaction([t],"readwrite"),o=i.objectStore(t);n.forEach((function(e){null==o||o.add(e)})),i.oncomplete=function(e){r(!0)},i.onerror=function(e){r(!1)}}else r(!1)}))},e.prototype.getRangeData=function(t,n,r,i){return new Promise((function(o){if(e._db){var s=e._db.transaction([t],"readwrite").objectStore(t),a=IDBKeyRange.bound(r,i),c=s.index(n),u=[],l=c.openCursor(a);l.onsuccess=function(e){var t=e.target.result;t?(u.push(t.value),t.continue()):o(u)},l.onerror=function(e){console.error(e),o([])}}else o([])}))},e.prototype.getCount=function(t,n){return new Promise((function(n){if(e._db){var r=e._db.transaction([t],"readonly").objectStore(t).count();r.onsuccess=function(){n(r.result)},r.onerror=function(e){console.error(e),n(0)}}else n(0)}))},e.prototype.removeFirstData=function(t,n,r){return new Promise((function(n){if(e._db){var i=e._db.transaction([t],"readwrite").objectStore(t),o=i.getAllKeys(IDBKeyRange.lowerBound(0),r);o.onsuccess=function(){var e=o.result;e.length>0&&(i.delete(IDBKeyRange.bound(e[0],e[e.length-1])).onsuccess=function(){n(!0)})}}else n(!1)}))},e._db=null,e}(),eg=function(){function e(){}return e.compress=function(e){for(var t=this,n={},r=0;r<e.length-1;r++){var i=e.charAt(r)+e.charAt(r+1);n.hasOwnProperty(i)?n[i].push(r):n[i]=[r]}for(var o=[],s=[],a=function(){if(s.length>0){var e=s.join("");if(s=[],e.length>26){var n=t.numberEncode(e.length),r=String.fromCharCode(t.dataType.NormalExt|n.length);o.push(r+n)}else{var i=String.fromCharCode(t.dataType.Normal|e.length);o.push(i)}o.push(e)}},c=0;c<e.length;){var u=t.indexOf(n,e,c);if(u.length<2)s.push(e.charAt(c++));else if(u.length<4)s.push(e.substr(c,u.length)),c+=u.length;else{var l=t.numberEncode(c-u.offset),h=t.numberEncode(u.length);if(l.length+h.length>=u.length)s.push(e.substr(c,u.length)),c+=u.length;else{a();var d=String.fromCharCode(t.dataType.Compressed|l.length<<2|h.length);o.push(d+l+h),c+=u.length}}}a();var f=t.numberEncode(e.length),p=String.fromCharCode(t.dataType.Tail|f.length);return o.push(p+f),o.join("")},e.uncompress=function(e){var t=this,n=0,r="";e:do{var i=e.charCodeAt(n++),o=i&t.dataType.Mark,s=15&i,a=void 0;switch(o){case t.dataType.Compressed:var c=s>>2,u=3&s;if(0===c||0===u)throw new Error("Data parsing error,at "+n);var l=t.numberDecode(e.substr(n,c)),h=t.numberDecode(e.substr(n+=c,u));if((l=r.length-l)+h>r.length)throw new Error("Data parsing error,at "+n);n+=u,r+=r.substr(l,h);break;case t.dataType.Tail:if((a=t.numberDecode(e.substr(n,s)))!==r.length)throw console.log(r.length),console.log(a),new Error("Data parsing error,at "+n);n+=s;break e;case t.dataType.NormalExt:a=t.numberDecode(e.substr(n,s)),r+=e.substr(n+=s,a),n+=a;break;case t.dataType.Normal:r+=e.substr(n,s),n+=s;break;case t.dataType.Mark:if(s>10)throw new Error("Data parsing error,at "+n);r+=e.substr(n,16+s),n+=16+s;break;default:throw new Error("Data parsing error,at "+n+" header:"+o)}}while(n<e.length);return r},e.indexOf=function(e,t,n){var r={length:0,offset:-1};if(t.length,n>=t.length-1)return r;var i=e[t.charAt(n)+t.charAt(n+1)];if(i[0]===n)return r;for(var o=t.length-n,s=0,a=i.length;s<a;s++){var c=i[s],u=n-c;if(!(u>this.max)){var l=Math.min(o,u);if(l<=r.length)break;if(!(r.length>2&&t.charAt(c+r.length-1)!==t.charAt(n+r.length-1))){for(var h=2,d=h;d<l&&t.charAt(c+d)===t.charAt(n+d);d++)h++;h>=r.length&&(r.length=h,r.offset=c)}}}return r},e.numberEncode=function(e){var t=this,n=[],r=0;do{r=e%t.scale,n.push(t.chars.charAt(r)),e=(e-r)/t.scale}while(e>0);return n.join("")},e.numberDecode=function(e){for(var t=0,n=0,r=e.length-1;r>=0;r--){if(-1===(n=this.chars.indexOf(e.charAt(r))))throw new Error('decode number error, data is "'+e+'"');t=t*this.scale+n}return t},e.dataType={Tail:48,Compressed:64,NormalExt:80,Normal:96,Mark:112},e.chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",e.scale=e.chars.length,e.max=238327,e}();!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE",e[e.ULTRA_GROUP=10]="ULTRA_GROUP",e[e.RTC_ROOM=12]="RTC_ROOM"}(Zp||(Zp={}));var tg,ng=Zp;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=4]="FILE",e[e.SIGHT=5]="SIGHT",e[e.COMBINE_HTML=6]="COMBINE_HTML"}(tg||(tg={}));var rg,ig,og,sg,ag,cg=tg,ug=function(e){return"string"==typeof e},lg=function(e){return"boolean"==typeof e},hg=function(e){return"number"==typeof e&&!isNaN(e)},dg=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")},fg=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)},pg=function(e){return ug(e)&&e.length>0},gg=function(e){return"[object Object]"===Object.prototype.toString.call(e)},vg=function(e){return"[object Function]"===Object.prototype.toString.call(e)},yg=function(e){return void 0===e||"[object Undefined]"===Object.prototype.toString.call(e)},mg=function(e){return"[object Null]"===Object.prototype.toString.call(e)},_g=function(e){for(var t in e)return!0;return!1},Cg=function(e){var t=!1,n=!1,r=!1;if(gg(e)){var i=Object.keys(e).length;for(var o in t=i>20,e)if(n||(n=ug(o)&&!/^[A-Za-z0-9_=+-]+$/.test(o)),!r){var s=e[o];r=o.length>32||s.length>4096}}return{isExceedLimit:t,isIllgalEx:n,isExKeyOrValLengthExceedLimit:r}},Eg=function(e){return ug(e)&&/https?:\/\//.test(e)},Tg=function(){function e(e){this.info=e,this.logUrl="logcollection.ronghub.com",this.level=1,this.itv=30,this.times=5,this.deviceId="",this.deviceInfo="",this.logSwitch=0,this.logUrl=e.logPolicy.url||this.logUrl,this.level=e.logPolicy.level||this.level,this.itv=e.logPolicy.itv||this.itv,this.times=e.logPolicy.times||this.times,this.deviceId=xp(e.runtime),this.logSwitch=e.logSwitch;var t=kf(e.runtime);this.deviceInfo="".concat(t.type,"|").concat(t.version,"|").concat(null==e?void 0:e.sessionId)}return e.prototype.updateUploadLogAttr=function(e){var t=e.logPolicy,n=e.logSwitch,r=e.runtime,i=e.sessionId,o=void 0===i?"":i,s=e.userId;if(t){var a=t.url,c=t.level,u=t.itv,l=t.times;this.logUrl=a||this.logUrl,this.level=c||this.level,this.itv=u||this.itv,this.times=l||this.times}if(n&&(this.logSwitch=n),r){this.deviceId=xp(r);var h=kf(r);this.deviceInfo="".concat(h.type,"|").concat(h.version,"|").concat(o)}s&&(this.info.userId=s)},e.init=function(t){return e.reportSwitch=!0,e._instance||(e._instance=new e(t)),e._instance},e.getInstance=function(){return e._instance},e.prototype.reportRealtimeLog=function(t){var n=this;if(0===t.length||!this.logUrl)return Promise.resolve();var r=eg.compress(t.map((function(e){return e.content})).join("")),i=Eg(this.logUrl)?"":"https://",o="".concat(i).concat(this.logUrl,"?version=").concat(this.info.version,"&appkey=").concat(this.info.appkey,"&userId=").concat(this.info.userId,"&deviceId=").concat(this.deviceId,"&deviceInfo=").concat(this.deviceInfo,"&platform=Web");return this.info.runtime.httpReq({method:"POST",url:o,body:r}).then((function(t){var r=t.data;r&&(r=JSON.parse(r),n.itv=r.nextTime,n.level=r.level,n.logSwitch=r.logSwitch,e.currentRTTimes=1)}))},e.prototype.reportFullLog=function(t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l,h,d=this;return da(this,(function(f){switch(f.label){case 0:return n=t.startTime,r=t.endTime,i=t.platform,o=t.logId,s=t.uri,a=$p.getInstance(),"web"===i.toLowerCase()&&a?n>r?[2]:[4,a.getRangeData(zp,"time",n,r)]:[2];case 1:return c=(c=f.sent()).filter((function(e){return!e.userId||e.userId===d.info.userId})),u=eg.compress(c.map((function(e){return e.content})).join("")||"no data"),5e3,l=1,[2,(h=function(){if(l>3||!e.reportSwitch)return Promise.resolve();var t=s||d.logUrl,n=Eg(t)?"":"https://",r="".concat(n).concat(t,"?version=").concat(d.info.version,"&appkey=").concat(d.info.appkey,"&userId=").concat(d.info.userId,"&logId=").concat(o,"&deviceId=").concat(d.deviceId,"&deviceInfo=").concat(d.deviceInfo,"&platform=Web"),i=5e3*(l-1);return l++,new Promise((function(t,n){setTimeout((function(){e.reportSwitch&&d.info.runtime.httpReq({url:r,method:"POST",body:u}).then((function(){t()})).catch((function(e){n(e),h()}))}),i)}))})()]}}))}))},e.prototype.distroy=function(){e.currentRTTimes=1,e.reportSwitch=!1},e.currentRTTimes=1,e.reportSwitch=!1,e}();e.LogLevel=void 0,(rg=e.LogLevel||(e.LogLevel={}))[rg.LOG=0]="LOG",rg[rg.DEBUG=0]="DEBUG",rg[rg.INFO=1]="INFO",rg[rg.WARN=2]="WARN",rg[rg.ERROR=3]="ERROR",rg[rg.FATAL=4]="FATAL",rg[rg.STATISTICS=6]="STATISTICS",rg[rg.NONE=1e3]="NONE",function(e){e.IM="IM",e.RTC="RTC"}(ig||(ig={})),function(e){e[e.PRIVATE=1]="PRIVATE",e[e.OPEN=0]="OPEN"}(og||(og={})),function(e){e[e.NAVI=1]="NAVI",e[e.TCP=2]="TCP",e[e.WS=3]="WS"}(sg||(sg={}));var Ig={};console&&((ag={})[e.LogLevel.DEBUG]=console.debug.bind(console),ag[e.LogLevel.INFO]=console.info.bind(console),ag[e.LogLevel.WARN]=console.warn.bind(console),ag[e.LogLevel.ERROR]=console.error.bind(console),ag[e.LogLevel.FATAL]=console.log.bind(console),Ig=ag);var Rg=function(e){return ug(e)||hg(e)||yg(e)||lg(e)?e:e instanceof Error?JSON.stringify({name:e.name,message:e.message,stack:e.stack}):JSON.stringify(e)},Sg=function(){function t(t,n,r){this.tag=t,this.type=n,this.initiator=r,this._outLevel=e.LogLevel.WARN,this.debug=this.log.bind(this,e.LogLevel.DEBUG),this.info=this.log.bind(this,e.LogLevel.INFO),this.warn=this.log.bind(this,e.LogLevel.WARN),this.error=this.log.bind(this,e.LogLevel.ERROR),this.fatal=this.log.bind(this,e.LogLevel.FATAL),this.statisticsCaches={},this.baseStatisData={sdkPrivate:og.OPEN,serverPrivate:og.OPEN,bundleId:"lib-next"}}return t.init=function(e){t.userId=e},t.reset=function(){t.userId=""},t.prototype._defaultStdout=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];Ig[e]&&Ig[e].apply(Ig,fa(["".concat(t,":")],n,!1))},t.prototype.__pushLocalLog=function(n,r,i){var o;o=this.type?this.type:["RCRTCLog","RCCall","RCRTC","RTC-A"].includes(this.tag)?ig.RTC:ig.IM;var s=Date.now();Yc(r)>=1e3&&(r=function(e,t,n){if(void 0===n&&(n="utf-8"),!e||!t)return"";var r="utf-8"===n?3:2,i=0,o=0,s="";for(o=0;o<e.length;o++){if(e.charCodeAt(o)>255?i+=r:i++,i>t)return s;s+=e.charAt(o)}return e}(r,1e3));var a=JSON.stringify({message:r,userId:t.userId}).replace(/"/g,'""'),c=/^[\w]+-[\w]+-[\w]+?/.test(i)?i:"".concat(this.initiator||"L","-").concat(i,"-O"),u={sessionId:t.sessionId,time:s,level:4-n,content:"".concat(t.sessionId,",").concat(Date.now(),",").concat(o,",").concat(4-n,",").concat(c,',"').concat(a,'"\n'),userId:t.userId};t.databaseLogList.push(u),(t.databaseLogList.length>=100||n===e.LogLevel.FATAL)&&this.__insertLogIntoDatabase()},t.prototype.__insertLogIntoDatabase=function(){return ha(this,void 0,void 0,(function(){var e,n,r;return da(this,(function(i){switch(i.label){case 0:return e=fa([],t.databaseLogList,!0),t.databaseLogList=[],(n=$p.getInstance())?[4,n.addList(zp,e)]:[3,3];case 1:return r=i.sent(),[4,n.getCount(zp,"time")];case 2:return i.sent()>1e5&&n.removeFirstData(zp,"time",2e3),[2,r];case 3:return[2,!1]}}))}))},t.prototype.setLogLevel=function(t){this._outLevel="number"!=typeof t?e.LogLevel.WARN:t},t.prototype.setLogStdout=function(e){this._logStdout=e},t.prototype.log=function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(t>e.LogLevel.DEBUG&&this.__pushLocalLog(t,n.map(Rg).join(" "),this.tag),!(t<this._outLevel)){var i="".concat((new Date).toISOString(),"[").concat(this.tag,"][").concat(e.LogLevel[t],"]"),o="".concat(i," - ").concat(n.map(Rg).join(" "));this._logStdout?this._logStdout(t,o):this._stdout?this._stdout(t,o):this._defaultStdout.apply(this,fa([t,i],n,!1))}},t.prototype.reportLog=function(e,n,r){this.__pushLocalLog(4-e,r,n);var i=JSON.stringify({message:r}).replace(/"/g,'""');i='"'.concat(i,'"');var o={level:e,content:[t.sessionId,Date.now(),this.type,e,n,i].join()+"\n"};t.realTimeLogList.push(o),t.realTimeLogList.length>=600&&(t.realTimeLogList=t.realTimeLogList.slice(-500))},t.prototype.set=function(e,t){this.warn("logger.set has being deprecated!")},t.prototype.setStdout=function(e){this._stdout=e},t.prototype.__clearRealTimeLog=function(){t.realTimeLogList=[]},t.prototype.initReportLog=function(e){t._reportLog=Tg.init(la(la({},e),{sessionId:t.sessionId})),this.startReport()},t.prototype.updateUploadLogAttr=function(e){t._reportLog&&t._reportLog.updateUploadLogAttr(e)},t.prototype.startReport=function(){var e=this;if(t._reportLog&&t._reportLog.logSwitch&&Tg.reportSwitch){var n=t._reportLog.itv*Math.pow(2,Tg.currentRTTimes-1);Tg.currentRTTimes<t._reportLog.times&&Tg.currentRTTimes++,setTimeout((function(){var n=t.realTimeLogList.filter((function(e){return e.level<=t._reportLog.level}));0===n.length?e.startReport():t._reportLog.reportRealtimeLog(n).then((function(){e.__clearRealTimeLog(),e.debug("reportÂ real-timeÂ logÂ success"),e.startReport()})).catch((function(t){e.debug("report real-time log error -> "+t),e.startReport()}))}),1e3*n)}},t.prototype.reportStatisticsLog=function(n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u=this;return da(this,(function(l){return n&&t._reportLog?(r=gg(r)?JSON.stringify(r):r,i=4-e.LogLevel.STATISTICS,this.__pushLocalLog(i,String(r),n),o=JSON.stringify({message:r}).replace(/"/g,'""'),o='"'.concat(o,'"'),s=this.type,this.type||(s=["RCRTCLog","RCCall","RCRTC","RTC-A"].includes(this.tag)?ig.RTC:ig.IM),a={level:i,content:[t.sessionId,Date.now(),s,i,n,o].join()+"\n"},t.realTimeLogList.push(a),c=t.realTimeLogList.filter((function(e){return e.level<=t._reportLog.level})),this.__clearRealTimeLog(),t._reportLog.reportRealtimeLog(c).then((function(){u.debug("reportÂ real-timeÂ logÂ success")})).catch((function(e){u.debug("report real-time log error -> "+e)})),[2]):[2]}))}))},t.prototype.updateStatisticsBaseData=function(e){this.baseStatisData.sdkPrivate=e.sdkPrivate===og.PRIVATE?og.PRIVATE:og.OPEN,this.baseStatisData.serverPrivate=e.serverPrivate===og.PRIVATE?og.PRIVATE:og.OPEN,e.bundleId&&(this.baseStatisData.bundleId=e.bundleId)},t.prototype.getStatisticsBaseData=function(){return this.baseStatisData},t.prototype.setStatisticsData=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n=!1),gg(t)&&e&&(this.statisticsCaches[e]&&!n||(this.statisticsCaches[e]={}),this.statisticsCaches[e]=la(la({},this.statisticsCaches[e]),t))},t.prototype.getStatisticsData=function(e){return this.statisticsCaches[e]||{}},t.databaseLogList=[],t.realTimeLogList=[],t.sessionId=Dp(),t.userId="",t}(),Mg=new Sg("RCLog"),Ng=Qr,Og=r,wg=er,Ag=zn,Ug=or,bg=Pe,Lg=Is,Pg=ts,Dg=Ns("splice"),xg=Og.TypeError,kg=Math.max,Vg=Math.min,Bg=9007199254740991,Gg="Maximum allowed length exceeded";Ng({target:"Array",proto:!0,forced:!Dg},{splice:function(e,t){var n,r,i,o,s,a,c=bg(this),u=Ug(c),l=wg(e,u),h=arguments.length;if(0===h?n=r=0:1===h?(n=0,r=u-l):(n=h-2,r=Vg(kg(Ag(t),0),u-l)),u+n-r>Bg)throw xg(Gg);for(i=Lg(c,r),o=0;o<r;o++)(s=l+o)in c&&Pg(i,o,c[s]);if(i.length=r,n<r){for(o=l;o<u-r;o++)a=o+n,(s=o+r)in c?c[a]=c[s]:delete c[a];for(o=u;o>u-r+n;o--)delete c[o-1]}else if(n>r)for(o=u-r;o>l;o--)a=o+n-1,(s=o+r-1)in c?c[a]=c[s]:delete c[a];for(o=0;o<n;o++)c[o+l]=arguments[o+2];return c.length=u-r+n,i}});var Fg,Kg=function(){function e(){this._map={}}return e.prototype.on=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n})},e.prototype.once=function(e,t,n){var r=this._map[e]||(this._map[e]=[]);r.some((function(e){return e.listener===t&&e.target===n}))||r.push({listener:t,target:n,once:!0})},e.prototype.off=function(e,t,n){var r=this._map[e];r&&((r=r.filter((function(e){return e.listener!==t||e.target!==n}))).length?this._map[e]=r:delete this._map[e])},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this._map[e];if(r)for(var i=r.length-1;i>=0;i-=1){var o=r[i],s=o.target,a=o.once,c=o.listener;a&&r.splice(i,1);try{c.call.apply(c,fa([s],t,!1))}catch(e){Mg.error(e)}}},e.prototype.removeAll=function(e){delete this._map[e]},e.prototype.clear=function(){Object.keys(this._map).forEach(this.removeAll,this)},e}();!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(Fg||(Fg={}));var qg,Hg=Fg;!function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.PARAMETER_ERROR=-3]="PARAMETER_ERROR",e[e.EXTRA_METHOD_UNDEFINED=-4]="EXTRA_METHOD_UNDEFINED",e[e.MAIN_PROCESS_ERROR=-5]="MAIN_PROCESS_ERROR",e[e.PARAMETER_CHANGED=-6]="PARAMETER_CHANGED",e[e.SUCCESS=0]="SUCCESS",e[e.RC_MSG_UNAUTHORIZED=20406]="RC_MSG_UNAUTHORIZED",e[e.RC_DISCUSSION_GROUP_ID_INVALID=20407]="RC_DISCUSSION_GROUP_ID_INVALID",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.RECALL_MESSAGE=25101]="RECALL_MESSAGE",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.RC_CHATROOM_USER_KICKED=23409]="RC_CHATROOM_USER_KICKED",e[e.RC_CHATROOM_NOT_EXIST=23410]="RC_CHATROOM_NOT_EXIST",e[e.RC_CHATROOM_IS_FULL=23411]="RC_CHATROOM_IS_FULL",e[e.RC_CHATROOM_PATAMETER_INVALID=23412]="RC_CHATROOM_PATAMETER_INVALID",e[e.CHATROOM_GET_HISTORYMSG_ERROR=23413]="CHATROOM_GET_HISTORYMSG_ERROR",e[e.CHATROOM_NOT_OPEN_HISTORYMSG_STORE=23414]="CHATROOM_NOT_OPEN_HISTORYMSG_STORE",e[e.CHATROOM_KV_EXCEED=23423]="CHATROOM_KV_EXCEED",e[e.CHATROOM_KV_OVERWRITE_INVALID=23424]="CHATROOM_KV_OVERWRITE_INVALID",e[e.CHATROOM_KV_STORE_NOT_OPEN=23426]="CHATROOM_KV_STORE_NOT_OPEN",e[e.CHATROOM_KEY_NOT_EXIST=23427]="CHATROOM_KEY_NOT_EXIST",e[e.CHATROOM_KV_SET_ERROR=23431]="CHATROOM_KV_SET_ERROR",e[e.SENSITIVE_SHIELD=21501]="SENSITIVE_SHIELD",e[e.SENSITIVE_REPLACE=21502]="SENSITIVE_REPLACE",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_MSG_CONTENT_EXCEED_LIMIT=30016]="RC_MSG_CONTENT_EXCEED_LIMIT",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_APP_AUTH_NOT_PASS=31026]="RC_APP_AUTH_NOT_PASS",e[e.RC_OTP_USED=31027]="RC_OTP_USED",e[e.RC_PLATFORM_ERROR=31028]="RC_PLATFORM_ERROR",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.MSG_INSERT_ERROR=33008]="MSG_INSERT_ERROR",e[e.MSG_DEL_ERROR=33009]="MSG_DEL_ERROR",e[e.TAG_EXISTS=33101]="TAG_EXISTS",e[e.TAG_NOT_EXIST=33100]="TAG_NOT_EXIST",e[e.NO_TAG_IN_CONVER=33102]="NO_TAG_IN_CONVER",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.CONVER_CLEAR_ERROR=34007]="CONVER_CLEAR_ERROR",e[e.EXPANSION_LIMIT_EXCEET=34010]="EXPANSION_LIMIT_EXCEET",e[e.MESSAGE_KV_NOT_SUPPORT=34008]="MESSAGE_KV_NOT_SUPPORT",e[e.CLEAR_HIS_TIME_ERROR=34011]="CLEAR_HIS_TIME_ERROR",e[e.CONVER_OUT_LIMIT_ERROR=34013]="CONVER_OUT_LIMIT_ERROR",e[e.CONVER_GET_ERROR=35021]="CONVER_GET_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.READ_RECEIPT_ERROR=35003]="READ_RECEIPT_ERROR",e[e.PACKAGE_ENVIRONMENT_ERROR=35006]="PACKAGE_ENVIRONMENT_ERROR",e[e.CAN_NOT_RECONNECT=35007]="CAN_NOT_RECONNECT",e[e.SERVER_UNAVAILABLE=35008]="SERVER_UNAVAILABLE",e[e.HOSTNAME_ERROR=35009]="HOSTNAME_ERROR",e[e.HAS_OHTER_SAME_CLIENT_ON_LINE=35010]="HAS_OHTER_SAME_CLIENT_ON_LINE",e[e.METHOD_NOT_AVAILABLE=35011]="METHOD_NOT_AVAILABLE",e[e.METHOD_NOT_SUPPORT=35012]="METHOD_NOT_SUPPORT",e[e.MSG_LIMIT_ERROR=35013]="MSG_LIMIT_ERROR",e[e.METHOD_ONLY_SUPPORT_ULTRA_GROUP=35014]="METHOD_ONLY_SUPPORT_ULTRA_GROUP",e[e.UPLOAD_FILE_FAILED=35020]="UPLOAD_FILE_FAILED",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.CHATROOM_KV_NOT_FOUND=36004]="CHATROOM_KV_NOT_FOUND",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.NOT_SUPPORT=39002]="NOT_SUPPORT",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE",e[e.GET_MESSAGE_BY_ID_ERROR=61001]="GET_MESSAGE_BY_ID_ERROR",e[e.HAVNODEVICEID=24001]="HAVNODEVICEID",e[e.DEVICEIDISHAVE=24002]="DEVICEIDISHAVE",e[e.FEILD=24009]="FEILD",e[e.VOIPISNULL=24013]="VOIPISNULL",e[e.NOENGINETYPE=24010]="NOENGINETYPE",e[e.NULLCHANNELNAME=24011]="NULLCHANNELNAME",e[e.VOIPDYANMICERROR=24012]="VOIPDYANMICERROR",e[e.NOVOIP=24014]="NOVOIP",e[e.INTERNALERRROR=24015]="INTERNALERRROR",e[e.VOIPCLOSE=24016]="VOIPCLOSE",e[e.CLOSE_BEFORE_OPEN=51001]="CLOSE_BEFORE_OPEN",e[e.ALREADY_IN_USE=51002]="ALREADY_IN_USE",e[e.INVALID_CHANNEL_NAME=51003]="INVALID_CHANNEL_NAME",e[e.VIDEO_CONTAINER_IS_NULL=51004]="VIDEO_CONTAINER_IS_NULL",e[e.DELETE_MESSAGE_ID_IS_NULL=61001]="DELETE_MESSAGE_ID_IS_NULL",e[e.CANCEL=1]="CANCEL",e[e.REJECT=2]="REJECT",e[e.HANGUP=3]="HANGUP",e[e.BUSYLINE=4]="BUSYLINE",e[e.NO_RESPONSE=5]="NO_RESPONSE",e[e.ENGINE_UN_SUPPORTED=6]="ENGINE_UN_SUPPORTED",e[e.NETWORK_ERROR=7]="NETWORK_ERROR",e[e.REMOTE_CANCEL=11]="REMOTE_CANCEL",e[e.REMOTE_REJECT=12]="REMOTE_REJECT",e[e.REMOTE_HANGUP=13]="REMOTE_HANGUP",e[e.REMOTE_BUSYLINE=14]="REMOTE_BUSYLINE",e[e.REMOTE_NO_RESPONSE=15]="REMOTE_NO_RESPONSE",e[e.REMOTE_ENGINE_UN_SUPPORTED=16]="REMOTE_ENGINE_UN_SUPPORTED",e[e.REMOTE_NETWORK_ERROR=17]="REMOTE_NETWORK_ERROR",e[e.VOIP_NOT_AVALIABLE=18]="VOIP_NOT_AVALIABLE",e[e.CHATROOM_KV_STORE_NOT_ALL_SUCCESS=23428]="CHATROOM_KV_STORE_NOT_ALL_SUCCESS",e[e.CHATROOM_KV_STORE_OUT_LIMIT=23429]="CHATROOM_KV_STORE_OUT_LIMIT"}(qg||(qg={}));var jg,Yg=qg;!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.CONNECTION_CLOSED=4]="CONNECTION_CLOSED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.WEBSOCKET_UNAVAILABLE=7]="WEBSOCKET_UNAVAILABLE",e[e.WEBSOCKET_ERROR=8]="WEBSOCKET_ERROR",e[e.BLOCKED=9]="BLOCKED",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT",e[e.DISCONNECT_BY_SERVER=13]="DISCONNECT_BY_SERVER",e[e.REDIRECT=14]="REDIRECT",e[e.APPKEY_IS_FAKE=20]="APPKEY_IS_FAKE",e[e.ULTRALIMIT=1101]="ULTRALIMIT",e[e.REQUEST_NAVI=201]="REQUEST_NAVI",e[e.RESPONSE_NAVI=202]="RESPONSE_NAVI",e[e.RESPONSE_NAVI_ERROR=203]="RESPONSE_NAVI_ERROR",e[e.RESPONSE_NAVI_TIMEOUT=204]="RESPONSE_NAVI_TIMEOUT"}(jg||(jg={}));var Wg,Qg=jg,Jg={ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11,HOSTNAME_ERROR:12,HASOHTERSAMECLIENTONLINE:13,IN_OTHER_CLUSTER:15,APP_AUTH_NOT_PASS:16,OTP_USED:17,PLATFORM_ERROR:18};!function(e){e.TextMessage="RC:TxtMsg",e.VOICE="RC:VcMsg",e.HQ_VOICE="RC:HQVCMsg",e.IMAGE="RC:ImgMsg",e.GIF="RC:GIFMsg",e.RICH_CONTENT="RC:ImgTextMsg",e.LOCATION="RC:LBSMsg",e.FILE="RC:FileMsg",e.SIGHT="RC:SightMsg",e.COMBINE="RC:CombineMsg",e.CHRM_KV_NOTIFY="RC:chrmKVNotiMsg",e.LOG_COMMAND="RC:LogCmdMsg",e.EXPANSION_NOTIFY="RC:MsgExMsg",e.REFERENCE="RC:ReferenceMsg",e.RECALL="RC:RcCmd",e.READ_RECEIPT="RC:ReadNtf",e.READ_RECEIPT_REQUEST="RC:RRReqMsg",e.READ_RECEIPT_RESPONSE="RC:RRRspMsg",e.SYNC_READ_STATUS="RC:SRSMsg",e.GROUP_READ_RECEIPT_REQUEST="RC:RRMsg",e.CHATROOM_JOIN="RC:ChrmJoinNtf",e.CHATROOM_LEFT="RC:ChrmQuitNtf",e.CHATROOM_MERGE_CHANGE="RC:ChrmMemChange",e.TYPING_STATUS="RC:TypSts",e.INTERCEPT="RC:InterceptMsg"}(Wg||(Wg={}));var zg,Xg=Wg;!function(e){e[e.OPEN=1]="OPEN",e[e.CLOSE=2]="CLOSE"}(zg||(zg={}));var Zg,$g=zg;!function(e){e[e.ALL_MESSAGE=-1]="ALL_MESSAGE",e[e.NOT_SET=0]="NOT_SET",e[e.AT_MESSAGE_NOTIFICATION=1]="AT_MESSAGE_NOTIFICATION",e[e.AT_USER_NOTIFICATION=2]="AT_USER_NOTIFICATION",e[e.AT_GROUP_ALL_USER_NOTIFICATION=4]="AT_GROUP_ALL_USER_NOTIFICATION",e[e.NOT_MESSAGE_NOTIFICATION=5]="NOT_MESSAGE_NOTIFICATION"}(Zg||(Zg={}));var ev,tv=Zg;!function(e){e[e.ALL=1]="ALL",e[e.SINGAL=2]="SINGAL"}(ev||(ev={}));var nv,rv=ev;!function(e){e[e.QINIU=1]="QINIU",e[e.ALI=2]="ALI",e[e.AWS=3]="AWS",e[e.STC=4]="STC"}(nv||(nv={}));var iv,ov=nv;!function(e){e[e.UPDATE=1]="UPDATE",e[e.DELETE=2]="DELETE"}(iv||(iv={}));var sv,av=iv;!function(e){e[e.QUIT=0]="QUIT",e[e.JOIN=1]="JOIN"}(sv||(sv={}));var cv,uv=sv;!function(e){e[e.GLOBAL=1]="GLOBAL",e[e.CUSTOM=2]="CUSTOM",e[e.THIRD_PARTY=3]="THIRD_PARTY"}(cv||(cv={}));var lv,hv=cv;!function(e){e[e.typing=0]="typing"}(lv||(lv={}));var dv,fv,pv,gv=lv;!function(e){e[e.RTC=0]="RTC",e[e.LIVE=2]="LIVE"}(dv||(dv={})),function(e){e[e.AUDIO_AND_VIDEO=0]="AUDIO_AND_VIDEO",e[e.AUDIO=1]="AUDIO"}(fv||(fv={})),function(e){e[e.ANCHOR=1]="ANCHOR",e[e.AUDIENCE=2]="AUDIENCE"}(pv||(pv={}));var vv,yv,mv,_v={"RC:VCAccept":"RC:VCAccept","RC:VCRinging":"RC:VCRinging","RC:VCSummary":"RC:VCSummary","RC:VCHangup":"RC:VCHangup","RC:VCInvite":"RC:VCInvite","RC:VCModifyMedia":"RC:VCModifyMedia","RC:VCModifyMem":"RC:VCModifyMem"};!function(e){e[e.ROOM=1]="ROOM",e[e.PERSON=2]="PERSON"}(vv||(vv={})),function(e){e[e.AnchorToViewer=1]="AnchorToViewer",e[e.ViewerToAnchor=2]="ViewerToAnchor"}(yv||(yv={})),function(e){e[e.KICK=0]="KICK",e[e.REFUSE=1]="REFUSE",e[e.COEXIST=2]="COEXIST"}(mv||(mv={}));var Cv=zn,Ev=ui,Tv=x,Iv=r.RangeError,Rv=R,Sv=rr,Mv=ui,Nv=x,Ov=Rv((function(e){var t=Ev(Tv(this)),n="",r=Cv(e);if(r<0||r==1/0)throw Iv("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n})),wv=Rv("".slice),Av=Math.ceil,Uv=function(e){return function(t,n,r){var i,o,s=Mv(Nv(t)),a=Sv(n),c=s.length,u=void 0===r?" ":Mv(r);return a<=c||""==u?s:((o=Ov(u,Av((i=a-c)/u.length))).length>i&&(o=wv(o,0,i)),e?s+o:o+s)}},bv={start:Uv(!1),end:Uv(!0)},Lv=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Q),Pv=bv.start;Qr({target:"String",proto:!0,forced:Lv},{padStart:function(e){return Pv(this,e,arguments.length>1?arguments[1]:void 0)}});var Dv="undefined"!=typeof window&&window?(window.__RCVersionInfo||(window.__RCVersionInfo={}),window.__RCVersionInfo):{};Dv.engine="5.3.3";var xv,kv,Vv=function(){function e(){}return e.add=function(e,t){Dv[e]=t},e.validEngine=function(e){var t=e.match(/\d+\.\d+\.\d+/);if(!t)return Mg.warn("The validation engine version '".concat(e,"' is invalid!")),!1;var n=t[0].split(".").map((function(e){return e.padStart(3,"0")})).join("");return Dv.engine.match(/\d+\.\d+\.\d+/)[0].split(".").map((function(e){return e.padStart(3,"0")})).join("")>=n},e.getInfo=function(){return Dv},e}();!function(e){e[e.STRING=0]="STRING",e[e.ONLY_STRING=1]="ONLY_STRING",e[e.NUMBER=2]="NUMBER",e[e.BOOLEAN=3]="BOOLEAN",e[e.OBJECT=4]="OBJECT",e[e.ARRAY=5]="ARRAY",e[e.CALLBACK=6]="CALLBACK",e[e.CHANNEL_ID=7]="CHANNEL_ID"}(kv||(kv={}));var Bv=((xv={})[kv.STRING]=pg,xv[kv.ONLY_STRING]=ug,xv[kv.NUMBER]=hg,xv[kv.BOOLEAN]=function(e){return"boolean"==typeof e},xv[kv.OBJECT]=gg,xv[kv.ARRAY]=dg,xv[kv.CALLBACK]=function(e){var t=!0;return gg(e)||(t=!1),(e=e||{}).onSuccess&&!vg(e.onSuccess)&&(t=!1),e.onError&&!vg(e.onError)&&(t=!1),t},xv[kv.CHANNEL_ID]=function(e){var t=!1;return ug(e)&&!/_/g.test(e)&&e.length<=20&&(t=!0),t},xv),Gv=function(e){function t(t){var n=e.call(this,t)||this;return n.name="RCAssertError",n}return ua(t,e),t}(Error),Fv=function(e,t,n,r){if(void 0===r&&(r=!1),!Kv(e,t,n,r))throw new Gv("'".concat(e,"' is invalid: ").concat(JSON.stringify(t)))},Kv=function(e,t,n,r){void 0===r&&(r=!1),n=Bv[n]||n;var i=r&&!n(t)||!r&&!(yg(t)||null===t||n(t));return i&&Mg.error("'".concat(e,"' is invalid: ").concat(JSON.stringify(t))),!i},qv=G,Hv=K,jv=ku,Yv=function(e,t,n){var r,i;return jv&&qv(r=t.constructor)&&r!==n&&Hv(i=r.prototype)&&i!==n.prototype&&jv(e,i),e},Wv=Ot.f,Qv=s,Jv=r,zv=R,Xv=Gr,Zv=Yv,$v=Qt,ey=Wn.f,ty=W,ny=Ff,ry=ui,iy=Ip,oy=vi,sy=function(e,t,n){n in e||Wv(e,n,{configurable:!0,get:function(){return t[n]},set:function(e){t[n]=e}})},ay=Jt.exports,cy=o,uy=ke,ly=An.enforce,hy=Yu,dy=qi,fy=Yi,py=$e("match"),gy=Jv.RegExp,vy=gy.prototype,yy=Jv.SyntaxError,_y=zv(vy.exec),Cy=zv("".charAt),Ey=zv("".replace),Ty=zv("".indexOf),Iy=zv("".slice),Ry=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Sy=/a/g,My=/a/g,Ny=new gy(Sy)!==Sy,Oy=oy.MISSED_STICKY,wy=oy.UNSUPPORTED_Y,Ay=Qv&&(!Ny||Oy||dy||fy||cy((function(){return My[py]=!1,gy(Sy)!=Sy||gy(My)==My||"/a/i"!=gy(Sy,"i")})));if(Xv("RegExp",Ay)){for(var Uy=function(e,t){var n,r,i,o,s,a,c=ty(vy,this),u=ny(e),l=void 0===t,h=[],d=e;if(!c&&u&&l&&e.constructor===Uy)return e;if((u||ty(vy,e))&&(e=e.source,l&&(t=iy(d))),e=void 0===e?"":ry(e),t=void 0===t?"":ry(t),d=e,dy&&"dotAll"in Sy&&(r=!!t&&Ty(t,"s")>-1)&&(t=Ey(t,/s/g,"")),n=t,Oy&&"sticky"in Sy&&(i=!!t&&Ty(t,"y")>-1)&&wy&&(t=Ey(t,/y/g,"")),fy&&(o=function(e){for(var t,n=e.length,r=0,i="",o=[],s={},a=!1,c=!1,u=0,l="";r<=n;r++){if("\\"===(t=Cy(e,r)))t+=Cy(e,++r);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:_y(Ry,Iy(e,r+1))&&(r+=2,c=!0),i+=t,u++;continue;case">"===t&&c:if(""===l||uy(s,l))throw new yy("Invalid capture group name");s[l]=!0,o[o.length]=[l,u],c=!1,l="";continue}c?l+=t:i+=t}return[i,o]}(e),e=o[0],h=o[1]),s=Zv(gy(e,t),c?this:vy,Uy),(r||i||h.length)&&(a=ly(s),r&&(a.dotAll=!0,a.raw=Uy(function(e){for(var t,n=e.length,r=0,i="",o=!1;r<=n;r++)"\\"!==(t=Cy(e,r))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+Cy(e,++r);return i}(e),n)),i&&(a.sticky=!0),h.length&&(a.groups=h)),e!==d)try{$v(s,"source",""===d?"(?:)":d)}catch(e){}return s},by=ey(gy),Ly=0;by.length>Ly;)sy(Uy,gy,by[Ly++]);vy.constructor=Uy,Uy.prototype=vy,ay(Jv,"RegExp",Uy)}hy("RegExp");var Py,Dy,xy,ky=function(e){if(!gg(e)||void 0===e.low||void 0===e.high)return e;var t=e.low;return t<0&&(t+=4294967296),t=t.toString(16),parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+t.length+"}$"),t),16)},Vy=function(e,t){var n=Math.floor(1e3*Math.random()%1e4),r=Pp(),i=function(e){e=e||"-";var t=new Date,n=t.getFullYear(),r=t.getMonth()+1,i=t.getDate();return"".concat(n).concat(e).concat(r).concat(e).concat(i)}(),o=(new Date).getTime(),s="";if(t){var a=t.split(".");s="."+a[a.length-1]}return"".concat(e,"__RC-").concat(i,"_").concat(n,"_").concat(o).concat(r).concat(s)},By=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=e.threadId,r=e.apnsCollapseId,i=e.category,o=e.richMediaUri,s=t.channelIdMi,a=t.channelIdHW,c=t.channelIdOPPO,u=t.typeVivo,l=t.googleConfig,h={};h["thread-id"]=n||"",h["apns-collapse-id"]=r||"",h.category=i||"",h.richMediaUri=o||"";var d={};d.collapse_key=null==l?void 0:l.collapseKey,d.imageUrl=null==l?void 0:l.imageUrl;var f=null==l?void 0:l.priority;f&&!["high","normal"].includes(f)&&(f="normal"),d.priority=f;var p=[{HW:{channelId:a||""}},{MI:{channelId:s||""}},{OPPO:{channelId:c||""}},{VIVO:{classification:u||""}},{APNS:h},{FCM:d}];return JSON.stringify(p)},Gy=function(e,t){var n={},r={notificationId:t||""};if(!e)return{iOSConfig:n,androidConfig:r};try{var i=JSON.parse(e);null==i||i.forEach((function(e){var t,i,o,s,a=Object.keys(e);if(0!==a.length){var c=a[0];switch(c){case"HW":return void(r.channelIdHW=null===(t=e[c])||void 0===t?void 0:t.channelId);case"MI":return void(r.channelIdMi=null===(i=e[c])||void 0===i?void 0:i.channelId);case"OPPO":return void(r.channelIdOPPO=null===(o=e[c])||void 0===o?void 0:o.channelId);case"VIVO":return void(r.typeVivo=null===(s=e[c])||void 0===s?void 0:s.classification);case"APNS":return n.threadId=e[c]["thread-id"],n.apnsCollapseId=e[c]["apns-collapse-id"],n.category=e[c].category,void(n.richMediaUri=e[c].richMediaUri);case"FCM":r.googleConfig={collapseKey:e[c].collapse_key||"",imageUrl:e[c].imageUrl||"",priority:e[c].priority||""}}}}))}catch(t){Mg.error("Wrong format for pushConfigs field! content: "+e)}return{iOSConfig:n,androidConfig:r}},Fy=function(e){var t=/^[A-Za-z0-9_=+-]+$/.test(e),n=e.length;return t&&(n<=128&&n>=1)},Ky=function(e){var t=e.length;return t<=4096&&t>=1},qy=function(e,t,n){t=t||function(){};var r=(n=n||{}).isReverse;gg(e)&&function(){for(var n in e)t(e[n],n,e)}(),(dg(e)||ug(e))&&function(){if(r)for(var n=e.length-1;n>=0;n--)t(e[n],n);else for(var i=0,o=e.length;i<o;i++)t(e[i],i)}()},Hy=function(e,t){return qy(e,(function(n,r){e[r]=t(n,r)})),e},jy=function(e,t){if(e.indexOf)return e.indexOf(t);var n=-1;return qy(e,(function(e,r){t===e&&(n=r)})),n},Yy=function(e,t){var n=[];return qy(e,(function(e){n.push(e)})),-1!==jy(n,t)},Wy=function(e){return JSON.parse(JSON.stringify(e))},Qy=function(){return"undefined"!=typeof RCCppEngine},Jy=function(e){switch(e){case Jg.SERVER_UNAVAILABLE:return Yg.SERVER_UNAVAILABLE;case Jg.TOKEN_INCORRECT:return Yg.RC_CONN_USER_OR_PASSWD_ERROR;case Jg.REDIRECT:return Yg.RC_CONN_REDIRECTED;case Jg.APP_BLOCK_OR_DELETE:return Yg.RC_CONN_APP_BLOCKED_OR_DELETED;case Jg.BLOCK:return Yg.RC_CONN_USER_BLOCKED;case Jg.TOKEN_EXPIRE:return Yg.RC_CONN_USER_OR_PASSWD_ERROR;case Jg.HOSTNAME_ERROR:return Yg.HOSTNAME_ERROR;case Jg.HASOHTERSAMECLIENTONLINE:return Yg.HAS_OHTER_SAME_CLIENT_ON_LINE;case Jg.APP_AUTH_NOT_PASS:return Yg.RC_APP_AUTH_NOT_PASS;case Jg.OTP_USED:return Yg.RC_OTP_USED;case Jg.PLATFORM_ERROR:return Yg.RC_PLATFORM_ERROR;default:return Yg.RC_NET_UNAVAILABLE}},zy=function e(t){var n;if("object"===zr(t)&&null!==t)if(Array.isArray(t))for(var r in n=[],t)n.push(e(t[r]));else for(var r in n={},t)n[r]=e(t[r]);else n=t;return n},Xy=function(e){var t;try{t=zy(e)}catch(n){Mg.error("clone err:",n),t=JSON.parse(JSON.stringify(e))}return t},Zy=function(e){var t={},n=JSON.parse(e);return qy(n,(function(e,n){t[n]=e.v})),t},$y={_delayTime:0,setTime:function(e){var t=(new Date).getTime();$y._delayTime=t-e},getTime:function(){var e=$y._delayTime;return(new Date).getTime()-e}},em=function(e,t){var n=0;return e.isAutoDelete&&(n|=1),e.isOverwrite&&(n|=2),2===t&&(n|=4),n},tm=!o((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),nm=r,rm=ke,im=G,om=Pe,sm=tm,am=hn("IE_PROTO"),cm=nm.Object,um=cm.prototype,lm=sm?cm.getPrototypeOf:function(e){var t=om(e);if(rm(t,am))return t[am];var n=t.constructor;return im(n)&&t instanceof n?n.prototype:t instanceof cm?um:null},hm=o,dm=G,fm=lm,pm=Jt.exports,gm=$e("iterator"),vm=!1;[].keys&&("next"in(xy=[].keys())?(Dy=fm(fm(xy)))!==Object.prototype&&(Py=Dy):vm=!0);var ym=null==Py||hm((function(){var e={};return Py[gm].call(e)!==e}));ym&&(Py={}),dm(Py[gm])||pm(Py,gm,(function(){return this}));var mm={IteratorPrototype:Py,BUGGY_SAFARI_ITERATORS:vm},_m=mm.IteratorPrototype,Cm=Gi,Em=m,Tm=Fu,Im=Id,Rm=function(){return this},Sm=Qr,Mm=l,Nm=xn,Om=G,wm=function(e,t,n,r){var i=t+" Iterator";return e.prototype=Cm(_m,{next:Em(+!r,n)}),Tm(e,i,!1),Im[i]=Rm,e},Am=lm,Um=ku,bm=Fu,Lm=Qt,Pm=Jt.exports,Dm=Id,xm=Nm.PROPER,km=Nm.CONFIGURABLE,Vm=mm.IteratorPrototype,Bm=mm.BUGGY_SAFARI_ITERATORS,Gm=$e("iterator"),Fm="keys",Km="values",qm="entries",Hm=function(){return this},jm=function(e,t,n,r,i,o,s){wm(n,t,r);var a,c,u,l=function(e){if(e===i&&g)return g;if(!Bm&&e in f)return f[e];switch(e){case Fm:case Km:case qm:return function(){return new n(this,e)}}return function(){return new n(this)}},h=t+" Iterator",d=!1,f=e.prototype,p=f[Gm]||f["@@iterator"]||i&&f[i],g=!Bm&&p||l(i),v="Array"==t&&f.entries||p;if(v&&(a=Am(v.call(new e)))!==Object.prototype&&a.next&&(Am(a)!==Vm&&(Um?Um(a,Vm):Om(a[Gm])||Pm(a,Gm,Hm)),bm(a,h,!0)),xm&&i==Km&&p&&p.name!==Km&&(km?Lm(f,"name",Km):(d=!0,g=function(){return Mm(p,this)})),i)if(c={values:l(Km),keys:o?g:l(Fm),entries:l(qm)},s)for(u in c)(Bm||d||!(u in f))&&Pm(f,u,c[u]);else Sm({target:t,proto:!0,forced:Bm||d},c);return f[Gm]!==g&&Pm(f,Gm,g,{name:i}),Dm[t]=g,c},Ym=B,Wm=au,Qm=Id,Jm=An,zm=Ot.f,Xm=jm,Zm=s,$m="Array Iterator",e_=Jm.set,t_=Jm.getterFor($m),n_=Xm(Array,"Array",(function(e,t){e_(this,{type:$m,target:Ym(e),index:0,kind:t})}),(function(){var e=t_(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),r_=Qm.Arguments=Qm.Array;if(Wm("keys"),Wm("values"),Wm("entries"),Zm&&"values"!==r_.name)try{zm(r_,"name",{value:"values"})}catch(e){}var i_="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,o_=zn,s_=rr,a_=r.RangeError,c_=function(e){if(void 0===e)return 0;var t=o_(e),n=s_(t);if(t!==n)throw a_("Wrong length or index");return n},u_=r.Array,l_=Math.abs,h_=Math.pow,d_=Math.floor,f_=Math.log,p_=Math.LN2,g_={pack:function(e,t,n){var r,i,o,s=u_(n),a=8*n-t-1,c=(1<<a)-1,u=c>>1,l=23===t?h_(2,-24)-h_(2,-77):0,h=e<0||0===e&&1/e<0?1:0,d=0;for((e=l_(e))!=e||e===1/0?(i=e!=e?1:0,r=c):(r=d_(f_(e)/p_),e*(o=h_(2,-r))<1&&(r--,o*=2),(e+=r+u>=1?l/o:l*h_(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(e*o-1)*h_(2,t),r+=u):(i=e*h_(2,u-1)*h_(2,t),r=0));t>=8;)s[d++]=255&i,i/=256,t-=8;for(r=r<<t|i,a+=t;a>0;)s[d++]=255&r,r/=256,a-=8;return s[--d]|=128*h,s},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,o=(1<<i)-1,s=o>>1,a=i-7,c=r-1,u=e[c--],l=127&u;for(u>>=7;a>0;)l=256*l+e[c--],a-=8;for(n=l&(1<<-a)-1,l>>=-a,a+=t;a>0;)n=256*n+e[c--],a-=8;if(0===l)l=1-s;else{if(l===o)return n?NaN:u?-1/0:1/0;n+=h_(2,t),l-=s}return(u?-1:1)*n*h_(2,l-t)}},v_=Pe,y_=er,m_=or,__=function(e){for(var t=v_(this),n=m_(t),r=arguments.length,i=y_(r>1?arguments[1]:void 0,n),o=r>2?arguments[2]:void 0,s=void 0===o?n:y_(o,n);s>i;)t[i++]=e;return t},C_=r,E_=R,T_=s,I_=i_,R_=xn,S_=Qt,M_=wu,N_=o,O_=Ju,w_=zn,A_=rr,U_=c_,b_=g_,L_=lm,P_=ku,D_=Wn.f,x_=Ot.f,k_=__,V_=Wf,B_=Fu,G_=R_.PROPER,F_=R_.CONFIGURABLE,K_=An.get,q_=An.set,H_="ArrayBuffer",j_="DataView",Y_="Wrong index",W_=C_.ArrayBuffer,Q_=W_,J_=Q_&&Q_.prototype,z_=C_.DataView,X_=z_&&z_.prototype,Z_=Object.prototype,$_=C_.Array,eC=C_.RangeError,tC=E_(k_),nC=E_([].reverse),rC=b_.pack,iC=b_.unpack,oC=function(e){return[255&e]},sC=function(e){return[255&e,e>>8&255]},aC=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},cC=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},uC=function(e){return rC(e,23,4)},lC=function(e){return rC(e,52,8)},hC=function(e,t){x_(e.prototype,t,{get:function(){return K_(this)[t]}})},dC=function(e,t,n,r){var i=U_(n),o=K_(e);if(i+t>o.byteLength)throw eC(Y_);var s=K_(o.buffer).bytes,a=i+o.byteOffset,c=V_(s,a,a+t);return r?c:nC(c)},fC=function(e,t,n,r,i,o){var s=U_(n),a=K_(e);if(s+t>a.byteLength)throw eC(Y_);for(var c=K_(a.buffer).bytes,u=s+a.byteOffset,l=r(+i),h=0;h<t;h++)c[u+h]=l[o?h:t-h-1]};if(I_){var pC=G_&&W_.name!==H_;if(N_((function(){W_(1)}))&&N_((function(){new W_(-1)}))&&!N_((function(){return new W_,new W_(1.5),new W_(NaN),pC&&!F_})))pC&&F_&&S_(W_,"name",H_);else{(Q_=function(e){return O_(this,J_),new W_(U_(e))}).prototype=J_;for(var gC,vC=D_(W_),yC=0;vC.length>yC;)(gC=vC[yC++])in Q_||S_(Q_,gC,W_[gC]);J_.constructor=Q_}P_&&L_(X_)!==Z_&&P_(X_,Z_);var mC=new z_(new Q_(2)),_C=E_(X_.setInt8);mC.setInt8(0,2147483648),mC.setInt8(1,2147483649),!mC.getInt8(0)&&mC.getInt8(1)||M_(X_,{setInt8:function(e,t){_C(this,e,t<<24>>24)},setUint8:function(e,t){_C(this,e,t<<24>>24)}},{unsafe:!0})}else J_=(Q_=function(e){O_(this,J_);var t=U_(e);q_(this,{bytes:tC($_(t),0),byteLength:t}),T_||(this.byteLength=t)}).prototype,X_=(z_=function(e,t,n){O_(this,X_),O_(e,J_);var r=K_(e).byteLength,i=w_(t);if(i<0||i>r)throw eC("Wrong offset");if(i+(n=void 0===n?r-i:A_(n))>r)throw eC("Wrong length");q_(this,{buffer:e,byteLength:n,byteOffset:i}),T_||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,T_&&(hC(Q_,"byteLength"),hC(z_,"buffer"),hC(z_,"byteLength"),hC(z_,"byteOffset")),M_(X_,{getInt8:function(e){return dC(this,1,e)[0]<<24>>24},getUint8:function(e){return dC(this,1,e)[0]},getInt16:function(e){var t=dC(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=dC(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return cC(dC(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return cC(dC(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return iC(dC(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return iC(dC(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){fC(this,1,e,oC,t)},setUint8:function(e,t){fC(this,1,e,oC,t)},setInt16:function(e,t){fC(this,2,e,sC,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){fC(this,2,e,sC,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){fC(this,4,e,aC,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){fC(this,4,e,aC,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){fC(this,4,e,uC,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){fC(this,8,e,lC,t,arguments.length>2?arguments[2]:void 0)}});B_(Q_,H_),B_(z_,j_);var CC={ArrayBuffer:Q_,DataView:z_},EC=Qr,TC=R,IC=o,RC=Pt,SC=er,MC=rr,NC=rl,OC=CC.ArrayBuffer,wC=CC.DataView,AC=wC.prototype,UC=TC(OC.prototype.slice),bC=TC(AC.getUint8),LC=TC(AC.setUint8);EC({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:IC((function(){return!new OC(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(UC&&void 0===t)return UC(RC(this),e);for(var n=RC(this).byteLength,r=SC(e,n),i=SC(void 0===t?n:t,n),o=new(NC(this,OC))(MC(i-r)),s=new wC(this),a=new wC(o),c=0;r<i;)LC(a,c++,bC(s,r++));return o}});var PC,DC,xC,kC={exports:{}},VC=i_,BC=s,GC=r,FC=G,KC=K,qC=ke,HC=si,jC=fe,YC=Qt,WC=Jt.exports,QC=Ot.f,JC=W,zC=lm,XC=ku,ZC=$e,$C=Ke,eE=GC.Int8Array,tE=eE&&eE.prototype,nE=GC.Uint8ClampedArray,rE=nE&&nE.prototype,iE=eE&&zC(eE),oE=tE&&zC(tE),sE=Object.prototype,aE=GC.TypeError,cE=ZC("toStringTag"),uE=$C("TYPED_ARRAY_TAG"),lE=$C("TYPED_ARRAY_CONSTRUCTOR"),hE=VC&&!!XC&&"Opera"!==HC(GC.opera),dE=!1,fE={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},pE={BigInt64Array:8,BigUint64Array:8},gE=function(e){if(!KC(e))return!1;var t=HC(e);return qC(fE,t)||qC(pE,t)};for(PC in fE)(xC=(DC=GC[PC])&&DC.prototype)?YC(xC,lE,DC):hE=!1;for(PC in pE)(xC=(DC=GC[PC])&&DC.prototype)&&YC(xC,lE,DC);if((!hE||!FC(iE)||iE===Function.prototype)&&(iE=function(){throw aE("Incorrect invocation")},hE))for(PC in fE)GC[PC]&&XC(GC[PC],iE);if((!hE||!oE||oE===sE)&&(oE=iE.prototype,hE))for(PC in fE)GC[PC]&&XC(GC[PC].prototype,oE);if(hE&&zC(rE)!==oE&&XC(rE,oE),BC&&!qC(oE,cE))for(PC in dE=!0,QC(oE,cE,{get:function(){return KC(this)?this[uE]:void 0}}),fE)GC[PC]&&YC(GC[PC],uE,PC);var vE={NATIVE_ARRAY_BUFFER_VIEWS:hE,TYPED_ARRAY_CONSTRUCTOR:lE,TYPED_ARRAY_TAG:dE&&uE,aTypedArray:function(e){if(gE(e))return e;throw aE("Target is not a typed array")},aTypedArrayConstructor:function(e){if(FC(e)&&(!XC||JC(iE,e)))return e;throw aE(jC(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(BC){if(n)for(var i in fE){var o=GC[i];if(o&&qC(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}oE[e]&&!n||WC(oE,e,n?t:hE&&tE[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(BC){if(XC){if(n)for(r in fE)if((i=GC[r])&&qC(i,e))try{delete i[e]}catch(e){}if(iE[e]&&!n)return;try{return WC(iE,e,n?t:hE&&iE[e]||t)}catch(e){}}for(r in fE)!(i=GC[r])||i[e]&&!n||WC(i,e,t)}},isView:function(e){if(!KC(e))return!1;var t=HC(e);return"DataView"===t||qC(fE,t)||qC(pE,t)},isTypedArray:gE,TypedArray:iE,TypedArrayPrototype:oE},yE=r,mE=o,_E=cf,CE=vE.NATIVE_ARRAY_BUFFER_VIEWS,EE=yE.ArrayBuffer,TE=yE.Int8Array,IE=!CE||!mE((function(){TE(1)}))||!mE((function(){new TE(-1)}))||!_E((function(e){new TE,new TE(null),new TE(1.5),new TE(e)}),!0)||mE((function(){return 1!==new TE(new EE(2),1,void 0).length})),RE=K,SE=Math.floor,ME=Number.isInteger||function(e){return!RE(e)&&isFinite(e)&&SE(e)===e},NE=zn,OE=r.RangeError,wE=function(e){var t=NE(e);if(t<0)throw OE("The argument can't be less than 0");return t},AE=r.RangeError,UE=function(e,t){var n=wE(e);if(n%t)throw AE("Wrong offset");return n},bE=mc,LE=l,PE=$u,DE=Pe,xE=or,kE=Bd,VE=bd,BE=Nd,GE=vE.aTypedArrayConstructor,FE=Qr,KE=r,qE=l,HE=s,jE=IE,YE=vE,WE=CC,QE=Ju,JE=m,zE=Qt,XE=ME,ZE=rr,$E=c_,eT=UE,tT=dt,nT=ke,rT=si,iT=K,oT=he,sT=Gi,aT=W,cT=ku,uT=Wn.f,lT=function(e){var t,n,r,i,o,s,a=PE(this),c=DE(e),u=arguments.length,l=u>1?arguments[1]:void 0,h=void 0!==l,d=VE(c);if(d&&!BE(d))for(s=(o=kE(c,d)).next,c=[];!(i=LE(s,o)).done;)c.push(i.value);for(h&&u>2&&(l=bE(l,arguments[2])),n=xE(c),r=new(GE(a))(n),t=0;n>t;t++)r[t]=h?l(c[t],t):c[t];return r},hT=Mc.forEach,dT=Yu,fT=Ot,pT=i,gT=Yv,vT=An.get,yT=An.set,mT=fT.f,_T=pT.f,CT=Math.round,ET=KE.RangeError,TT=WE.ArrayBuffer,IT=TT.prototype,RT=WE.DataView,ST=YE.NATIVE_ARRAY_BUFFER_VIEWS,MT=YE.TYPED_ARRAY_CONSTRUCTOR,NT=YE.TYPED_ARRAY_TAG,OT=YE.TypedArray,wT=YE.TypedArrayPrototype,AT=YE.aTypedArrayConstructor,UT=YE.isTypedArray,bT="BYTES_PER_ELEMENT",LT="Wrong length",PT=function(e,t){AT(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},DT=function(e,t){mT(e,t,{get:function(){return vT(this)[t]}})},xT=function(e){var t;return aT(IT,e)||"ArrayBuffer"==(t=rT(e))||"SharedArrayBuffer"==t},kT=function(e,t){return UT(e)&&!oT(t)&&t in e&&XE(+t)&&t>=0},VT=function(e,t){return t=tT(t),kT(e,t)?JE(2,e[t]):_T(e,t)},BT=function(e,t,n){return t=tT(t),!(kT(e,t)&&iT(n)&&nT(n,"value"))||nT(n,"get")||nT(n,"set")||n.configurable||nT(n,"writable")&&!n.writable||nT(n,"enumerable")&&!n.enumerable?mT(e,t,n):(e[t]=n.value,e)};HE?(ST||(pT.f=VT,fT.f=BT,DT(wT,"buffer"),DT(wT,"byteOffset"),DT(wT,"byteLength"),DT(wT,"length")),FE({target:"Object",stat:!0,forced:!ST},{getOwnPropertyDescriptor:VT,defineProperty:BT}),kC.exports=function(e,t,n){var r=e.match(/\d+$/)[0]/8,i=e+(n?"Clamped":"")+"Array",o="get"+e,s="set"+e,a=KE[i],c=a,u=c&&c.prototype,l={},h=function(e,t){mT(e,t,{get:function(){return function(e,t){var n=vT(e);return n.view[o](t*r+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var o=vT(e);n&&(i=(i=CT(i))<0?0:i>255?255:255&i),o.view[s](t*r+o.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};ST?jE&&(c=t((function(e,t,n,i){return QE(e,u),gT(iT(t)?xT(t)?void 0!==i?new a(t,eT(n,r),i):void 0!==n?new a(t,eT(n,r)):new a(t):UT(t)?PT(c,t):qE(lT,c,t):new a($E(t)),e,c)})),cT&&cT(c,OT),hT(uT(a),(function(e){e in c||zE(c,e,a[e])})),c.prototype=u):(c=t((function(e,t,n,i){QE(e,u);var o,s,a,l=0,d=0;if(iT(t)){if(!xT(t))return UT(t)?PT(c,t):qE(lT,c,t);o=t,d=eT(n,r);var f=t.byteLength;if(void 0===i){if(f%r)throw ET(LT);if((s=f-d)<0)throw ET(LT)}else if((s=ZE(i)*r)+d>f)throw ET(LT);a=s/r}else a=$E(t),o=new TT(s=a*r);for(yT(e,{buffer:o,byteOffset:d,byteLength:s,length:a,view:new RT(o)});l<a;)h(e,l++)})),cT&&cT(c,OT),u=c.prototype=sT(wT)),u.constructor!==c&&zE(u,"constructor",c),zE(u,MT,c),NT&&zE(u,NT,i),l[i]=c,FE({global:!0,forced:c!=a,sham:!ST},l),bT in c||zE(c,bT,r),bT in u||zE(u,bT,r),dT(i)}):kC.exports=function(){},(0,kC.exports)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var GT=Pe,FT=er,KT=or,qT=Math.min,HT=[].copyWithin||function(e,t){var n=GT(this),r=KT(n),i=FT(e,r),o=FT(t,r),s=arguments.length>2?arguments[2]:void 0,a=qT((void 0===s?r:FT(s,r))-o,r-i),c=1;for(o<i&&i<o+a&&(c=-1,o+=a-1,i+=a-1);a-- >0;)o in n?n[i]=n[o]:delete n[i],i+=c,o+=c;return n},jT=vE,YT=R(HT),WT=jT.aTypedArray;(0,jT.exportTypedArrayMethod)("copyWithin",(function(e,t){return YT(WT(this),e,t,arguments.length>2?arguments[2]:void 0)}));var QT=Mc.every,JT=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("every",(function(e){return QT(JT(this),e,arguments.length>1?arguments[1]:void 0)}));var zT=l,XT=__,ZT=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("fill",(function(e){var t=arguments.length;return zT(XT,ZT(this),e,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}));var $T=or,eI=rl,tI=vE.TYPED_ARRAY_CONSTRUCTOR,nI=vE.aTypedArrayConstructor,rI=function(e){return nI(eI(e,e[tI]))},iI=function(e,t){for(var n=0,r=$T(t),i=new e(r);r>n;)i[n]=t[n++];return i},oI=rI,sI=Mc.filter,aI=function(e,t){return iI(oI(e),t)},cI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("filter",(function(e){var t=sI(cI(this),e,arguments.length>1?arguments[1]:void 0);return aI(this,t)}));var uI=Mc.find,lI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("find",(function(e){return uI(lI(this),e,arguments.length>1?arguments[1]:void 0)}));var hI=Mc.findIndex,dI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("findIndex",(function(e){return hI(dI(this),e,arguments.length>1?arguments[1]:void 0)}));var fI=Mc.forEach,pI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("forEach",(function(e){fI(pI(this),e,arguments.length>1?arguments[1]:void 0)}));var gI=lr.includes,vI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("includes",(function(e){return gI(vI(this),e,arguments.length>1?arguments[1]:void 0)}));var yI=lr.indexOf,mI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("indexOf",(function(e){return yI(mI(this),e,arguments.length>1?arguments[1]:void 0)}));var _I=r,CI=o,EI=R,TI=vE,II=n_,RI=$e("iterator"),SI=_I.Uint8Array,MI=EI(II.values),NI=EI(II.keys),OI=EI(II.entries),wI=TI.aTypedArray,AI=TI.exportTypedArrayMethod,UI=SI&&SI.prototype,bI=!CI((function(){UI[RI].call([1])})),LI=!!UI&&UI.values&&UI[RI]===UI.values&&"values"===UI.values.name,PI=function(){return MI(wI(this))};AI("entries",(function(){return OI(wI(this))}),bI),AI("keys",(function(){return NI(wI(this))}),bI),AI("values",PI,bI||!LI,{name:"values"}),AI(RI,PI,bI||!LI,{name:"values"});var DI=vE.aTypedArray,xI=vE.exportTypedArrayMethod,kI=R([].join);xI("join",(function(e){return kI(DI(this),e)}));var VI=xa,BI=B,GI=zn,FI=or,KI=kc,qI=Math.min,HI=[].lastIndexOf,jI=!!HI&&1/[1].lastIndexOf(1,-0)<0,YI=KI("lastIndexOf"),WI=jI||!YI?function(e){if(jI)return VI(HI,this,arguments)||0;var t=BI(this),n=FI(t),r=n-1;for(arguments.length>1&&(r=qI(r,GI(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}:HI,QI=xa,JI=WI,zI=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("lastIndexOf",(function(e){var t=arguments.length;return QI(JI,zI(this),t>1?[e,arguments[1]]:[e])}));var XI=Mc.map,ZI=rI,$I=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("map",(function(e){return XI($I(this),e,arguments.length>1?arguments[1]:void 0,(function(e,t){return new(ZI(e))(t)}))}));var eR=ye,tR=Pe,nR=P,rR=or,iR=r.TypeError,oR=function(e){return function(t,n,r,i){eR(n);var o=tR(t),s=nR(o),a=rR(o),c=e?a-1:0,u=e?-1:1;if(r<2)for(;;){if(c in s){i=s[c],c+=u;break}if(c+=u,e?c<0:a<=c)throw iR("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=u)c in s&&(i=n(i,s[c],c,o));return i}},sR={left:oR(!1),right:oR(!0)},aR=sR.left,cR=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("reduce",(function(e){var t=arguments.length;return aR(cR(this),e,t,t>1?arguments[1]:void 0)}));var uR=sR.right,lR=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("reduceRight",(function(e){var t=arguments.length;return uR(lR(this),e,t,t>1?arguments[1]:void 0)}));var hR=vE.aTypedArray,dR=vE.exportTypedArrayMethod,fR=Math.floor;dR("reverse",(function(){for(var e,t=this,n=hR(t).length,r=fR(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t}));var pR=r,gR=l,vR=vE,yR=or,mR=UE,_R=Pe,CR=o,ER=pR.RangeError,TR=pR.Int8Array,IR=TR&&TR.prototype,RR=IR&&IR.set,SR=vR.aTypedArray,MR=vR.exportTypedArrayMethod,NR=!CR((function(){var e=new Uint8ClampedArray(2);return gR(RR,e,{length:1,0:3},1),3!==e[1]})),OR=NR&&vR.NATIVE_ARRAY_BUFFER_VIEWS&&CR((function(){var e=new TR(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));MR("set",(function(e){SR(this);var t=mR(arguments.length>1?arguments[1]:void 0,1),n=_R(e);if(NR)return gR(RR,this,n,t);var r=this.length,i=yR(n),o=0;if(i+t>r)throw ER("Wrong length");for(;o<i;)this[t+o]=n[o++]}),!NR||OR);var wR=rI,AR=va,UR=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("slice",(function(e,t){for(var n=AR(UR(this),e,t),r=wR(this),i=0,o=n.length,s=new r(o);o>i;)s[i]=n[i++];return s}),o((function(){new Int8Array(1).slice()})));var bR=Mc.some,LR=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("some",(function(e){return bR(LR(this),e,arguments.length>1?arguments[1]:void 0)}));var PR=Wf,DR=Math.floor,xR=function(e,t){var n=e.length,r=DR(n/2);return n<8?kR(e,t):VR(e,xR(PR(e,0,r),t),xR(PR(e,r),t),t)},kR=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},VR=function(e,t,n,r){for(var i=t.length,o=n.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?r(t[s],n[a])<=0?t[s++]:n[a++]:s<i?t[s++]:n[a++];return e},BR=xR,GR=Q.match(/firefox\/(\d+)/i),FR=!!GR&&+GR[1],KR=/MSIE|Trident/.test(Q),qR=Q.match(/AppleWebKit\/(\d+)\./),HR=!!qR&&+qR[1],jR=R,YR=o,WR=ye,QR=BR,JR=FR,zR=KR,XR=te,ZR=HR,$R=vE.aTypedArray,eS=vE.exportTypedArrayMethod,tS=r.Uint16Array,nS=tS&&jR(tS.prototype.sort),rS=!(!nS||YR((function(){nS(new tS(2),null)}))&&YR((function(){nS(new tS(2),{})}))),iS=!!nS&&!YR((function(){if(XR)return XR<74;if(JR)return JR<67;if(zR)return!0;if(ZR)return ZR<602;var e,t,n=new tS(516),r=Array(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(nS(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));eS("sort",(function(e){return void 0!==e&&WR(e),iS?nS(this,e):QR($R(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!iS||rS);var oS=rr,sS=er,aS=rI,cS=vE.aTypedArray;(0,vE.exportTypedArrayMethod)("subarray",(function(e,t){var n=cS(this),r=n.length,i=sS(e,r);return new(aS(n))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,oS((void 0===t?r:sS(t,r))-i))}));var uS=xa,lS=vE,hS=o,dS=va,fS=r.Int8Array,pS=lS.aTypedArray,gS=lS.exportTypedArrayMethod,vS=[].toLocaleString,yS=!!fS&&hS((function(){vS.call(new fS(1))}));gS("toLocaleString",(function(){return uS(vS,yS?dS(pS(this)):pS(this),dS(arguments))}),hS((function(){return[1,2].toLocaleString()!=new fS([1,2]).toLocaleString()}))||!hS((function(){fS.prototype.toLocaleString.call([1,2])})));var mS=vE.exportTypedArrayMethod,_S=o,CS=R,ES=r.Uint8Array,TS=ES&&ES.prototype||{},IS=[].toString,RS=CS([].join);_S((function(){IS.call({})}))&&(IS=function(){return RS(this)});var SS=TS.toString!=IS;mS("toString",IS,SS);var MS=r,NS=kp,OS=Gp,wS=n_,AS=Qt,US=$e,bS=US("iterator"),LS=US("toStringTag"),PS=wS.values,DS=function(e,t){if(e){if(e[bS]!==PS)try{AS(e,bS,PS)}catch(t){e[bS]=PS}if(e[LS]||AS(e,LS,t),NS[t])for(var n in wS)if(e[n]!==wS[n])try{AS(e,n,wS[n])}catch(t){e[n]=wS[n]}}};for(var xS in NS)DS(MS[xS]&&MS[xS].prototype,xS);DS(OS,"DOMTokenList");var kS=R(1..valueOf),VS=x,BS=ui,GS=R("".replace),FS="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",KS=RegExp("^"+FS+FS+"*"),qS=RegExp(FS+FS+"*$"),HS=function(e){return function(t){var n=BS(VS(t));return 1&e&&(n=GS(n,KS,"")),2&e&&(n=GS(n,qS,"")),n}},jS={start:HS(1),end:HS(2),trim:HS(3)},YS=s,WS=r,QS=R,JS=Gr,zS=Jt.exports,XS=ke,ZS=Yv,$S=W,eM=he,tM=ut,nM=o,rM=Wn.f,iM=i.f,oM=Ot.f,sM=kS,aM=jS.trim,cM="Number",uM=WS.Number,lM=uM.prototype,hM=WS.TypeError,dM=QS("".slice),fM=QS("".charCodeAt),pM=function(e){var t=tM(e,"number");return"bigint"==typeof t?t:gM(t)},gM=function(e){var t,n,r,i,o,s,a,c,u=tM(e,"number");if(eM(u))throw hM("Cannot convert a Symbol value to a number");if("string"==typeof u&&u.length>2)if(u=aM(u),43===(t=fM(u,0))||45===t){if(88===(n=fM(u,2))||120===n)return NaN}else if(48===t){switch(fM(u,1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(s=(o=dM(u,2)).length,a=0;a<s;a++)if((c=fM(o,a))<48||c>i)return NaN;return parseInt(o,r)}return+u};if(JS(cM,!uM(" 0o1")||!uM("0b1")||uM("+0x1"))){for(var vM,yM=function(e){var t=arguments.length<1?0:uM(pM(e)),n=this;return $S(lM,n)&&nM((function(){sM(n)}))?ZS(Object(t),n,yM):t},mM=YS?rM(uM):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),_M=0;mM.length>_M;_M++)XS(uM,vM=mM[_M])&&!XS(yM,vM)&&oM(yM,vM,iM(uM,vM));yM.prototype=lM,lM.constructor=yM,zS(WS,cM,yM)}var CM=s,EM=R,TM=l,IM=o,RM=Ci,SM=Cr,MM=h,NM=Pe,OM=P,wM=Object.assign,AM=Object.defineProperty,UM=EM([].concat),bM=!wM||IM((function(){if(CM&&1!==wM({b:1},wM(AM({},"a",{enumerable:!0,get:function(){AM(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=wM({},e)[n]||RM(wM({},t)).join("")!=r}))?function(e,t){for(var n=NM(e),r=arguments.length,i=1,o=SM.f,s=MM.f;r>i;)for(var a,c=OM(arguments[i++]),u=o?UM(RM(c),o(c)):RM(c),l=u.length,h=0;l>h;)a=u[h++],CM&&!TM(s,c,a)||(n[a]=c[a]);return n}:wM,LM=bM;Qr({target:"Object",stat:!0,forced:Object.assign!==LM},{assign:LM});var PM,DM,xM,kM,VM,BM=Ff,GM=r.TypeError,FM=$e("match"),KM=Qr,qM=function(e){if(BM(e))throw GM("The method doesn't accept regular expressions");return e},HM=x,jM=ui,YM=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[FM]=!1,"/./"[e](t)}catch(e){}}return!1},WM=R("".indexOf);KM({target:"String",proto:!0,forced:!YM("includes")},{includes:function(e){return!!~WM(jM(HM(this)),jM(qM(e)),arguments.length>1?arguments[1]:void 0)}}),function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(PM||(PM={})),function(e){e[e.SYMMETRIC=0]="SYMMETRIC",e[e.CONNECT=1]="CONNECT",e[e.CONN_ACK=2]="CONN_ACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUB_ACK=4]="PUB_ACK",e[e.QUERY=5]="QUERY",e[e.QUERY_ACK=6]="QUERY_ACK",e[e.QUERY_CONFIRM=7]="QUERY_CONFIRM",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUB_ACK=9]="SUB_ACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUB_ACK=11]="UNSUB_ACK",e[e.PING_REQ=12]="PING_REQ",e[e.PING_RESP=13]="PING_RESP",e[e.DISCONNECT=14]="DISCONNECT",e[e.RESERVER2=15]="RESERVER2"}(DM||(DM={})),function(e){e.CONN_ACK="ConnAckMessage",e.DISCONNECT="DisconnectMessage",e.PING_REQ="PingReqMessage",e.PING_RESP="PingRespMessage",e.PUBLISH="PublishMessage",e.PUB_ACK="PubAckMessage",e.QUERY="QueryMessage",e.QUERY_CON="QueryConMessage",e.QUERY_ACK="QueryAckMessage"}(xM||(xM={})),function(e){e.PUB="pub",e.QUERY="qry"}(kM||(kM={})),function(e){e[e.V4=4]="V4",e[e.V3=3]="V3"}(VM||(VM={}));var QM,JM=function(){function e(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=PM.AT_LEAST_ONCE),void 0===r&&(r=!1),this._retain=!1,this.qos=PM.AT_LEAST_ONCE,this._dup=!1,this.syncMsg=!1;var i=e>0;e&&i&&1===arguments.length?(this._retain=(1&e)>0,this.qos=(6&e)>>1,this._dup=(8&e)>0,this.type=e>>4&15,this.syncMsg=8==(8&e)):(this.type=e,this._retain=t,this.qos=n,this._dup=r)}return e.prototype.encode=function(){var e=this.type<<4;return e|=this._retain?1:0,e|=this.qos<<1,e|=this._dup?8:0},e}(),zM=function(){function e(){}return e.writeUTF=function(e,t){var n=[],r=0;if(ug(e))for(var i=0,o=e.length;i<o;i++){var s=e.charCodeAt(i);s>=0&&s<=127?(r+=1,n.push(s)):s>=128&&s<=2047?(r+=2,n.push(192|31&s>>6),n.push(128|63&s)):s>=2048&&s<=65535&&(r+=3,n.push(224|15&s>>12),n.push(128|63&s>>6),n.push(128|63&s))}for(i=0,o=n.length;i<o;i++)n[i]>255&&(n[i]&=255);return t?n:r<=255?[0,r].concat(n):[r>>8,255&r].concat(n)},e.readUTF=function(e){for(var t,n,r=[],i=-1,o=e,s="";++i<o.length;){var a=Number(o[i]);if(a===(127&a)||(240==(240&a)?a=(a=(a=(a^=240)<<6|128^o[++i])<<6|128^o[++i])<<6|128^o[++i]:224==(224&a)?a=(a=(a^=224)<<6|128^o[++i])<<6|128^o[++i]:192==(192&a)&&(a=(a^=192)<<6|128^o[++i])),!isFinite(a)||a<0||a>1114111||Math.floor(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?r.push(a):(t=(a-=65536)>>10|55296,n=a%1024|56320,r.push(t,n)),(i+1===o.length||r.length>16384)&&(s+=String.fromCharCode.apply(null,r),r.length=0)}return s},e}(),XM=function(){function e(e){this._position=0,this._poolLen=0,this._pool=e,this._poolLen=e.length}return e.prototype.check=function(){return this._position>=this._pool.length},e.prototype.read2Byte=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<2;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r.toString()}return parseInt(t,16)},e.prototype.readInt=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<4;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r.toString()}return parseInt(t,16)},e.prototype.readLong=function(){var e=this;if(e.check())return-1;for(var t="",n=0;n<8;n++){var r=e._pool[e._position++].toString(16);1===r.length&&(r="0"+r),t+=r}return parseInt(t,16)},e.prototype.readByte=function(){if(this.check())return-1;var e=this._pool[this._position++];return e>255&&(e&=255),e},e.prototype.readUTF=function(){if(this.check())return"";var e=this.readByte()<<8|this.readByte(),t=this._pool.subarray(this._position,this._position+=e);return zM.readUTF(t)},e.prototype.readAll=function(){return this._pool.subarray(this._position,this._poolLen)},e}(),ZM=function(){function e(){this._pool=[],this._position=0,this._writen=0}return e.prototype.write=function(e){return-1!==Object.prototype.toString.call(e).indexOf("Array")?this._pool=this._pool.concat(e):e>=0&&(e>255&&(e&=255),this._pool.push(e),this._writen++),e},e.prototype.writeArr=function(e){return this._pool=this._pool.concat(e),e},e.prototype.writeUTF=function(e){var t=zM.writeUTF(e);this._pool=this._pool.concat(t),this._writen+=t.length},e.prototype.getBytesArray=function(){return this._pool},e}(),$M="UpStreamMessage",eN="PushExtra",tN="DownStreamMessage",nN="DownStreamMessages",rN="SessionsAttQryInput",iN="SessionsAttOutput",oN="SyncRequestMsg",sN="ChrmPullMsg",aN="NotifyMsg",cN="HistoryMsgInput",uN="HistoryMsgOuput",lN="RelationQryInput",hN="RelationsOutput",dN="DeleteSessionsInput",fN="SessionInfo",pN="DeleteSessionsOutput",gN="RelationsInput",vN="DeleteMsgInput",yN="CleanHisMsgInput",mN="SessionMsgReadInput",_N="ChrmInput",CN="ChrmOutput",EN="QueryChatRoomInfoInput",TN="QueryChatRoomInfoOutput",IN="RtcInput",RN="RtcUserListOutput",SN="SetUserStatusInput",MN="RtcSetDataInput",NN="RtcUserSetDataInput",ON="RtcDataInput",wN="RtcSetOutDataInput",AN="MCFollowInput",UN="RtcTokenOutput",bN="RtcQryOutput",LN="RtcQryUserOutDataInput",PN="RtcUserOutDataOutput",DN="RtcQueryListInput",xN="RtcRoomInfoOutput",kN="RtcValueInfo",VN="RtcKeyDeleteInput",BN="GetQNupTokenInput",GN="GetQNupTokenOutput",FN="GetQNdownloadUrlInput",KN="GetDownloadUrlInput",qN="GetQNdownloadUrlOutput",HN="GetDownloadUrlOutput",jN="ChrmKVEntity",YN="SetChrmKV",WN="SetChrmKVS",QN="DeleteChrmKVS",JN="ChrmKVOutput",zN="ChrmKVSOutput",XN="ChrmKVSVersionEntity",ZN="ChrmKVSOutputEntity",$N="QueryChrmKV",eO="SetUserSettingInput",tO="SetUserSettingOutput",nO="PullUserSettingInput",rO="PullUserSettingOutput",iO="UserSettingNotification",oO="SessionReq",sO="SessionStates",aO="SessionState",cO="SessionStateItem",uO="SessionStateModifyReq",lO="SessionStateModifyResp",hO="GroupUnpushQuery",dO="GroupUnpushSet",fO="GroupUnpushResult",pO="GrpReadReceiptMsg",gO="GrpReadReceiptQryReq",vO="GrpReadReceiptQryResp",yO="GrpMsgReadUser",mO="SessionTagAddInput",_O="SessionTagItem",CO="SessionTagDelInput",EO="SessionDisTagReq",TO="ReportSDKInput",IO="ReportSDKOutput",RO="UltraGrpPullSes",SO="UltraGrpPullMsg",MO="MsgChangeReq",NO="QueryMsgChange",OO="MsgChange",wO="MsgChangeList",AO="MsgQuery",UO="MessageQueryInfo",bO="MsgQueryAck",LO="OperateStatus",PO="OperateStatusNotify",DO="OperateInfo",xO="OperateSummary",kO="RtcNotifyMsg",VO="RtcPullKV",BO="RtcKVOutput",GO="RtcQueryUserJoinedInput",FO="RtcQueryUserJoinedOutput",KO="RtcViewerJoinedOutput",qO="RtcInviteInput",HO="RtcCancelInviteInput",jO="RtcInviteAnswerInput",YO="RtcEndInviteInput",WO="SetRtcRoomIdInput",QO="SetRtcRoomIdOutput",JO=((QM={})[$M]=["sessionId","classname","content","pushText","userId","configFlag","appData","extraContent","pushExt","busChannel"],QM[nN]=["list","syncTime","finished","broadcastSyncTime"],QM[tN]=["fromUserId","type","groupId","classname","content","dataTime","status","msgId","extraContent","pushContent","configFlag","pushExt","busChannel","extStatus","toUserId","groupUnpush"],QM[eN]=["title","templateIdNoUse","pushId","pushConfigs","templateId"],QM[rN]=["nothing"],QM[iN]=["inboxTime","sendboxTime","totalUnreadCount"],QM[oN]=["syncTime","ispolling","isweb","isPullSend","isKeeping","sendBoxSyncTime","broadcastSyncTime"],QM[sN]=["syncTime","count"],QM[aN]=["type","time","chrmId"],QM[cN]=["targetId","time","count","order","busChannel"],QM[uN]=["list","syncTime","hasMsg"],QM[lN]=["type","count","startTime","order"],QM[hN]=["info","isFinished"],QM[dN]=["sessions"],QM[fN]=["type","channelId","busChannel"],QM[pN]=["nothing"],QM[gN]=["type","msg","count","busChannel","startTime","endTime"],QM[vN]=["type","conversationId","msgs","busChannel"],QM[yN]=["targetId","dataTime","conversationType","busChannel"],QM[mN]=["type","msgTime","channelId","busChannel"],QM[_N]=["nothing"],QM[CN]=["nothing","sessionId","joinTime"],QM[EN]=["count","order"],QM[TN]=["userTotalNums","userInfos"],QM[BN]=["type","key","httpMethod","queryString"],QM[FN]=["type","key","fileName"],QM[KN]=["type","key","fileName"],QM[GN]=["deadline","token","bosToken","bosDate","path","osskeyId","ossPolicy","ossSign","ossBucketName"],QM[qN]=["downloadUrl"],QM[HN]=["downloadUrl"],QM[jN]=["key","value","status","timestamp","uid","version"],QM[YN]=["entry","bNotify","notification","type"],QM[WN]=["entry","bNotify","notification","type"],QM[QN]=["entry","bNotify","notification","type"],QM[JN]=["entries","bFullUpdate","syncTime"],QM[zN]=["timestamp","errorKeys","keysVersion"],QM[XN]=["version","key"],QM[ZN]=["key","errorCode"],QM[$N]=["timestamp"],QM[eO]=["version","value"],QM[tO]=["version","reserve"],QM[nO]=["version","reserve"],QM[rO]=["items","version"],QM.UserSettingItem=["targetId","type","key","value","version","status","tags"],QM[oO]=["time"],QM[sO]=["version","state"],QM[aO]=["type","channelId","time","stateItem","busChannel"],QM[cO]=["sessionStateType","value","tags"],QM[uO]=["version","state"],QM[lO]=["version"],QM[dO]=["busChannel","unpushLevel"],QM[hO]=["busChannel"],QM[fO]=["groupId","busChannel","unpushLevel"],QM[pO]=["msgId","busChannel"],QM[gO]=["msgId","busChannel"],QM[vO]=["totalMemberNum","list"],QM[yO]=["readTime","userId"],QM[mO]=["version","tags"],QM[_O]=["tagId","name","createdTime","isTop"],QM[CO]=["version","tags"],QM[EO]=["tagId"],QM[iO]=["version","reserve"],QM[TO]=["sdkInfo"],QM[IO]=["nothing"],QM[RO]=["syncTime","isEraseMsgContent"],QM[SO]=["syncTime"],QM[MO]=["fromUserId","targetId","type","busChannel","msgUID","msgTime","content"],QM[NO]=["syncTime"],QM[wO]=["list","syncTime","hasNext"],QM[OO]=["targetId","type","time","changeType","msgUID","msgTime","busChannel","isAdmin","isDel","operatorId"],QM[AO]=["targetId","type","query"],QM[UO]=["msgTime","msgUID","busChannel"],QM[bO]=["list"],QM[LO]=["targetId","type","opType","busChannel"],QM[PO]=["type","notifyType","info","summary"],QM[DO]=["targetId","busChannel","userId","opType","optime"],QM[xO]=["targetId","busChannel","count","opType"],QM[IN]=["roomType","broadcastType","extraInnerData","needSysChatroom","identityChangeType","joinType"],QM[RN]=["users","token","sessionId","roomInfo"],QM[SN]=["status"],QM[MN]=["interior","target","key","value","objectName","content"],QM[NN]=["valueInfo","objectName","content"],QM[ON]=["interior","target","key","objectName","content"],QM[wN]=["target","valueInfo","objectName","content"],QM[AN]=["state"],QM[UN]=["rtcToken"],QM[bN]=["outInfo"],QM[LN]=["userId"],QM[PN]=["user"],QM[DN]=["order"],QM[xN]=["roomId","roomData","userCount","list"],QM[kN]=["key","value"],QM[VN]=["key"],QM[kO]=["type","time","roomId"],QM[VO]=["timestamp","roomId"],QM[BO]=["entries","bFullUpdate","syncTime"],QM[GO]=["userId"],QM[FO]=["info"],QM[qO]=["invitedUserId","timeoutTime","invitedRoomId","inviteInfo","inviteSessionId"],QM[HO]=["invitedUserId","invitedRoomId","inviteInfo","inviteSessionId"],QM[jO]=["inviteUserID","answerCode","inviteRoomId","inviteSessionId","content","key","value"],QM[YO]=["inviteRoomId","inviteSessionId","inviteContent","inviteRoomKeys"],QM[WO]=["rtcRoomId"],QM[QO]=["nothing"],QM),zO={},XO=function(e){var t=JO[e];zO[e]=function(){for(var e={},n={getArrayData:function(){return e}},r=function(r){var i=t[r],o="set".concat(jc(i,0,1));n[o]=function(t){e[i]=t}},i=0;i<t.length;i++)r(i);return n},zO[e].decode=function(e){var t={};ug(e)&&(e=JSON.parse(e));var n=function(n){var r="get".concat(jc(n,0,1));t[n]=e[n],t[r]=function(){return e[n]}};for(var r in e)n(r);return t}};for(var ZO in JO)XO(ZO);zO.getModule=function(e){return zO[e]()},(0,kC.exports)("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var $O="\npackage Modules;\nmessage probuf {\n  message ".concat(SN,"\n  {\n    optional int32 status=1;\n  }\n\n  message SetUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusInput\n  {\n    optional int32 nothing=1;\n  }\n\n  message GetUserStatusOutput\n  {\n    optional string status=1;\n    optional string subUserId=2;\n  }\n\n  message SubUserStatusInput\n  {\n    repeated string userid =1;\n  }\n\n  message SubUserStatusOutput\n  {\n    optional int32 nothing=1;\n  }\n  message VoipDynamicInput\n  {\n    required int32  engineType = 1;\n    required string channelName = 2;\n    optional string channelExtra = 3;\n  }\n\n  message VoipDynamicOutput\n  {\n      required string dynamicKey=1;\n  }\n  message ").concat(aN," {\n    required int32 type = 1;\n    optional int64 time = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(oN," {\n    required int64 syncTime = 1;\n    required bool ispolling = 2;\n    optional bool isweb=3;\n    optional bool isPullSend=4;\n    optional bool isKeeping=5;\n    optional int64 sendBoxSyncTime=6;\n    optional int64 broadcastSyncTime=7;\n  }\n  message ").concat($M," {\n    required int32 sessionId = 1;\n    required string classname = 2;\n    required bytes content = 3;\n    optional string pushText = 4;\n    optional string appData = 5;\n    repeated string userId = 6;\n    optional int64 delMsgTime = 7;\n    optional string delMsgId = 8;\n    optional int32 configFlag = 9;\n    optional int64 clientUniqueId = 10;\n    optional string extraContent = 11;\n    optional PushExtra pushExt = 12;\n    optional string busChannel = 13; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(eN," {\n    optional string title = 1;\n    optional int32  templateIdNoUse= 2;\n    optional string pushId = 3;\n    optional string pushConfigs = 4;\n    optional string templateId = 5;\n  }\n  message ").concat(nN," {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    optional bool finished = 3;\n    optional int64 broadcastSyncTime = 4;\n  }\n  message ").concat(tN," {\n    required string fromUserId = 1;\n    required ChannelType type = 2;\n    optional string groupId = 3;\n    required string classname = 4;\n    required bytes content = 5;\n    required int64 dataTime = 6;\n    required int64 status = 7;\n    optional int64 extra = 8;\n    optional string msgId = 9;\n    optional int32 direction = 10;\n    optional int32 plantform =11;\n    optional int32 isRemoved = 12;\n    optional string source = 13;\n    optional int64 clientUniqueId = 14;\n    optional string extraContent = 15;\n    optional string pushContent = 16;\n    optional int32 configFlag = 17;\n    optional PushExtra pushExt = 18;\n    optional string busChannel = 19; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯ï¼éå¶20å­ç¬¦ä»¥å\n    optional int64 extStatus = 20; // æ¶æ¯çæ©å±æ è®° ç¬¬0ä½,è¡¨ç¤ºéè¾¾ç¶æ: 0x01 è¡¨ç¤ºå·²éè¾¾;æ­æ¡£: 0x02 è¡¨ç¤ºæ¯å¦éè¦æ§è¡æ­æ¡£ç­ç¥; æ¶æ¯ä¿®æ¹: 0x04 æååå²æ¶æ¯æ¶è¡¨ç¤ºè¯¥æ¶æ¯æ¯å¦ä¿®æ¹è¿\n    repeated string toUserId = 21;  //æå®æ¥æ¶èï¼éå®ç¾¤åè®¨è®ºç»ï¼//å¢å èå¤©å®¤å®åæå\n    optional int32 groupUnpush = 22; //ç¾¤èé»è®¤åææ°çº§å«\n  }\n  enum ChannelType {\n    PERSON = 1;\n    PERSONS = 2;\n    GROUP = 3;\n    TEMPGROUP = 4;\n    CUSTOMERSERVICE = 5;\n    NOTIFY = 6;\n    MC=7;\n    MP=8;\n    ULTRAGROUP = 10;\n  }\n  message CreateDiscussionInput {\n    optional string name = 1;\n  }\n  message CreateDiscussionOutput {\n    required string id = 1;\n  }\n  message ChannelInvitationInput {\n    repeated string users = 1;\n  }\n  message LeaveChannelInput {\n    required int32 nothing = 1;\n  }\n  message ChannelEvictionInput {\n    required string user = 1;\n  }\n  message RenameChannelInput {\n    required string name = 1;\n  }\n  message ChannelInfoInput {\n    required int32 nothing = 1;\n  }\n  message ChannelInfoOutput {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    required string channelName = 3;\n    required string adminUserId = 4;\n    repeated string firstTenUserIds = 5;\n    required int32 openStatus = 6;\n  }\n  message ChannelInfosInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message ChannelInfosOutput {\n    repeated ChannelInfoOutput channels = 1;\n    required int32 total = 2;\n  }\n  message MemberInfo {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n    required string extension = 4;\n  }\n  message GroupMembersInput {\n    required int32 page = 1;\n    optional int32 number = 2;\n  }\n  message GroupMembersOutput {\n    repeated MemberInfo members = 1;\n    required int32 total = 2;\n  }\n  message GetUserInfoInput {\n    required int32 nothing = 1;\n  }\n  message GetUserInfoOutput {\n    required string userId = 1;\n    required string userName = 2;\n    required string userPortrait = 3;\n  }\n  message GetSessionIdInput {\n    required int32 nothing = 1;\n  }\n  message GetSessionIdOutput {\n    required int32 sessionId = 1;\n  }\n  enum FileType {\n    image = ").concat(cg.IMAGE,";\n    audio = ").concat(cg.AUDIO,";\n    video = ").concat(cg.VIDEO,";\n    file = ").concat(cg.FILE,";\n  }\n  message ").concat(BN," {\n    required FileType type = 1;\n    optional string key = 2;\n    optional string httpMethod = 3;\n    optional string queryString = 4;\n  }\n  message ").concat(FN," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string  fileName = 3;\n  }\n  message ").concat(KN," {\n    required FileType type = 1;\n    required string key = 2;\n    optional string fileName = 3;\n   }\n  message ").concat(GN," {\n    required int64 deadline = 1;\n    required string token = 2;\n    optional string bosToken = 3;\n    optional string bosDate = 4;\n    optional string path = 5;\n    optional string osskeyId = 6;\n    optional string ossPolicy = 7;\n    optional string ossSign = 8;\n    optional string ossBucketName = 9;\n    optional string s3Credential = 10;\n    optional string s3Algorithm = 11;\n    optional string s3Date = 12;\n    optional string s3Policy = 13;\n    optional string s3Signature = 14;\n    optional string s3BucketName = 15;\n    optional string stcAuthorization = 16;\n    optional string stcContentSha256 = 17;\n    optional string stcDate = 18;\n    optional string stcBucketName = 19;\n  }\n  message ").concat(qN," {\n    required string downloadUrl = 1;\n  }\n  message ").concat(HN," {\n    required string downloadUrl = 1;\n  }\n  message Add2BlackListInput {\n    required string userId = 1;\n  }\n  message RemoveFromBlackListInput {\n    required string userId = 1;\n  }\n  message QueryBlackListInput {\n    required int32 nothing = 1;\n  }\n  message QueryBlackListOutput {\n    repeated string userIds = 1;\n  }\n  message BlackListStatusInput {\n    required string userId = 1;\n  }\n  message BlockPushInput {\n    required string blockeeId = 1;\n  }\n  message ModifyPermissionInput {\n    required int32 openStatus = 1;\n  }\n  message GroupInput {\n    repeated GroupInfo groupInfo = 1;\n  }\n  message GroupOutput {\n    required int32 nothing = 1;\n  }\n  message GroupInfo {\n    required string id = 1;\n    required string name = 2;\n  }\n  message GroupHashInput {\n    required string userId = 1;\n    required string groupHashCode = 2;\n  }\n  message GroupHashOutput {\n    required GroupHashType result = 1;\n  }\n  enum GroupHashType {\n    group_success = 0x00;\n    group_failure = 0x01;\n  }\n  message ").concat(_N," {\n    required int32 nothing = 1;\n  }\n  message ").concat(CN," {\n    required int32 nothing = 1;\n    optional string sessionId = 2;\n    optional int64 joinTime = 3;\n  }\n  message ").concat(sN," {\n    required int64 syncTime = 1;\n    required int32 count = 2;\n  }\n\n  message ChrmPullMsgNew\n  {\n    required int32 count = 1;\n    required int64 syncTime = 2;\n    optional string chrmId=3;\n  }\n  message ").concat(lN,"\n  {\n    optional ChannelType type = 1;\n    optional int32 count = 2;\n    optional int64 startTime = 3;\n    optional int32 order = 4;\n  }\n  message ").concat(gN,"\n  {\n    required ChannelType type = 1;\n    optional DownStreamMessage msg =2;\n    optional int32 count = 3;\n    repeated string busChannel = 4;\n    optional int64 startTime = 5;\n    optional int64 endTime = 6;\n  }\n  message ").concat(hN,"\n  {\n    repeated RelationInfo info = 1;\n    optional bool isFinished = 2;//æ¯å¦ç»æ\n  }\n  message RelationInfo\n  {\n    required ChannelType type = 1;\n    required string userId = 2;\n    optional DownStreamMessage msg =3;\n    optional int64 readMsgTime= 4;\n    optional int64 unreadCount= 5;\n    optional string busChannel = 6;//è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n    optional int64 versionTime = 7;//ä¼è¯é¡¹åæ´æ¶é´æ³ï¼æ³¨æ:éæåºæ¶é´æ³\n    optional int64 remindCount = 8;//è¢«@çæªè¯»æ°\n  }\n  message RelationInfoReadTime\n  {\n    required ChannelType type = 1;\n    required int64 readMsgTime= 2;\n    required string targetId = 3;\n  }\n  message ").concat(yN,"\n  {\n      required string targetId = 1;\n      required int64 dataTime = 2;\n      optional int32 conversationType= 3;\n      optional string busChannel = 4; //è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯ï¼éå¶20å­ç¬¦ä»¥å\n  }\n  message HistoryMessageInput\n  {\n    required string targetId = 1;\n    required int64 dataTime =2;\n    required int32 size  = 3;\n  }\n\n  message HistoryMessagesOuput\n  {\n    repeated DownStreamMessage list = 1;\n    required int64 syncTime = 2;\n    required int32 hasMsg = 3;\n  }\n  message ").concat(EN,"\n  {\n    required int32 count= 1;\n    optional int32 order= 2;\n  }\n\n  message ").concat(TN,"\n  {\n    optional int32 userTotalNums = 1;\n    repeated ChrmMember userInfos = 2;\n  }\n  message ChrmMember\n  {\n    required int64 time = 1;\n    required string id = 2;\n  }\n  message MPFollowInput\n  {\n    required string id = 1;\n  }\n\n  message MPFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message ").concat(AN,"\n  {\n    required string state = 1;\n  }\n\n  message MCFollowOutput\n  {\n    required int32 nothing = 1;\n    optional MpInfo info =2;\n  }\n\n  message MpInfo\n  {\n    required string mpid=1;\n    required string name = 2;\n    required string type = 3;\n    required int64 time=4;\n    optional string portraitUrl=5;\n    optional string extra =6;\n  }\n\n  message SearchMpInput\n  {\n    required int32 type=1;\n    required string id=2;\n  }\n\n  message SearchMpOutput\n  {\n    required int32 nothing=1;\n    repeated MpInfo info = 2;\n  }\n\n  message PullMpInput\n  {\n    required int64 time=1;\n    required string mpid=2;\n  }\n\n  message PullMpOutput\n  {\n    required int32 status=1;\n    repeated MpInfo info = 2;\n  }\n  message ").concat(cN,"\n  {\n    optional string targetId = 1;\n    optional int64 time = 2;\n    optional int32 count  = 3;\n    optional int32 order = 4;\n    optional string busChannel = 5; //è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯ï¼éå¶20å­ç¬¦ä»¥å\n  }\n\n  message ").concat(uN,"\n  {\n    repeated DownStreamMessage list=1;\n    required int64 syncTime=2;\n    required int32 hasMsg=3;\n  }\n  message ").concat(DN,"{\n    optional int32 order=1;\n  }\n\n  message ").concat(VN,"{\n    repeated string key=1;\n  }\n\n  message ").concat(kN,"{\n    required string key=1;\n    required string value=2;\n  }\n\n  message RtcUserInfo{\n    required string userId=1;\n    repeated ").concat(kN," userData=2; //ç¨æ·èµæºä¿¡æ¯\n  }\n\n  message ").concat(RN,"{\n    repeated RtcUserInfo users=1;\n    optional string token=2;\n    optional string sessionId=3;\n    repeated RtcValueInfo roomInfo = 4; //æ¿é´key value\n    repeated RtcKVEntity entries = 5;//ç´æ­KVå±æ§å¯¹è±¡éå\n    optional int64 syncTime = 6;//ææå±æ§çæå¤§æ¶é´æ³ï¼ä¸æ¬¡æåKVæ¶ç¨ï¼ã\n    optional int32 offlineKickTime = 7;//serverè¶æ¶è¸¢äººæ¶é´ï¼é»è®¤60s\n  }\n  message RtcRoomInfoOutput{\n    optional string roomId = 1;\n    repeated ").concat(kN," roomData = 2;\n    optional int32 userCount = 3;\n    repeated RtcUserInfo list=4;\n  }\n  message ").concat(IN,"{\n    required int32 roomType=1;\n    optional int32 broadcastType=2;\n    optional RtcValueInfo extraInnerData = 3;\n    optional bool needSysChatroom = 4; //æ¯å¦éè¦åæ­¥èå¤©å®¤\n    optional IdentityChangeType identityChangeType = 5; //èº«ä»½åæ´ç±»å\n    optional JoinType joinType = 6; // å å¥æ¿é´ç±»å\n    repeated ").concat(kN," innerDatas = 7; //ç¨æ·åé¨inneræ°æ®ï¼è§è²æèè¿éº¦ä¿¡æ¯ç­\n    repeated ").concat(kN," outerDatas = 8; //ç¨æ·åé¨outeræ°æ®ï¼èªå®ä¹æ°æ®ç»æRtcInputã\n  }\n  enum JoinType {\n    KICK = 0; //è¸¢åä¸ä¸ªè®¾å¤\n    REFUSE = 1; //å½åå å¥æç»\n    COEXIST = 2; //ä¸¤ä¸ªè®¾å¤å±å­\n  }\n  message RtcQryInput{\n    required bool isInterior=1;\n    required targetType target=2;\n    repeated string key=3;\n  }\n  message ").concat(bN,"{\n    repeated ").concat(kN," outInfo=1;\n  }\n  message RtcDelDataInput{\n    repeated string key=1;\n    required bool isInterior=2;\n    required targetType target=3;\n  }\n  message ").concat(ON,"{\n    required bool interior=1;\n    required targetType target=2;\n    repeated string key=3;\n    optional string objectName=4;\n    optional string content=5;\n  }\n  message ").concat(MN,"{\n    required bool interior=1;\n    required targetType target=2;\n    required string key=3;\n    required string value=4;\n    optional string objectName=5;\n    optional string content=6;\n  }\n  message ").concat(NN," {\n    repeated ").concat(kN," valueInfo = 1;\n    required string objectName = 2;\n    repeated ").concat(kN," content = 3;\n  }\n  message RtcOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(UN,"{\n    required string rtcToken=1;\n  }\n  enum targetType {\n    ROOM =1 ;\n    PERSON = 2;\n  }\n  message ").concat(wN,"{\n    required targetType target=1;\n    repeated ").concat(kN," valueInfo=2;\n    optional string objectName=3;\n    optional string content=4;\n  }\n  message ").concat(LN,"{\n    repeated string userId = 1;\n  }\n  message ").concat(PN,"{\n    repeated RtcUserInfo user = 1;\n  }\n  message ").concat(rN,"{\n    required int32 nothing = 1;\n  }\n  message ").concat(iN,"{\n    required int64 inboxTime = 1;\n    required int64 sendboxTime = 2;\n    required int64 totalUnreadCount = 3;\n  }\n  message ").concat(mN,"\n  {\n    required ChannelType type = 1;\n    required int64 msgTime = 2;\n    required string channelId = 3;\n    optional string busChannel = 4;//è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message SessionMsgReadOutput\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(dN,"\n  {\n    repeated SessionInfo sessions = 1;\n  }\n  message ").concat(fN,"\n  {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional string busChannel = 3;//æå±ä¼è¯ä¸å¡æ è¯\n  }\n  message ").concat(pN,"\n  {\n    optional int32 nothing=1;\n  }\n  message ").concat(vN,"\n  {\n    optional ChannelType type = 1;\n    optional string conversationId = 2;\n    repeated DeleteMsg msgs = 3;\n    optional string busChannel = 4; //è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯ï¼éå¶20å­ç¬¦ä»¥å\n  }\n  message DeleteMsg\n  {\n    optional string msgId = 1;\n    optional int64 msgDataTime = 2;\n    optional int32 direct = 3;\n  }\n  message ChrmKVEntity {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n    optional int64 version = 6;\n  }\n  message ").concat(YN," {\n    required ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(WN," {\n    repeated ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(QN," {\n    repeated ChrmKVEntity entry = 1;\n    optional bool bNotify = 2;\n    optional UpStreamMessage notification = 3;\n    optional ChannelType type = 4;\n  }\n  message ").concat(JN," {\n    repeated ChrmKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3;\n  }\n  message ChrmKVSVersionEntity {\n    optional int64 version = 1;\n    optional string key = 2;\n  }\n\n  message ").concat(zN," {\n    repeated ChrmKVSOutputEntity errorKeys = 1;\n    repeated ChrmKVSVersionEntity keysVersion = 2;\n  }\n  message ").concat(ZN,"\n  {\n    optional string key = 1;\n    optional int32 errorCode = 2;\n  }\n  message ").concat($N," {\n    required int64 timestamp = 1;\n  }\n  message ").concat(eO," {\n    required int64 version=1;\n    required string value=2;\n  }\n  message ").concat(tO," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(nO," {\n    required int64 version=1;\n    optional bool reserve=2;\n  }\n  message ").concat(rO," {\n    repeated UserSettingItem items = 1;\n    required int64 version=2;\n  }\n  message UserSettingItem {\n    required string targetId= 1;\n    required ChannelType type = 2;\n    required string key = 4;\n    required bytes value = 5;\n    required int64 version=6;\n    required int32 status=7;\n    repeated SessionTagItem tags= 8;\n  }\n  message ").concat(oO," {\n    required int64 time = 1;\n  }\n  message ").concat(sO," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(aO," {\n    required ChannelType type = 1;\n    required string channelId = 2;\n    optional int64 time = 3;\n    repeated SessionStateItem stateItem = 4;\n    optional string busChannel = 5;//è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(cO," {\n    required SessionStateType sessionStateType = 1;\n    required string value = 2;\n    repeated SessionTagItem tags = 3;\n  }\n  enum SessionStateType {\n    IsSilent = 1;\n    IsTop = 2;\n    Tags = 3;\n  }\n  message ").concat(uO," {\n    required int64 version=1;\n    repeated SessionState state= 2;\n  }\n  message ").concat(hO," {\n    optional string busChannel = 1;\n  }\n  message ").concat(dO,"{\n    optional string busChannel = 1;\n    required int32 unpushLevel = 2;\n  }\n  message ").concat(fO," {\n    required string groupId = 1;\n    optional string busChannel = 2;\n    required int32 unpushLevel = 3;\n  }\n  message ").concat(lO," {\n    required int64 version=1;\n  }\n  message ").concat(pO," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string channelId = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(gO," {\n    repeated string msgId=1; //å·²è¯»æ¶æ¯ID\n    optional string channelId = 2; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯\n  }\n  message ").concat(vO," {\n    required int32 totalMemberNum = 1;//ç¾¤åæ»äººæ°\n    repeated GrpMsgReadUser list = 2;//å·²è¯»ç¨æ·åè¡¨ï¼listå¤ç±»åï¼\n  }\n  message ").concat(yO," {\n    required int64 readTime = 1;//å·²è¯»æ¶é´\n    required string userId = 2;//å·²è¯»ç¨æ·id\n  }\n  message ").concat(mO," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(_O," {\n    required string tagId=1;\n    optional string name=2;\n    optional int64 createdTime=3;\n    optional bool isTop=4;\n  }\n  message ").concat(CO," {\n    required int64 version=1;\n    repeated SessionTagItem tags=2;\n  }\n  message ").concat(EO," {\n    repeated string tagId=1;\n  }\n  message ").concat(iO," {\n    required int64 version=1;\n    required bool reserve=2;\n  }\n  message ").concat(TO,' {\n    required string sdkInfo=1; // ç¨æ·éæç sdk ä¿¡æ¯,json æ ¼å¼ {"web-rtc": "4.0.3.7"}\n  }\n  message ').concat(IO,"\n  {\n    optional int32 nothing=1; //å ä½\n  }\n  message ").concat(kO," \n  {\n    required int32 type= 1;   //(éç¥ç±»å 1:rtcæ¿é´ç¶æKVåæ´éç¥)\n    optional int64 time= 2;   //æ¶æ¯äº§çæ¶é´\n    optional string roomId=3; //ä¸»æ­æ¿é´id\n  }\n  message ").concat(VO,"\n  {\n    required int64 timestamp = 1;\n    required string roomId = 2;\n  }\n  message ").concat(BO,"\n  {\n    repeated RtcKVEntity entries = 1;\n    optional bool bFullUpdate = 2;\n    optional int64 syncTime = 3; \n  }\n  message RtcKVEntity \n  {\n    required string key = 1;\n    required string value = 2;\n    optional int32 status = 3;\n    optional int64 timestamp = 4;\n    optional string uid = 5;\n  }\n  enum IdentityChangeType \n  {\n    AnchorToViewer = 1; //1ä¸ºä¸»æ­åè§ä¼\n    ViewerToAnchor = 2; //2ä¸ºè§ä¼åä¸»æ­\n  }\n  message ").concat(GO,"\n  {\n    required string userId = 1;\n  }\n  message ").concat(FO,"\n  {\n    repeated RtcJoinedInfo info = 1;\n  }\n  message RtcJoinedInfo\n  {\n    required string deviceId = 1; //è®¾å¤ID\n    required string roomId = 2;   //å å¥çæ¿é´ID\n    optional int64 joinTime = 3;  //å å¥çæ¶é´\n  }\n  message ").concat(KO,"\n  {\n    required string rtcToken=1;\n    repeated RtcKVEntity entries = 2;//KVå±æ§å¯¹è±¡éå\n    optional int64 syncTime = 3;//ææå±æ§çæå¤§æ¶é´æ³ï¼ä¸æ¬¡æåKVæ¶ç¨ï¼ã\n  }\n  message ").concat(qO,"\n  {\n    required string invitedUserId=1;    //è¢«éè¯·çäººçuid\n    optional int32  timeoutTime=2;       //éè¯·è¶æ¶æ¶é´(ç§),é»è®¤ä¸åç§\n    required string invitedRoomId=3;    //è¢«éè¯·çæ¿é´\n    required string inviteInfo=4;       //éè¯·çä¿¡æ¯(åå«éè¯·äºº,è¢«éè¯·äºº,åèªuserid)å®¢æ·ç«¯å®ä¹å¥½.åè®®æ åserveréä¼ \n    required string inviteSessionId= 5; //å®¢æ·ç«¯ä¿è¯å¯ä¸æ§(å»ºè®®roomid_userid_æ¶é´æ³_éæºæ°)\n  }\n  message ").concat(HO,"\n  {\n    required string invitedUserId=1;   //è¢«éè¯·çäººçuid\n    required string invitedRoomId=2;   //è¢«éè¯·çæ¿é´\n    required string inviteInfo=3;      //åæ¶éè¯·çä¿¡æ¯(åå«éè¯·äºº,è¢«éè¯·äºº,åèªuserid)å®¢æ·ç«¯å®ä¹å¥½.åè®®æ åserveréä¼ \n    required string inviteSessionId=4; //éè¯·çsessionId,å®¢æ·ç«¯åèµ·éè¯·æ¶äº§ç\n  }\n  message ").concat(jO,"\n  {\n    required string inviteUserId=1;    //éè¯·çäººçuid\n    required int32  answerCode=2;      //æ¯å¦æ¥åè¿éº¦éè¯·.0ä¸ºæç»,1ä¸ºæ¥å\n    required string inviteRoomId=3;    //éè¯·çæ¿é´\n    required string inviteSessionId=4; //éè¯·çsessionId\n    required string content=5;         //éè¦è½¬åçcontent\n    optional string key=6;             //å¦ææ¥åçè¯,éè¦å è¿ä¸ªå­æ®µ,æ¾å¨roomçº§å«çkåv,æ°å å¥æ¿é´çè½æåå°\n    optional string value=7;           //å¦ææ¥åçè¯,éè¦å è¿ä¸ªå­æ®µ,æ¾å¨roomçº§å«çkåv,æ°å å¥æ¿é´çè½æåå°\n  }\n  message ").concat(YO,"\n  {\n    required string inviteRoomId=1;    //éè¯·çæ¿é´\n    required string inviteSessionId=2; //éè¯·çsessionId\n    required string inviteContent=3;   //ç»æè¿éº¦çä¿¡æ¯(éè¦éä¼ ç»æ¿é´åå¶ä»äºº)\n    repeated string inviteRoomKeys=4;  //éè¦å é¤è¿éº¦çä¿¡æ¯çkey\n  }\n  message ").concat(RO,"\n  {\n      required int64 syncTime = 1;//åæ­¥æ¶é´æ³\n      optional bool isEraseMsgContent = 2;//æåä¼è¯æ¶ï¼æ¯å¦å±è½ææ¶æ¯åå®¹\n  }\n  message ").concat(SO,"\n  {\n    required int64 syncTime = 1;//åæ­¥æ¶é´æ³\n  }\n  message  ").concat(MO,"\n  {\n    required string fromUserId = 1;//ï¼è°åçï¼\n    required string targetId = 2;// ç®æ Id(è¶çº§ç¾¤Id)\n    required ChannelType type = 3;//åéç±»åå¦ï¼ï¼P2P,GROUP,ULTRAGROUPï¼\n    required string msgUID = 4; // æ©å±æ¶æ¯çåå®¹ä½\n    required int64 msgTime = 5; //åå§æ¶æ¯æ¶é´\n    optional string busChannel = 6; // è¯¥æ¶æ¯æå±ä¼è¯çä¸å¡æ è¯ï¼éå¶20å­ç¬¦ä»¥å\n    optional string content = 7; // å³extraContentæ¶æ¯æ©å±åå®¹,ä¸è¡¨æ ¼è¯´æ\n  }\n  message ").concat(NO,"  //æ¥è¯¢å¥å\n  {\n    required int64 syncTime = 1;//åæ­¥æ¶é´æ³\n  }\n  message ").concat(wO,"  //åºç­ç»æ\n  {\n    repeated MsgChange list = 1; //åæ´\n    required int64 syncTime = 2; //åæ­¥æ¶é´(ç¨äºä¸æ¬¡åæ­¥å¥å)\n    optional bool  hasNext = 3 ;\n  }\n  message MsgChange  //åæ´è¯¦æ\n  {\n    required string targetId = 1; //  ç®æ Id(è¶çº§ç¾¤Id)\n    required ChannelType type = 2; //  ä¼è¯ç±»å\n    required int64 time = 3;  // åæ´æ¶é´\n    required int32 changeType = 4;  // æ¶æ¯åæ´ç±»åï¼1:æ©å±,2:ä¿®æ¹,3:æ¤å)\n    required string msgUID  = 5;  // æ¶æ¯ID\n    required int64 msgTime = 6;  //  æ¶æ¯æ¶é´\n    optional string busChannel = 7; // é¢éID\n    optional bool isAdmin = 8; //æ¯å¦ä¸ºç®¡çåï¼é»è®¤ä¸º 0ï¼è®¾ä¸º 1 æ¶ï¼IMKit æ¶å°æ­¤æ¡æ¶æ¯åï¼å°ç°æ¡é»è®¤æ¾ç¤ºä¸ºâç®¡çå æ¤åäºä¸æ¡æ¶æ¯âã\n    optional bool isDel = 9; //é»è®¤ä¸º 0 æ¤åè¯¥æ¡æ¶æ¯åæ¶ï¼ç¨æ·ç«¯å°è¯¥æ¡æ¶æ¯å é¤å¹¶æ¿æ¢ä¸ºä¸æ¡å°ç°æ¡æ¤åæç¤ºæ¶æ¯ï¼ä¸º 1 æ¶ï¼è¯¥æ¡æ¶æ¯å é¤åï¼ä¸æ¿æ¢ä¸ºå°ç°æ¡æç¤ºæ¶æ¯ã\n    optional string operatorId = 10; // æ°å  - æ¶æ¯åæ´çæä½äººId\n  }\n  message ").concat(AO,"  //è¯·æ±\n  {\n    required string targetId = 1; //  ç®æ Id(è¶çº§ç¾¤Id)\n    required ChannelType type = 2; //  ä¼è¯ç±»å\n    repeated MessageQueryInfo query = 3; //\n  }\n  message MessageQueryInfo\n  {\n    required int64 msgTime = 1;  // æ¶æ¯æ¶é´\n    required string msgUID  = 2;  // æ¶æ¯ID\n    optional string busChannel = 3; // é¢éID\n  }\n  message ").concat(bO,"  //åºç­\n  {\n    repeated DownStreamMessage list = 1;//æ¶æ¯\n  }\n  message ").concat(LO,"  //å®¢æ·ç«¯åé\n  {\n    optional string targetId =  1;// targetId\n    optional ChannelType type = 2;//åéä¼è¯ç±»åå¦ï¼ï¼P2P,GROUPï¼ \n    optional int32 opType = 3;  //0 , æ­£å¨è¾å¥, 1 æ­£å¨XXX  \n    optional string busChannel = 4; // é¢é(channelId,å¯ä»¥ä¸ºç©º)\n  }\n  message ").concat(PO,"  //æå¡ç«¯åé\n  {\n      optional ChannelType type = 1;//åéä¼è¯ç±»åå¦ï¼P2P,GROUPï¼ \n      optional int64 notifyType = 2; //0x1 è¡¨ç¤ºæç», 0x2 è¡¨ç¤ºæ±æ» 0x3 è¡¨ç¤ºæç»+æ±æ»\n      repeated OperateInfo info = 3 ; //æç»åè¡¨ å½notifyType ä¸º 1å3æ¶,ææ\n      repeated OperateSummary summary = 4 ; //æ±æ»åè¡¨, å½notifyType ä¸º2å3 æ¶,ææ\n  }\n  message ").concat(DO," {\n    // XX æ­£å¨åä»ä¹\n    optional string targetId = 1; // è¶çº§ç¾¤Id  ä¼è¯id\n    optional string busChannel = 2; // é¢é(channelId,å¯ä»¥ä¸ºç©º)\n    optional string userId = 3; // userId\n    optional int32 opType = 4;  //0 , æ­£å¨è¾å¥, 1 æ­£å¨XX \n    optional int64 optime = 5;  //æå¡ç«¯æ¶å°ç¨æ·æä½çä¸è¡æ¶é´. \n  }\n      \n  message ").concat(xO," {\n    // å ä¸ªäºº æ­£å¨å¹²ä»ä¹\n    optional string targetId = 1; // è¶çº§ç¾¤Id  ä¼è¯id\n    optional string busChannel = 2; // é¢é(channelId,å¯ä»¥ä¸ºç©º)\n    optional int32 count  = 3; // æä½äººæ°\n    optional int32 opType = 4; //0, æ­£å¨è¾å¥, 1 æ­£å¨XX \n  }\n  message ").concat(WO,"\n  {\n    required string  rtcRoomId= 1;  //rtcæ¿é´ID;\n  }\n  message ").concat(QO,"\n  {\n    required int32 nothing = 1;   //ç¨äºå ä½\n  }\n}\n"),ew=x,tw=ui,nw=/"/g,rw=R("".replace),iw=o,ow=function(e,t,n,r){var i=tw(ew(e)),o="<"+t;return""!==n&&(o+=" "+n+'="'+rw(tw(r),nw,"&quot;")+'"'),o+">"+i+"</"+t+">"},sw=function(e){return iw((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))};Qr({target:"String",proto:!0,forced:sw("sub")},{sub:function(){return ow(this,"sub","","")}});var aw=Yu,cw="ArrayBuffer",uw=CC.ArrayBuffer;Qr({global:!0,forced:r.ArrayBuffer!==uw},{ArrayBuffer:uw}),aw(cw);var lw=au;Qr({target:"Array",proto:!0},{fill:__}),lw("fill");var hw,dw,fw,pw,gw,vw,yw,mw=(hw=$O,dw=function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return!0===(e&&e.__isLong__)}function n(e,t){var n,r,o;return t?(o=(e>>>=0)>=0&&e<256)&&(r=c[e])?r:(n=i(e,(0|e)<0?-1:0,!0),o&&(c[e]=n),n):(o=(e|=0)>=-128&&e<128)&&(r=a[e])?r:(n=i(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function r(e,t){if(isNaN(e)||!isFinite(e))return t?g:p;if(t){if(e<0)return g;if(e>=h)return C}else{if(-d>=e)return E;if(e+1>=d)return _}return e<0?r(-e,t).neg():i(0|e%l,0|e/l,t)}function i(t,n,r){return new e(t,n,r)}function o(e,t,n){var i,s,a,c,l,h,d;if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return p;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||n>36)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return o(e.substring(1),t,n).neg();for(s=r(u(n,8)),a=p,c=0;c<e.length;c+=8)l=Math.min(8,e.length-c),h=parseInt(e.substring(c,c+l),n),l<8?(d=r(u(n,l)),a=a.mul(d).add(r(h))):a=(a=a.mul(s)).add(r(h));return a.unsigned=t,a}function s(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?o(t):i(t.low,t.high,t.unsigned)}var a,c,u,l,h,d,f,p,g,v,y,m,_,C,E,T;return e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t,a={},c={},e.fromInt=n,e.fromNumber=r,e.fromBits=i,u=Math.pow,e.fromString=o,e.fromValue=s,d=(h=(l=4294967296)*l)/2,f=n(16777216),p=n(0),e.ZERO=p,g=n(0,!0),e.UZERO=g,v=n(1),e.ONE=v,y=n(1,!0),e.UONE=y,m=n(-1),e.NEG_ONE=m,_=i(-1,2147483647,!1),e.MAX_VALUE=_,C=i(-1,-1,!0),e.MAX_UNSIGNED_VALUE=C,E=i(0,-2147483648,!1),e.MIN_VALUE=E,(T=e.prototype).toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*l+(this.low>>>0):this.high*l+(this.low>>>0)},T.toString=function(e){var t,n,i,o,s,a,c,l;if((e=e||10)<2||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())return this.eq(E)?(t=r(e),i=(n=this.div(t)).mul(t).sub(this),n.toString(e)+i.toInt().toString(e)):"-"+this.neg().toString(e);for(o=r(u(e,6),this.unsigned),s=this,a="";;){if(c=s.div(o),l=(s.sub(c.mul(o)).toInt()>>>0).toString(e),(s=c).isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){var e,t;if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},T.isZero=function(){return 0===this.high&&0===this.low},T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1==(1&this.low)},T.isEven=function(){return 0==(1&this.low)},T.equals=function(e){return t(e)||(e=s(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},T.eq=T.equals,T.notEquals=function(e){return!this.eq(e)},T.neq=T.notEquals,T.lessThan=function(e){return this.comp(e)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(e){return this.comp(e)<=0},T.lte=T.lessThanOrEqual,T.greaterThan=function(e){return this.comp(e)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(e){return this.comp(e)>=0},T.gte=T.greaterThanOrEqual,T.compare=function(e){if(t(e)||(e=s(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(v)},T.neg=T.negate,T.add=function(e){var n,r,o,a,c,u,l,h,d,f,p;return t(e)||(e=s(e)),n=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,c=e.high>>>16,u=65535&e.high,l=e.low>>>16,h=0,d=0,f=0,p=0,f+=(p+=a+(65535&e.low))>>>16,d+=(f+=o+l)>>>16,h+=(d+=r+u)>>>16,h+=n+c,i((f&=65535)<<16|(p&=65535),(h&=65535)<<16|(d&=65535),this.unsigned)},T.subtract=function(e){return t(e)||(e=s(e)),this.add(e.neg())},T.sub=T.subtract,T.multiply=function(e){var n,o,a,c,u,l,h,d,g,v,y,m;return this.isZero()?p:(t(e)||(e=s(e)),e.isZero()?p:this.eq(E)?e.isOdd()?E:p:e.eq(E)?this.isOdd()?E:p:this.isNegative()?e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg():e.isNegative()?this.mul(e.neg()).neg():this.lt(f)&&e.lt(f)?r(this.toNumber()*e.toNumber(),this.unsigned):(n=this.high>>>16,o=65535&this.high,a=this.low>>>16,c=65535&this.low,u=e.high>>>16,l=65535&e.high,h=e.low>>>16,g=0,v=0,y=0,m=0,y+=(m+=c*(d=65535&e.low))>>>16,v+=(y+=a*d)>>>16,y&=65535,v+=(y+=c*h)>>>16,g+=(v+=o*d)>>>16,v&=65535,g+=(v+=a*h)>>>16,v&=65535,g+=(v+=c*l)>>>16,g+=n*d+o*h+a*l+c*u,i((y&=65535)<<16|(m&=65535),(g&=65535)<<16|(v&=65535),this.unsigned)))},T.mul=T.multiply,T.divide=function(e){var n,i,o,a,c,l,h;if(t(e)||(e=s(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?g:p;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return y;o=g}else{if(this.eq(E))return e.eq(v)||e.eq(m)?E:e.eq(E)?v:(n=this.shr(1).div(e).shl(1)).eq(p)?e.isNegative()?v:m:(i=this.sub(e.mul(n)),o=n.add(i.div(e)));if(e.eq(E))return this.unsigned?g:p;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=p}for(i=this;i.gte(e);){for(n=Math.max(1,Math.floor(i.toNumber()/e.toNumber())),c=(a=Math.ceil(Math.log(n)/Math.LN2))<=48?1:u(2,a-48),h=(l=r(n)).mul(e);h.isNegative()||h.gt(i);)h=(l=r(n-=c,this.unsigned)).mul(e);l.isZero()&&(l=v),o=o.add(l),i=i.sub(h)}return o},T.div=T.divide,T.modulo=function(e){return t(e)||(e=s(e)),this.sub(this.div(e).mul(e))},T.mod=T.modulo,T.not=function(){return i(~this.low,~this.high,this.unsigned)},T.and=function(e){return t(e)||(e=s(e)),i(this.low&e.low,this.high&e.high,this.unsigned)},T.or=function(e){return t(e)||(e=s(e)),i(this.low|e.low,this.high|e.high,this.unsigned)},T.xor=function(e){return t(e)||(e=s(e)),i(this.low^e.low,this.high^e.high,this.unsigned)},T.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i(0,this.low<<e-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(e){return t(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?i(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(e){var n;return t(e)&&(e=e.toInt()),0==(e&=63)?this:(n=this.high,e<32?i(this.low>>>e|n<<32-e,n>>>e,this.unsigned):i(32===e?n:n>>>e-32,0,this.unsigned))},T.shru=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},T.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,255&t>>>8,255&t>>>16,255&t>>>24,255&e,255&e>>>8,255&e>>>16,255&e>>>24]},T.toBytesBE=function(){var e=this.high,t=this.low;return[255&e>>>24,255&e>>>16,255&e>>>8,255&e,255&t>>>24,255&t>>>16,255&t>>>8,255&t]},e}(),fw=function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+a.apply(String,e):(e.length+arguments.length>1024&&(t.push(a.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+e[t+h],h+=d,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+h],h+=d,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)}function i(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(t*c-1)*Math.pow(2,i),s+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+f]=255&s,f+=p,s/=256,u-=8);e[n+f-p]|=128*g}var o,s,a,c,u,l=function e(t,n,r){if(void 0===t&&(t=e.DEFAULT_CAPACITY),void 0===n&&(n=e.DEFAULT_ENDIAN),void 0===r&&(r=e.DEFAULT_NOASSERT),!r){if((t|=0)<0)throw RangeError("Illegal capacity");n=!!n,r=!!r}this.buffer=0===t?s:new ArrayBuffer(t),this.view=0===t?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=t,this.littleEndian=n,this.noAssert=r};return l.VERSION="5.0.1",l.LITTLE_ENDIAN=!0,l.BIG_ENDIAN=!1,l.DEFAULT_CAPACITY=16,l.DEFAULT_ENDIAN=l.BIG_ENDIAN,l.DEFAULT_NOASSERT=!1,l.Long=e||null,(o=l.prototype).__isByteBuffer__,Object.defineProperty(o,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1}),s=new ArrayBuffer(0),a=String.fromCharCode,l.accessor=function(){return Uint8Array},l.allocate=function(e,t,n){return new l(e,t,n)},l.concat=function(e,t,n,r){var i,o,s,a,c,u;for(("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0),i=0,s=0,a=e.length;a>s;++s)l.isByteBuffer(e[s])||(e[s]=l.wrap(e[s],t)),(o=e[s].limit-e[s].offset)>0&&(i+=o);if(0===i)return new l(0,n,r);for(u=new l(i,n,r),s=0;a>s;)(o=(c=e[s++]).limit-c.offset)<=0||(u.view.set(c.view.subarray(c.offset,c.limit),u.offset),u.offset+=o);return u.limit=u.offset,u.offset=0,u},l.isByteBuffer=function(e){return!0===(e&&e.__isByteBuffer__)},l.type=function(){return ArrayBuffer},l.wrap=function(e,t,n,r){var i,s;if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch(void 0===t&&(t="utf8"),t){case"base64":return l.fromBase64(e,n);case"hex":return l.fromHex(e,n);case"binary":return l.fromBinary(e,n);case"utf8":return l.fromUTF8(e,n);case"debug":return l.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!==zr(e))throw TypeError("Illegal buffer");if(l.isByteBuffer(e))return(i=o.clone.call(e)).markedOffset=-1,i;if(e instanceof Uint8Array)i=new l(0,n,r),e.length>0&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new l(0,n,r),e.byteLength>0&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");for((i=new l(e.length,n,r)).limit=e.length,s=0;s<e.length;++s)i.view[s]=e[s]}return i},o.writeBitSet=function(e,t){var n,r,i,o,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for(r=t,o=(i=e.length)>>3,s=0,t+=this.writeVarint32(i,t);o--;)n=1&!!e[s++]|(1&!!e[s++])<<1|(1&!!e[s++])<<2|(1&!!e[s++])<<3|(1&!!e[s++])<<4|(1&!!e[s++])<<5|(1&!!e[s++])<<6|(1&!!e[s++])<<7,this.writeByte(n,t++);if(i>s){for(a=0,n=0;i>s;)n|=(1&!!e[s++])<<a++;this.writeByte(n,t++)}return c?(this.offset=t,this):t-r},o.readBitSet=function(e){var t,n,r,i,o,s,a,c=void 0===e;for(c&&(e=this.offset),i=(r=(n=this.readVarint32(e)).value)>>3,o=0,s=[],e+=n.length;i--;)t=this.readByte(e++),s[o++]=!!(1&t),s[o++]=!!(2&t),s[o++]=!!(4&t),s[o++]=!!(8&t),s[o++]=!!(16&t),s[o++]=!!(32&t),s[o++]=!!(64&t),s[o++]=!!(128&t);if(r>o)for(a=0,t=this.readByte(e++);r>o;)s[o++]=!!(1&t>>a++);return c&&(this.offset=e),s},o.readBytes=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}return n=this.slice(t,t+e),r&&(this.offset+=e),n},o.writeBytes=o.append,o.writeInt8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeByte=o.writeInt8,o.readInt8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return 128==(128&(t=this.view[e]))&&(t=-(255-t+1)),n&&(this.offset+=1),t},o.readByte=o.readInt8,o.writeUint8=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=1)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=1,this.view[t]=e,r&&(this.offset+=1),this},o.writeUInt8=o.writeUint8,o.readUint8=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=this.view[e],n&&(this.offset+=1),t},o.readUInt8=o.readUint8,o.writeInt16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeShort=o.writeInt16,o.readInt16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),32768==(32768&t)&&(t=-(65535-t+1)),n&&(this.offset+=2),t},o.readShort=o.readInt16,o.writeUint16=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=2)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),r&&(this.offset+=2),this},o.writeUInt16=o.writeUint16,o.readUint16=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e],t|=this.view[e+1]<<8):(t=this.view[e]<<8,t|=this.view[e+1]),n&&(this.offset+=2),t},o.readUInt16=o.readUint16,o.writeInt32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeInt=o.writeInt32,o.readInt32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),t|=0,n&&(this.offset+=4),t},o.readInt=o.readInt32,o.writeUint32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,this.littleEndian?(this.view[t+3]=255&e>>>24,this.view[t+2]=255&e>>>16,this.view[t+1]=255&e>>>8,this.view[t]=255&e):(this.view[t]=255&e>>>24,this.view[t+1]=255&e>>>16,this.view[t+2]=255&e>>>8,this.view[t+3]=255&e),r&&(this.offset+=4),this},o.writeUInt32=o.writeUint32,o.readUint32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=0,this.littleEndian?(t=this.view[e+2]<<16,t|=this.view[e+1]<<8,t|=this.view[e],t+=this.view[e+3]<<24>>>0):(t=this.view[e+1]<<16,t|=this.view[e+2]<<8,t|=this.view[e+3],t+=this.view[e]<<24>>>0),n&&(this.offset+=4),t},o.readUInt32=o.readUint32,e&&(o.writeInt64=function(t,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,o=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o):(this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),s&&(this.offset+=8),this},o.writeLong=o.writeInt64,o.readInt64=function(t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!1),o&&(this.offset+=8),i},o.readLong=o.readInt64,o.writeUint64=function(t,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),(n+=8)>(r=this.buffer.byteLength)&&this.resize((r*=2)>n?r:n),n-=8,i=t.low,o=t.high,this.littleEndian?(this.view[n+3]=255&i>>>24,this.view[n+2]=255&i>>>16,this.view[n+1]=255&i>>>8,this.view[n]=255&i,n+=4,this.view[n+3]=255&o>>>24,this.view[n+2]=255&o>>>16,this.view[n+1]=255&o>>>8,this.view[n]=255&o):(this.view[n]=255&o>>>24,this.view[n+1]=255&o>>>16,this.view[n+2]=255&o>>>8,this.view[n+3]=255&o,n+=4,this.view[n]=255&i>>>24,this.view[n+1]=255&i>>>16,this.view[n+2]=255&i>>>8,this.view[n+3]=255&i),s&&(this.offset+=8),this},o.writeUInt64=o.writeUint64,o.readUint64=function(t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}return n=0,r=0,this.littleEndian?(n=this.view[t+2]<<16,n|=this.view[t+1]<<8,n|=this.view[t],n+=this.view[t+3]<<24>>>0,t+=4,r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0):(r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0,t+=4,n=this.view[t+1]<<16,n|=this.view[t+2]<<8,n|=this.view[t+3],n+=this.view[t]<<24>>>0),i=new e(n,r,!0),o&&(this.offset+=8),i},o.readUInt64=o.readUint64),o.writeFloat32=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=4)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=4,i(this.view,e,t,this.littleEndian,23,4),r&&(this.offset+=4),this},o.writeFloat=o.writeFloat32,o.readFloat32=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,23,4),n&&(this.offset+=4),t},o.readFloat=o.readFloat32,o.writeFloat64=function(e,t){var n,r=void 0===t;if(r&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}return(t+=8)>(n=this.buffer.byteLength)&&this.resize((n*=2)>t?n:t),t-=8,i(this.view,e,t,this.littleEndian,52,8),r&&(this.offset+=8),this},o.writeDouble=o.writeFloat64,o.readFloat64=function(e){var t,n=void 0===e;if(n&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}return t=r(this.view,e,this.littleEndian,52,8),n&&(this.offset+=8),t},o.readDouble=o.readFloat64,l.MAX_VARINT32_BYTES=5,l.calculateVarint32=function(e){return(e>>>=0)<128?1:e<16384?2:1<<21>e?3:1<<28>e?4:5},l.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},l.zigZagDecode32=function(e){return 0|e>>>1^-(1&e)},o.writeVarint32=function(e,t){var n,r,i,o=void 0===t;if(o&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}for((t+=r=l.calculateVarint32(e))>(i=this.buffer.byteLength)&&this.resize((i*=2)>t?i:t),t-=r,e>>>=0;e>=128;)n=128|127&e,this.view[t++]=n,e>>>=7;return this.view[t++]=e,o?(this.offset=t,this):r},o.writeVarint32ZigZag=function(e,t){return this.writeVarint32(l.zigZagEncode32(e),t)},o.readVarint32=function(e){var t,n,r,i,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}n=0,r=0;do{if(!this.noAssert&&e>this.limit)throw(i=Error("Truncated")).truncated=!0,i;t=this.view[e++],n<5&&(r|=(127&t)<<7*n),++n}while(0!=(128&t));return r|=0,o?(this.offset=e,r):{value:r,length:n}},o.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"===zr(t)?t.value=l.zigZagDecode32(t.value):t=l.zigZagDecode32(t),t},e&&(l.MAX_VARINT64_BYTES=10,l.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?n<16384?n<128?1:2:1<<21>n?3:4:r<16384?r<128?5:6:1<<21>r?7:8:i<128?9:10},l.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},l.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},o.writeVarint64=function(t,n){var r,i,o,s,a,c=void 0===n;if(c&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}switch("number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):!1!==t.unsigned&&(t=t.toSigned()),r=l.calculateVarint64(t),i=t.toInt()>>>0,o=t.shiftRightUnsigned(28).toInt()>>>0,s=t.shiftRightUnsigned(56).toInt()>>>0,(n+=r)>(a=this.buffer.byteLength)&&this.resize((a*=2)>n?a:n),n-=r,r){case 10:this.view[n+9]=1&s>>>7;case 9:this.view[n+8]=9!==r?128|s:127&s;case 8:this.view[n+7]=8!==r?128|o>>>21:127&o>>>21;case 7:this.view[n+6]=7!==r?128|o>>>14:127&o>>>14;case 6:this.view[n+5]=6!==r?128|o>>>7:127&o>>>7;case 5:this.view[n+4]=5!==r?128|o:127&o;case 4:this.view[n+3]=4!==r?128|i>>>21:127&i>>>21;case 3:this.view[n+2]=3!==r?128|i>>>14:127&i>>>14;case 2:this.view[n+1]=2!==r?128|i>>>7:127&i>>>7;case 1:this.view[n]=1!==r?128|i:127&i}return c?(this.offset+=r,this):r},o.writeVarint64ZigZag=function(e,t){return this.writeVarint64(l.zigZagEncode64(e),t)},o.readVarint64=function(t){var n,r,i,o,s,a,c=void 0===t;if(c&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!=0)throw TypeError("Illegal offset: "+t+" (not an integer)");if((t>>>=0)<0||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}if(n=t,r=0,i=0,o=0,s=0,r=127&(s=this.view[t++]),128&s&&(r|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(r|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(i=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<7,(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<14,(128&s||this.noAssert&&void 0===s)&&(i|=(127&(s=this.view[t++]))<<21,(128&s||this.noAssert&&void 0===s)&&(o=127&(s=this.view[t++]),(128&s||this.noAssert&&void 0===s)&&(o|=(127&(s=this.view[t++]))<<7,128&s||this.noAssert&&void 0===s))))))))))throw Error("Buffer overrun");return a=e.fromBits(r|i<<28,i>>>4|o<<24,!1),c?(this.offset=t,a):{value:a,length:t-n}},o.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=l.zigZagDecode64(n.value):n=l.zigZagDecode64(n),n}),o.writeCString=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),i=e.length,!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(r=0;i>r;++r)if(0===e.charCodeAt(r))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=u.calculateUTF16asUTF8(t(e))[1],n+=i+1,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=i+1,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,s?(this.offset=n,this):i},o.readCString=function(e){var t,r,i,o=void 0===e;if(o&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,i=-1,u.decodeUTF8toUTF16(function(){if(0===i)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return 0===(i=this.view[e++])?null:i}.bind(this),r=n(),!0),o?(this.offset=e,r()):{string:r(),length:e-t}},o.writeIString=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(i=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=4+r,this.littleEndian?(this.view[n+3]=255&r>>>24,this.view[n+2]=255&r>>>16,this.view[n+1]=255&r>>>8,this.view[n]=255&r):(this.view[n]=255&r>>>24,this.view[n+1]=255&r>>>16,this.view[n+2]=255&r>>>8,this.view[n+3]=255&r),n+=4,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==i+4+r)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+r));return s?(this.offset=n,this):n-i},o.readIString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}return t=e,n=this.readUint32(e),r=this.readUTF8String(n,l.METRICS_BYTES,e+=4),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},l.METRICS_CHARS="c",l.METRICS_BYTES="b",o.writeUTF8String=function(e,n){var r,i,o,s=void 0===n;if(s&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return i=n,r=u.calculateUTF16asUTF8(t(e))[1],n+=r,o=this.buffer.byteLength,n>o&&this.resize((o*=2)>n?o:n),n-=r,u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),s?(this.offset=n,this):n-i},o.writeString=o.writeUTF8String,l.calculateUTF8Chars=function(e){return u.calculateUTF16asUTF8(t(e))[0]},l.calculateString=l.calculateUTF8Bytes=function(e){return u.calculateUTF16asUTF8(t(e))[1]},o.readUTF8String=function(e,t,r){var i,o,s,a,c;if("number"==typeof t&&(r=t,t=void 0),(i=void 0===r)&&(r=this.offset),void 0===t&&(t=l.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}if(s=0,a=r,t===l.METRICS_CHARS){if(o=n(),u.decodeUTF8(function(){return e>s&&r<this.limit?this.view[r++]:null}.bind(this),(function(e){++s,u.UTF8toUTF16(e,o)})),s!==e)throw RangeError("Illegal range: Truncated data, "+s+" == "+e);return i?(this.offset=r,o()):{string:o(),length:r-a}}if(t===l.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!=0)throw TypeError("Illegal offset: "+r+" (not an integer)");if((r>>>=0)<0||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}if(c=r+e,u.decodeUTF8toUTF16(function(){return c>r?this.view[r++]:null}.bind(this),o=n(),this.noAssert),r!==c)throw RangeError("Illegal range: Truncated data, "+r+" == "+c);return i?(this.offset=r,o()):{string:o(),length:r-a}}throw TypeError("Unsupported metrics: "+t)},o.readString=o.readUTF8String,o.writeVString=function(e,n){var r,i,o,s,a=void 0===n;if(a&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}if(o=n,r=u.calculateUTF16asUTF8(t(e),this.noAssert)[1],i=l.calculateVarint32(r),n+=i+r,s=this.buffer.byteLength,n>s&&this.resize((s*=2)>n?s:n),n-=i+r,n+=this.writeVarint32(r,n),u.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==o+r+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+r+i));return a?(this.offset=n,this):n-o},o.readVString=function(e){var t,n,r,i=void 0===e;if(i&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}return t=e,n=this.readVarint32(e),r=this.readUTF8String(n.value,l.METRICS_BYTES,e+=n.length),e+=r.length,i?(this.offset=e,r.string):{string:r.string,length:e-t}},o.append=function(e,t,n){var r,i,o;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof l||(e=l.wrap(e,t)),(i=e.limit-e.offset)<=0||((n+=i)>(o=this.buffer.byteLength)&&this.resize((o*=2)>n?o:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i)),this},o.appendTo=function(e,t){return e.append(this,t),this},o.assert=function(e){return this.noAssert=!e,this},o.capacity=function(){return this.buffer.byteLength},o.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},o.clone=function(e){var t=new l(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},o.compact=function(e,t){var n,r,i;if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return 0===e&&t===this.buffer.byteLength?this:0==(n=t-e)?(this.buffer=s,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this):(r=new ArrayBuffer(n),(i=new Uint8Array(r)).set(this.view.subarray(e,t)),this.buffer=r,this.view=i,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this)},o.copy=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new l(0,this.littleEndian,this.noAssert);var n=t-e,r=new l(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},o.copyTo=function(e,t,n,r){var i,o,s;if(!this.noAssert&&!l.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(o=void 0===t)?e.offset:0|t,n=(i=void 0===n)?this.offset:0|n,r=void 0===r?this.limit:0|r,t<0||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(n<0||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);return 0==(s=r-n)?e:(e.ensureCapacity(t+s),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=s),o&&(e.offset+=s),this)},o.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},o.fill=function(e,t,n){var r=void 0===t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),void 0===t&&(t=this.offset),void 0===n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!=0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,t<0||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},o.flip=function(){return this.limit=this.offset,this.offset=0,this},o.mark=function(e){if(e=void 0===e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal offset: "+e+" (not an integer)");if((e>>>=0)<0||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=e,this},o.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},o.LE=function(e){return this.littleEndian=void 0===e||!!e,this},o.BE=function(e){return this.littleEndian=void 0!==e&&!e,this},o.prepend=function(e,t,n){var r,i,o,s,a;if(("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0),(r=void 0===n)&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: "+n+" (not an integer)");if((n>>>=0)<0||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}return e instanceof l||(e=l.wrap(e,t)),(i=e.limit-e.offset)<=0||((o=i-n)>0?(s=new ArrayBuffer(this.buffer.byteLength+o),(a=new Uint8Array(s)).set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=s,this.view=a,this.offset+=o,this.markedOffset>=0&&(this.markedOffset+=o),this.limit+=o,n+=o):new Uint8Array(this.buffer),this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i)),this},o.prependTo=function(e,t){return e.prepend(this,t),this},o.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},o.remaining=function(){return this.limit-this.offset},o.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},o.resize=function(e){var t,n;if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if((e|=0)<0)throw RangeError("Illegal capacity: 0 <= "+e)}return this.buffer.byteLength<e&&(t=new ArrayBuffer(e),(n=new Uint8Array(t)).set(this.view),this.buffer=t,this.view=n),this},o.reverse=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t||Array.prototype.reverse.call(this.view.subarray(e,t)),this},o.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(t<0||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},o.slice=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},o.toBuffer=function(e){var t,n=this.offset,r=this.limit;if(!this.noAssert){if("number"!=typeof n||n%1!=0)throw TypeError("Illegal offset: Not an integer");if(n>>>=0,"number"!=typeof r||r%1!=0)throw TypeError("Illegal limit: Not an integer");if(r>>>=0,n<0||n>r||r>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+n+" <= "+r+" <= "+this.buffer.byteLength)}return e||0!==n||r!==this.buffer.byteLength?n===r?s:(t=new ArrayBuffer(r-n),new Uint8Array(t).set(new Uint8Array(this.buffer).subarray(n,r),0),t):this.buffer},o.toArrayBuffer=o.toBuffer,o.toString=function(e,t,n){if(void 0===e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(n=t=e="utf8"),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}},c=function(){var e,t,n={},r=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],i=[];for(e=0,t=r.length;t>e;++e)i[r[e]]=e;return n.encode=function(e,t){for(var n,i;null!==(n=e());)t(r[63&n>>2]),i=(3&n)<<4,null!==(n=e())?(t(r[63&((i|=15&n>>4)|15&n>>4)]),i=(15&n)<<2,null!==(n=e())?(t(r[63&(i|3&n>>6)]),t(r[63&n])):(t(r[63&i]),t(61))):(t(r[63&i]),t(61),t(61))},n.decode=function(e,t){function n(e){throw Error("Illegal character code: "+e)}for(var r,o,s;null!==(r=e());)if(void 0===(o=i[r])&&n(r),null!==(r=e())&&(void 0===(s=i[r])&&n(r),t(o<<2>>>0|(48&s)>>4),null!==(r=e()))){if(void 0===(o=i[r])){if(61===r)break;n(r)}if(t((15&s)<<4>>>0|(60&o)>>2),null!==(r=e())){if(void 0===(s=i[r])){if(61===r)break;n(r)}t((3&o)<<6>>>0|s)}}},n.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},n}(),o.toBase64=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity||e>t)throw RangeError("begin, end");var r;return c.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},l.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new l(e.length/4*3,n),i=0;return c.decode(t(e),(function(e){r.view[i++]=e})),r.limit=i,r},l.btoa=function(e){return l.fromBinary(e).toBase64()},l.atob=function(e){return l.fromBase64(e).toBinary()},o.toBinary=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),t|=0,(e|=0)<0||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},l.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,o=new l(i,t);i>r;){if((n=e.charCodeAt(r))>255)throw RangeError("illegal char code: "+n);o.view[r++]=n}return o.limit=i,o},o.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",s="";r>n;){if(-1!==n&&(i+=(t=this.view[n])<16?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&t<127?String.fromCharCode(t):".")),++n,e&&n>0&&n%16==0&&n!==r){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},l.fromDebug=function(e,t,n){for(var r,i,o=e.length,s=new l(0|(o+1)/3,t,n),a=0,c=0,u=!1,h=!1,d=!1,f=!1,p=!1;o>a;){switch(r=e.charAt(a++)){case"!":if(!n){if(h||d||f){p=!0;break}h=d=f=!0}s.offset=s.markedOffset=s.limit=c,u=!1;break;case"|":if(!n){if(h||f){p=!0;break}h=f=!0}s.offset=s.limit=c,u=!1;break;case"[":if(!n){if(h||d){p=!0;break}h=d=!0}s.offset=s.markedOffset=c,u=!1;break;case"<":if(!n){if(h){p=!0;break}h=!0}s.offset=c,u=!1;break;case"]":if(!n){if(f||d){p=!0;break}f=d=!0}s.limit=s.markedOffset=c,u=!1;break;case">":if(!n){if(f){p=!0;break}f=!0}s.limit=c,u=!1;break;case"'":if(!n){if(d){p=!0;break}d=!0}s.markedOffset=c,u=!1;break;case" ":u=!1;break;default:if(!n&&u){p=!0;break}if(i=parseInt(r+e.charAt(a++),16),!n&&(isNaN(i)||i<0||i>255))throw TypeError("Illegal str: Not a debug encoded string");s.view[c++]=i,u=!0}if(p)throw TypeError("Illegal str: Invalid symbol at "+a)}if(!n){if(!h||!f)throw TypeError("Illegal str: Missing offset or limit");if(c<s.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+c+" < "+o)}return s},o.toHex=function(e,t){if(e=void 0===e?this.offset:e,t=void 0===t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)(n=this.view[e++])<16?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},l.fromHex=function(e,t,n){var r,i,o,s,a;if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(i=e.length,o=new l(0|i/2,t),s=0,a=0;i>s;s+=2){if(r=parseInt(e.substring(s,s+2),16),!n&&(!isFinite(r)||r<0||r>255))throw TypeError("Illegal str: Contains non-hex characters");o.view[a++]=r}return o.limit=a,o},u=function(){var e={MAX_CODEPOINT:1114111,encodeUTF8:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<128?t(127&n):n<2048?(t(192|31&n>>6),t(128|63&n)):n<65536?(t(224|15&n>>12),t(128|63&n>>6),t(128|63&n)):(t(240|7&n>>18),t(128|63&n>>12),t(128|63&n>>6),t(128|63&n)),n=null},decodeUTF8:function(e,t){for(var n,r,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0==(128&n))t(n);else if(192==(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224==(240&n))(null===(r=e())||null===(i=e()))&&s([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!=(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&s([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},UTF16toUTF8:function(e,t){for(var n,r=null;null!==(n=null!==r?r:e());)n>=55296&&n<=57343&&null!==(r=e())&&r>=56320&&r<=57343?(t(1024*(n-55296)+r-56320+65536),r=null):t(n);null!==r&&t(r)},UTF8toUTF16:function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)n<=65535?t(n):(t(55296+((n-=65536)>>10)),t(n%1024+56320)),n=null},encodeUTF16toUTF8:function(t,n){e.UTF16toUTF8(t,(function(t){e.encodeUTF8(t,n)}))},decodeUTF8toUTF16:function(t,n){e.decodeUTF8(t,(function(t){e.UTF8toUTF16(t,n)}))},calculateCodePoint:function(e){return e<128?1:e<2048?2:e<65536?3:4},calculateUTF8:function(e){for(var t,n=0;null!==(t=e());)n+=t<128?1:t<2048?2:t<65536?3:4;return n},calculateUTF16asUTF8:function(t){var n=0,r=0;return e.UTF16toUTF8(t,(function(e){++n,r+=e<128?1:e<2048?2:e<65536?3:4})),[n,r]}};return e}(),o.toUTF8=function(e,t){if(void 0===e&&(e=this.offset),void 0===t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!=0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!=0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,e<0||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{u.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(n){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},l.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new l(u.calculateUTF16asUTF8(t(e),!0)[1],n,r),o=0;return u.encodeUTF16toUTF8(t(e),(function(e){i.view[o++]=e})),i.limit=o,i},l}(dw),pw=function(e,t){var n,r,i={};return i.ByteBuffer=e,i.c=e,n=e,i.Long=t||null,i.VERSION="5.0.1",i.WIRE_TYPES={},i.WIRE_TYPES.VARINT=0,i.WIRE_TYPES.BITS64=1,i.WIRE_TYPES.LDELIM=2,i.WIRE_TYPES.STARTGROUP=3,i.WIRE_TYPES.ENDGROUP=4,i.WIRE_TYPES.BITS32=5,i.PACKABLE_WIRE_TYPES=[i.WIRE_TYPES.VARINT,i.WIRE_TYPES.BITS64,i.WIRE_TYPES.BITS32],i.TYPES={int32:{name:"int32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},uint64:{name:"uint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.UZERO:void 0},sint64:{name:"sint64",wireType:i.WIRE_TYPES.VARINT,defaultValue:i.Long?i.Long.ZERO:void 0},bool:{name:"bool",wireType:i.WIRE_TYPES.VARINT,defaultValue:!1},double:{name:"double",wireType:i.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:i.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:i.WIRE_TYPES.BITS64,defaultValue:i.Long?i.Long.ZERO:void 0},float:{name:"float",wireType:i.WIRE_TYPES.BITS32,defaultValue:0},enum:{name:"enum",wireType:i.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:i.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:i.WIRE_TYPES.STARTGROUP,defaultValue:null}},i.MAP_KEY_TYPES=[i.TYPES.int32,i.TYPES.sint32,i.TYPES.sfixed32,i.TYPES.uint32,i.TYPES.fixed32,i.TYPES.int64,i.TYPES.sint64,i.TYPES.sfixed64,i.TYPES.uint64,i.TYPES.fixed64,i.TYPES.bool,i.TYPES.string,i.TYPES.bytes],i.ID_MIN=1,i.ID_MAX=536870911,i.convertFieldsToCamelCase=!1,i.populateAccessors=!0,i.populateDefaults=!0,i.Util=function(){var e={};return e.IS_NODE=!("object"!==("undefined"==typeof process?"undefined":zr(process))||process+""!="[object process]"||process.browser),e.XHR=function(){var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=null;for(e=0;e<t.length;e++){try{n=t[e]()}catch(e){continue}break}if(!n)throw Error("XMLHttpRequest is not supported");return n},e.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE)if(n)g.readFile(t,(function(e,t){n(e?null:""+t)}));else try{return g.readFileSync(t)}catch(e){return null}else{var r=e.XHR();if(r.open("GET",t,!!n),r.setRequestHeader("Accept","text/plain"),"function"==typeof r.overrideMimeType&&r.overrideMimeType("text/plain"),!n)return r.send(null),200==r.status||0==r.status&&"string"==typeof r.responseText?r.responseText:null;if(r.onreadystatechange=function(){4==r.readyState&&(200==r.status||0==r.status&&"string"==typeof r.responseText?n(r.responseText):n(null))},4==r.readyState)return;r.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,(function(e,t){return t.toUpperCase()}))},e}(),i.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},i.DotProto=function(e,t){function n(e,n){var r=-1,i=1;if("-"==e.charAt(0)&&(i=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))r=parseInt(e);else if(t.NUMBER_HEX.test(e))r=parseInt(e.substring(2),16);else{if(!t.NUMBER_OCT.test(e))throw Error("illegal id value: "+(i<0?"-":"")+e);r=parseInt(e.substring(1),8)}if(r=0|i*r,!n&&r<0)throw Error("illegal id value: "+(i<0?"-":"")+e);return r}function r(e){var n=1;if("-"==e.charAt(0)&&(n=-1,e=e.substring(1)),t.NUMBER_DEC.test(e))return n*parseInt(e,10);if(t.NUMBER_HEX.test(e))return n*parseInt(e.substring(2),16);if(t.NUMBER_OCT.test(e))return n*parseInt(e.substring(1),8);if("inf"===e)return 1/0*n;if("nan"===e)return NaN;if(t.NUMBER_FLT.test(e))return n*parseFloat(e);throw Error("illegal number value: "+(n<0?"-":"")+e)}function i(e,t,n){void 0===e[t]?e[t]=n:(Array.isArray(e[t])||(e[t]=[e[t]]),e[t].push(n))}var o,s,a={},c=function(e){this.source=e+"",this.index=0,this.line=1,this.stack=[],this._stringOpen=null},u=c.prototype;return u._readString=function(){var e,n='"'===this._stringOpen?t.STRING_DQ:t.STRING_SQ;if(n.lastIndex=this.index-1,!(e=n.exec(this.source)))throw Error("unterminated string");return this.index=n.lastIndex,this.stack.push(this._stringOpen),this._stringOpen=null,e[1]},u.next=function(){var e,n,r,i,o;if(this.stack.length>0)return this.stack.shift();if(this.index>=this.source.length)return null;if(null!==this._stringOpen)return this._readString();do{for(e=!1;t.WHITESPACE.test(r=this.source.charAt(this.index));)if("\n"===r&&++this.line,++this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if(++this.index,"/"===this.source.charAt(this.index)){for(;"\n"!==this.source.charAt(++this.index);)if(this.index==this.source.length)return null;++this.index,++this.line,e=!0}else{if("*"!==(r=this.source.charAt(this.index)))return"/";do{if("\n"===r&&++this.line,++this.index===this.source.length)return null;n=r,r=this.source.charAt(this.index)}while("*"!==n||"/"!==r);++this.index,e=!0}}while(e);if(this.index===this.source.length)return null;if(i=this.index,t.DELIM.lastIndex=0,!t.DELIM.test(this.source.charAt(i++)))for(;i<this.source.length&&!t.DELIM.test(this.source.charAt(i));)++i;return('"'===(o=this.source.substring(this.index,this.index=i))||"'"===o)&&(this._stringOpen=o),o},u.peek=function(){if(0===this.stack.length){var e=this.next();if(null===e)return null;this.stack.push(e)}return this.stack[0]},u.skip=function(e){var t=this.next();if(t!==e)throw Error("illegal '"+t+"', '"+e+"' expected")},u.omit=function(e){return this.peek()===e&&(this.next(),!0)},u.toString=function(){return"Tokenizer ("+this.index+"/"+this.source.length+" at line "+this.line+")"},a.Tokenizer=c,o=function(e){this.tn=new c(e),this.proto3=!1},(s=o.prototype).parse=function(){var e,n={name:"[ROOT]",package:null,messages:[],enums:[],imports:[],options:{},services:[]},r=!0;try{for(;e=this.tn.next();)switch(e){case"package":if(!r||null!==n.package)throw Error("unexpected 'package'");if(e=this.tn.next(),!t.TYPEREF.test(e))throw Error("illegal package name: "+e);this.tn.skip(";"),n.package=e;break;case"import":if(!r)throw Error("unexpected 'import'");"public"===(e=this.tn.peek())&&this.tn.next(),e=this._readString(),this.tn.skip(";"),n.imports.push(e);break;case"syntax":if(!r)throw Error("unexpected 'syntax'");this.tn.skip("="),"proto3"===(n.syntax=this._readString())&&(this.proto3=!0),this.tn.skip(";");break;case"message":this._parseMessage(n,null),r=!1;break;case"enum":this._parseEnum(n),r=!1;break;case"option":this._parseOption(n);break;case"service":this._parseService(n);break;case"extend":this._parseExtend(n);break;default:throw Error("unexpected '"+e+"'")}}catch(e){throw e.message="Parse error at line "+this.tn.line+": "+e.message,e}return delete n.name,n},o.parse=function(e){return new o(e).parse()},s._readString=function(){var e,t,n="";do{if("'"!==(t=this.tn.next())&&'"'!==t)throw Error("illegal string delimiter: "+t);n+=this.tn.next(),this.tn.skip(t),e=this.tn.peek()}while('"'===e||'"'===e);return n},s._readValue=function(e){var n=this.tn.peek();if('"'===n||"'"===n)return this._readString();if(this.tn.next(),t.NUMBER.test(n))return r(n);if(t.BOOL.test(n))return"true"===n.toLowerCase();if(e&&t.TYPEREF.test(n))return n;throw Error("illegal value: "+n)},s._parseOption=function(e,n){var r,i=this.tn.next(),o=!1;if("("===i&&(o=!0,i=this.tn.next()),!t.TYPEREF.test(i))throw Error("illegal option name: "+i);r=i,o&&(this.tn.skip(")"),r="("+r+")",i=this.tn.peek(),t.FQTYPEREF.test(i)&&(r+=i,this.tn.next())),this.tn.skip("="),this._parseOptionValue(e,r),n||this.tn.skip(";")},s._parseOptionValue=function(e,n){var r=this.tn.peek();if("{"!==r)i(e.options,n,this._readValue(!0));else for(this.tn.skip("{");"}"!==(r=this.tn.next());){if(!t.NAME.test(r))throw Error("illegal option name: "+n+"."+r);this.tn.omit(":")?i(e.options,n+"."+r,this._readValue(!0)):this._parseOptionValue(e,n+"."+r)}},s._parseService=function(e){var n,r=this.tn.next();if(!t.NAME.test(r))throw Error("illegal service name at line "+this.tn.line+": "+r);for(n={name:r,rpc:{},options:{}},this.tn.skip("{");"}"!==(r=this.tn.next());)if("option"===r)this._parseOption(n);else{if("rpc"!==r)throw Error("illegal service token: "+r);this._parseServiceRPC(n)}this.tn.omit(";"),e.services.push(n)},s._parseServiceRPC=function(e){var n,r,i="rpc",o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal rpc service method name: "+o);if(n=o,r={request:null,response:null,request_stream:!1,response_stream:!1,options:{}},this.tn.skip("("),"stream"===(o=this.tn.next()).toLowerCase()&&(r.request_stream=!0,o=this.tn.next()),!t.TYPEREF.test(o))throw Error("illegal rpc service request type: "+o);if(r.request=o,this.tn.skip(")"),"returns"!==(o=this.tn.next()).toLowerCase())throw Error("illegal rpc service request type delimiter: "+o);if(this.tn.skip("("),"stream"===(o=this.tn.next()).toLowerCase()&&(r.response_stream=!0,o=this.tn.next()),r.response=o,this.tn.skip(")"),"{"===(o=this.tn.peek())){for(this.tn.next();"}"!==(o=this.tn.next());){if("option"!==o)throw Error("illegal rpc service token: "+o);this._parseOption(r)}this.tn.omit(";")}else this.tn.skip(";");void 0===e[i]&&(e[i]={}),e[i][n]=r},s._parseMessage=function(e,r){var i=!!r,o=this.tn.next(),s={name:"",fields:[],enums:[],messages:[],options:{},services:[],oneofs:{}};if(!t.NAME.test(o))throw Error("illegal "+(i?"group":"message")+" name: "+o);for(s.name=o,i&&(this.tn.skip("="),r.id=n(this.tn.next()),s.isGroup=!0),"["===(o=this.tn.peek())&&r&&this._parseFieldOptions(r),this.tn.skip("{");"}"!==(o=this.tn.next());)if(t.RULE.test(o))this._parseMessageField(s,o);else if("oneof"===o)this._parseMessageOneOf(s);else if("enum"===o)this._parseEnum(s);else if("message"===o)this._parseMessage(s);else if("option"===o)this._parseOption(s);else if("service"===o)this._parseService(s);else if("extensions"===o)s.extensions=this._parseExtensionRanges();else if("reserved"===o)this._parseIgnored();else if("extend"===o)this._parseExtend(s);else{if(!t.TYPEREF.test(o))throw Error("illegal message token: "+o);if(!this.proto3)throw Error("illegal field rule: "+o);this._parseMessageField(s,"optional",o)}return this.tn.omit(";"),e.messages.push(s),s},s._parseIgnored=function(){for(;";"!==this.tn.peek();)this.tn.next();this.tn.skip(";")},s._parseMessageField=function(e,r,i){var o,s,a;if(!t.RULE.test(r))throw Error("illegal message field rule: "+r);if(o={rule:r,type:"",name:"",options:{},id:0},"map"===r){if(i)throw Error("illegal type: "+i);if(this.tn.skip("<"),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field type: "+s);if(o.keytype=s,this.tn.skip(","),s=this.tn.next(),!t.TYPE.test(s)&&!t.TYPEREF.test(s))throw Error("illegal message field: "+s);if(o.type=s,this.tn.skip(">"),s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}else if("group"===(i=void 0!==i?i:this.tn.next())){if(a=this._parseMessage(e,o),!/^[A-Z]/.test(a.name))throw Error("illegal group name: "+a.name);o.type=a.name,o.name=a.name.toLowerCase(),this.tn.omit(";")}else{if(!t.TYPE.test(i)&&!t.TYPEREF.test(i))throw Error("illegal message field type: "+i);if(o.type=i,s=this.tn.next(),!t.NAME.test(s))throw Error("illegal message field name: "+s);o.name=s,this.tn.skip("="),o.id=n(this.tn.next()),"["===(s=this.tn.peek())&&this._parseFieldOptions(o),this.tn.skip(";")}return e.fields.push(o),o},s._parseMessageOneOf=function(e){var n,r,i,o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal oneof name: "+o);for(r=o,i=[],this.tn.skip("{");"}"!==(o=this.tn.next());)(n=this._parseMessageField(e,"optional",o)).oneof=r,i.push(n.id);this.tn.omit(";"),e.oneofs[r]=i},s._parseFieldOptions=function(e){this.tn.skip("[");for(var t=!0;"]"!==this.tn.peek();)t||this.tn.skip(","),this._parseOption(e,!0),t=!1;this.tn.next()},s._parseEnum=function(e){var r,i={name:"",values:[],options:{}},o=this.tn.next();if(!t.NAME.test(o))throw Error("illegal name: "+o);for(i.name=o,this.tn.skip("{");"}"!==(o=this.tn.next());)if("option"===o)this._parseOption(i);else{if(!t.NAME.test(o))throw Error("illegal name: "+o);this.tn.skip("="),r={name:o,id:n(this.tn.next(),!0)},"["===(o=this.tn.peek())&&this._parseFieldOptions({options:{}}),this.tn.skip(";"),i.values.push(r)}this.tn.omit(";"),e.enums.push(i)},s._parseExtensionRanges=function(){var t,n,i,o=[];do{for(n=[];;){switch(t=this.tn.next()){case"min":i=e.ID_MIN;break;case"max":i=e.ID_MAX;break;default:i=r(t)}if(n.push(i),2===n.length)break;if("to"!==this.tn.peek()){n.push(i);break}this.tn.next()}o.push(n)}while(this.tn.omit(","));return this.tn.skip(";"),o},s._parseExtend=function(e){var n,r=this.tn.next();if(!t.TYPEREF.test(r))throw Error("illegal extend reference: "+r);for(n={ref:r,fields:[]},this.tn.skip("{");"}"!==(r=this.tn.next());)if(t.RULE.test(r))this._parseMessageField(n,r);else{if(!t.TYPEREF.test(r))throw Error("illegal extend token: "+r);if(!this.proto3)throw Error("illegal field rule: "+r);this._parseMessageField(n,"optional",r)}return this.tn.omit(";"),e.messages.push(n),n},s.toString=function(){return"Parser at line "+this.tn.line},a.Parser=o,a}(i,i.Lang),i.Reflect=function(t){function r(e,n){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low==e.low&&e.high==e.high)return new t.Long(e.low,e.high,void 0===n?e.unsigned:n);if("string"==typeof e)return t.Long.fromString(e,n||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,n||!1);throw Error("not convertible to Long")}function i(e,n){var r=n.readVarint32(),o=7&r,s=r>>>3;switch(o){case t.WIRE_TYPES.VARINT:do{r=n.readUint8()}while(128==(128&r));break;case t.WIRE_TYPES.BITS64:n.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:i(s,n);break;case t.WIRE_TYPES.ENDGROUP:if(s===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+o)}return!0}var o,s,a,c,u,l,h,d,f,p,g,v,y,m,_,C,E={},T=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},I=T.prototype;return I.fqn=function(){for(var e=this.name,t=this;null!=(t=t.parent);)e=t.name+"."+e;return e},I.toString=function(e){return(e?this.className+" ":"")+this.fqn()},I.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},E.T=T,o=function(e,t,n,r,i){T.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=i||"proto2"},(s=o.prototype=Object.create(T.prototype)).getChildren=function(e){var t,n,r;if(null==(e=e||null))return this.children.slice();for(t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},s.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof u.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof u.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},s.getChild=function(e){var t,n,r="number"==typeof e?"id":"name";for(t=0,n=this.children.length;n>t;++t)if(this.children[t][r]===e)return this.children[t];return null},s.resolve=function(e,t){var n,r="string"==typeof e?e.split("."):e,i=this,o=0;if(""===r[o]){for(;null!==i.parent;)i=i.parent;o++}do{do{if(!(i instanceof E.Namespace)){i=null;break}if(!((n=i.getChild(r[o]))&&n instanceof E.T&&(!t||n instanceof E.Namespace))){i=null;break}i=n,o++}while(o<r.length);if(null!=i)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=i);return i},s.qn=function(e){var t,n,r=[],i=e;do{r.unshift(i.name),i=i.parent}while(null!==i);for(t=1;t<=r.length;t++)if(n=r.slice(r.length-t),e===this.resolve(n,e instanceof E.Namespace))return n.join(".");return e.fqn()},s.build=function(){var e,t,n,r={},i=this.children;for(t=0,n=i.length;n>t;++t)(e=i[t])instanceof o&&(r[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(r,"$options",{value:this.buildOpt()}),r},s.buildOpt=function(){var e,t,n,r,i={},o=Object.keys(this.options);for(e=0,t=o.length;t>e;++e)n=o[e],r=this.options[o[e]],i[n]=r;return i},s.getOption=function(e){return void 0===e?this.options:void 0!==this.options[e]?this.options[e]:null},E.Namespace=o,a=function(e,n,r,i){if(this.type=e,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},c=a.prototype,a.defaultFieldValue=function(e){if("string"==typeof e&&(e=t.TYPES[e]),void 0===e.defaultValue)throw Error("default value for type "+e.name+" is not supported");return e==t.TYPES.bytes?new n(0):e.defaultValue},c.verifyValue=function(n){var i,o,s,a=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this);switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof n||n==n&&n%1!=0)&&a(zr(n),"not an integer"),n>4294967295?0|n:n;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof n||n==n&&n%1!=0)&&a(zr(n),"not an integer"),n<0?n>>>0:n;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return r(n,!1)}catch(e){a(zr(n),e.message)}else a(zr(n),"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return r(n,!0)}catch(e){a(zr(n),e.message)}else a(zr(n),"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof n&&a(zr(n),"not a boolean"),n;case t.TYPES.float:case t.TYPES.double:return"number"!=typeof n&&a(zr(n),"not a number"),n;case t.TYPES.string:return"string"==typeof n||n&&n instanceof String||a(zr(n),"not a string"),""+n;case t.TYPES.bytes:return e.isByteBuffer(n)?n:e.wrap(n);case t.TYPES.enum:for(i=this.resolvedType.getChildren(t.Reflect.Enum.Value),s=0;s<i.length;s++){if(i[s].name==n)return i[s].id;if(i[s].id==n)return i[s].id}if("proto3"===this.syntax)return("number"!=typeof n||n==n&&n%1!=0)&&a(zr(n),"not an integer"),(n>4294967295||n<0)&&a(zr(n),"not in range for uint32"),n;a(n,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(n&&"object"===zr(n)||a(zr(n),"object expected"),n instanceof this.resolvedType.clazz)return n;if(n instanceof t.Builder.Message){for(s in o={},n)n.hasOwnProperty(s)&&(o[s]=n[s]);n=o}return new this.resolvedType.clazz(n)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+n+" (undefined type "+this.type+")")},c.calculateLength=function(e,r){if(null===r)return 0;var i;switch(this.type){case t.TYPES.int32:return r<0?n.calculateVarint64(r):n.calculateVarint32(r);case t.TYPES.uint32:return n.calculateVarint32(r);case t.TYPES.sint32:return n.calculateVarint32(n.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES.float:return 4;case t.TYPES.int64:case t.TYPES.uint64:return n.calculateVarint64(r);case t.TYPES.sint64:return n.calculateVarint64(n.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES.enum:return n.calculateVarint32(r);case t.TYPES.double:return 8;case t.TYPES.string:return i=n.calculateUTF8Bytes(r),n.calculateVarint32(i)+i;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return n.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(r),n.calculateVarint32(i)+i;case t.TYPES.group:return(i=this.resolvedType.calculate(r))+n.calculateVarint32(e<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},c.encodeValue=function(e,r,i){var o,s;if(null===r)return i;switch(this.type){case t.TYPES.int32:r<0?i.writeVarint64(r):i.writeVarint32(r);break;case t.TYPES.uint32:i.writeVarint32(r);break;case t.TYPES.sint32:i.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:i.writeUint32(r);break;case t.TYPES.sfixed32:i.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(r);break;case t.TYPES.sint64:i.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:i.writeUint64(r);break;case t.TYPES.sfixed64:i.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?i.writeVarint32("false"===r.toLowerCase()?0:!!r):i.writeVarint32(r?1:0);break;case t.TYPES.enum:i.writeVarint32(r);break;case t.TYPES.float:i.writeFloat32(r);break;case t.TYPES.double:i.writeFloat64(r);break;case t.TYPES.string:i.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");o=r.offset,i.writeVarint32(r.remaining()),i.append(r),r.offset=o;break;case t.TYPES.message:s=(new n).LE(),this.resolvedType.encode(r,s),i.writeVarint32(s.offset),i.append(s.flip());break;case t.TYPES.group:this.resolvedType.encode(r,i),i.writeVarint32(e<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return i},c.decode=function(e,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES.enum:return e.readVarint32();case t.TYPES.float:return e.readFloat();case t.TYPES.double:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(o=e.readVarint32(),e.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+e.remaining());return(i=e.clone()).limit=i.offset+o,e.offset+=o,i;case t.TYPES.message:return o=e.readVarint32(),this.resolvedType.decode(e,o);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(e){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(e));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(e);case t.TYPES.bool:return"true"===e;case t.TYPES.string:return this.verifyValue(e);case t.TYPES.bytes:return n.fromBinary(e)}},c.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},E.Element=a,u=function(e,t,n,r,i,s){o.call(this,e,t,n,r,s),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null},(l=u.prototype=Object.create(o.prototype)).build=function(r){var i,o,s,a;if(this.clazz&&!r)return this.clazz;for(i=function(t,r){function i(e,r,o,s){var a,c,u,l,h,d,f;if(null===e||"object"!==zr(e))return s&&s instanceof t.Reflect.Enum&&null!==(a=t.Reflect.Enum.getName(s.object,e))?a:e;if(n.isByteBuffer(e))return r?e.toBase64():e.toBuffer();if(t.Long.isLong(e))return o?e.toString():t.Long.fromValue(e);if(Array.isArray(e))return c=[],e.forEach((function(e,t){c[t]=i(e,r,o,s)})),c;if(c={},e instanceof t.Map){for(l=(u=e.entries()).next();!l.done;l=u.next())c[e.keyElem.valueToString(l.value[0])]=i(l.value[1],r,o,e.valueElem.resolvedType);return c}for(f in h=e.$type,d=void 0,e)e.hasOwnProperty(f)&&(c[f]=h&&(d=h.getChild(f))?i(e[f],r,o,d.resolvedType):i(e[f],r,o));return c}var o,s,a=r.getChildren(t.Reflect.Message.Field),c=r.getChildren(t.Reflect.Message.OneOf),u=function e(i){var o,s,u,l;for(t.Builder.Message.call(this),o=0,s=c.length;s>o;++o)this[c[o].name]=null;for(o=0,s=a.length;s>o;++o)this[(u=a[o]).name]=u.repeated?[]:u.map?new t.Map(u):null,!u.required&&"proto3"!==r.syntax||null===u.defaultValue||(this[u.name]=u.defaultValue);if(arguments.length>0)if(1!==arguments.length||null===i||"object"!==zr(i)||!("function"!=typeof i.encode||i instanceof e)||Array.isArray(i)||i instanceof t.Map||n.isByteBuffer(i)||i instanceof ArrayBuffer||t.Long&&i instanceof t.Long)for(o=0,s=arguments.length;s>o;++o)void 0!==(l=arguments[o])&&this.$set(a[o].name,l);else this.$set(i)},l=u.prototype=Object.create(t.Builder.Message.prototype);for(l.add=function(e,n,i){var o=r._fieldsByName[e];if(!i){if(!o)throw Error(this+"#"+e+" is undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+e+" is not a repeated field");n=o.verifyValue(n,!0)}return null===this[e]&&(this[e]=[]),this[e].push(n),this},l.$add=l.add,l.set=function(e,n,i){var o,s,a;if(e&&"object"===zr(e)){for(o in i=n,e)e.hasOwnProperty(o)&&void 0!==(n=e[o])&&this.$set(o,n,i);return this}if(s=r._fieldsByName[e],i)this[e]=n;else{if(!s)throw Error(this+"#"+e+" is not a field: undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));this[s.name]=n=s.verifyValue(n)}return s&&s.oneof&&(a=this[s.oneof.name],null!==n?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===e&&(this[s.oneof.name]=null)),this},l.$set=l.set,l.get=function(e,n){if(n)return this[e];var i=r._fieldsByName[e];if(!(i&&i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));return this[i.name]},l.$get=l.get,o=0;o<a.length;o++)(s=a[o])instanceof t.Reflect.Message.ExtensionField||r.builder.options.populateAccessors&&function(e){var t,n,i,o=e.originalName.replace(/(_[a-zA-Z])/g,(function(e){return e.toUpperCase().replace("_","")}));o=o.substring(0,1).toUpperCase()+o.substring(1),t=e.originalName.replace(/([A-Z])/g,(function(e){return"_"+e})),n=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},i=function(){return this[e.name]},null===r.getChild("set"+o)&&(l["set"+o]=n),null===r.getChild("set_"+t)&&(l["set_"+t]=n),null===r.getChild("get"+o)&&(l["get"+o]=i),null===r.getChild("get_"+t)&&(l["get_"+t]=i)}(s);return l.encode=function(t,n){var i,o;"boolean"==typeof t&&(n=t,t=void 0),i=!1,t||(t=new e,i=!0),o=t.littleEndian;try{return r.encode(this,t.LE(),n),(i?t.flip():t).LE(o)}catch(e){throw t.LE(o),e}},u.encode=function(e,t,n){return new u(e).encode(t,n)},l.calculate=function(){return r.calculate(this)},l.encodeDelimited=function(e){var t,i=!1;return e||(e=new n,i=!0),t=(new n).LE(),r.encode(this,t).flip(),e.writeVarint32(t.remaining()),e.append(t),i?e.flip():e},l.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},l.toArrayBuffer=l.encodeAB,l.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},l.toBuffer=l.encodeNB,l.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},l.toBase64=l.encode64,l.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},l.toHex=l.encodeHex,l.toRaw=function(e,t){return i(this,!!e,!!t,this.$type)},l.encodeJSON=function(){return JSON.stringify(i(this,!0,!0,this.$type))},u.decode=function(e,t){var i,o;"string"==typeof e&&(e=n.wrap(e,t||"base64")),i=(e=n.isByteBuffer(e)?e:n.wrap(e)).littleEndian;try{return o=r.decode(e.LE()),e.LE(i),o}catch(t){throw e.LE(i),t}},u.decodeDelimited=function(e,t){var i,o,s;if("string"==typeof e&&(e=n.wrap(e,t||"base64")),(e=n.isByteBuffer(e)?e:n.wrap(e)).remaining()<1)return null;if(i=e.offset,o=e.readVarint32(),e.remaining()<o)return e.offset=i,null;try{return s=r.decode(e.slice(e.offset,e.offset+o).LE()),e.offset+=o,s}catch(t){throw e.offset+=o,t}},u.decode64=function(e){return u.decode(e,"base64")},u.decodeHex=function(e){return u.decode(e,"hex")},u.decodeJSON=function(e){return new u(JSON.parse(e))},l.toString=function(){return r.toString()},Object.defineProperty&&(Object.defineProperty(u,"$options",{value:r.buildOpt()}),Object.defineProperty(l,"$options",{value:u.$options}),Object.defineProperty(u,"$type",{value:r}),Object.defineProperty(l,"$type",{value:r})),u}(t,this),this._fields=[],this._fieldsById={},this._fieldsByName={},s=0,a=this.children.length;a>s;s++)if((o=this.children[s])instanceof g||o instanceof u||o instanceof m){if(i.hasOwnProperty(o.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+o.toString(!0)+" cannot override static property '"+o.name+"'");i[o.name]=o.build()}else if(o instanceof u.Field)o.build(),this._fields.push(o),this._fieldsById[o.id]=o,this._fieldsByName[o.name]=o;else if(!(o instanceof u.OneOf||o instanceof y))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[s].toString(!0));return this.clazz=i},l.encode=function(e,t,n){var r,i,o,s,a,c=null;for(o=0,s=this._fields.length;s>o;++o)i=e[(r=this._fields[o]).name],r.required&&null===i?null===c&&(c=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==c)throw(a=Error("Missing at least one required field for "+this.toString(!0)+": "+c)).encoded=t,a;return t},l.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;o>i;++i){if(n=e[(t=this._fields[i]).name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},l.decode=function(e,n,r){var o,s,a,c,u,l,h,d,f,p,g,v;for(n="number"==typeof n?n:-1,u=e.offset,l=new this.clazz;e.offset<u+n||-1===n&&e.remaining()>0;){if(a=(o=e.readVarint32())>>>3,(s=7&o)===t.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(c=this._fieldsById[a])c.repeated&&!c.options.packed?l[c.name].push(c.decode(s,e)):c.map?(d=c.decode(s,e),l[c.name].set(d[0],d[1])):(l[c.name]=c.decode(s,e),c.oneof&&(null!==(f=l[c.oneof.name])&&f!==c.name&&(l[f]=null),l[c.oneof.name]=c.name));else switch(s){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:h=e.readVarint32(),e.offset+=h;break;case t.WIRE_TYPES.STARTGROUP:for(;i(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(p=0,g=this._fields.length;g>p;++p)if(null===l[(c=this._fields[p]).name])if("proto3"===this.syntax)l[c.name]=c.defaultValue;else{if(c.required)throw(v=Error("Missing at least one required field for "+this.toString(!0)+": "+c.name)).decoded=l,v;t.populateDefaults&&null!==c.defaultValue&&(l[c.name]=c.defaultValue)}return l},E.Message=u,h=function(e,n,r,i,o,s,a,c,l,h){T.call(this,e,n,s),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=i||null,this.type=o,this.resolvedType=null,this.id=a,this.options=c||{},this.defaultValue=null,this.oneof=l||null,this.syntax=h||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof u.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},(d=h.prototype=Object.create(T.prototype)).build=function(){this.element=new a(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new a(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?void 0!==this.options.default&&(this.defaultValue=this.verifyValue(this.options.default)):this.defaultValue=a.defaultFieldValue(this.type)},d.verifyValue=function(e,n){var r,i,o;if(n=n||!1,r=function(e,t){throw Error("Illegal value for "+this.toString(!0)+" of type "+this.type.name+": "+e+" ("+t+")")}.bind(this),null===e)return this.required&&r(zr(e),"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&r(zr(e),"proto3 field without field presence cannot be null"),null;if(this.repeated&&!n){for(Array.isArray(e)||(e=[e]),o=[],i=0;i<e.length;i++)o.push(this.element.verifyValue(e[i]));return o}return this.map&&!n?e instanceof t.Map?e:(e instanceof Object||r(zr(e),"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(zr(e),"no array expected"),this.element.verifyValue(e))},d.hasWirePresence=function(e,n){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES.float:case t.TYPES.double:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES.enum:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},d.encode=function(e,r,i){var o,s,a,c,u;if(null===this.type||"object"!==zr(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return r;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1),s=r.offset,o=0;o<e.length;o++)this.element.encodeValue(this.id,e[o],r);a=r.offset-s,(c=n.calculateVarint32(a))>1&&(u=r.slice(s,r.offset),s+=c-1,r.offset=s,r.append(u)),r.writeVarint32(a,s-c)}else for(o=0;o<e.length;o++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e[o],r);else this.map?e.forEach((function(e,i){var o=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(o),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,e,r)}),this):this.hasWirePresence(e,i)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,e,r))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return r},d.calculate=function(e,r){var i,o,s;if(e=this.verifyValue(e),null===this.type||"object"!==zr(this.type))throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===e||this.repeated&&0==e.length)return 0;i=0;try{if(this.repeated)if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s=0,o=0;o<e.length;o++)s+=this.element.calculateLength(this.id,e[o]);i+=n.calculateVarint32(s),i+=s}else for(o=0;o<e.length;o++)i+=n.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e[o]);else this.map?e.forEach((function(e,r){var o=n.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+n.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,e);i+=n.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i+=n.calculateVarint32(o),i+=o}),this):this.hasWirePresence(e,r)&&(i+=n.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,e))}catch(t){throw Error("Illegal value for "+this.toString(!0)+": "+e+" ("+t+")")}return i},d.decode=function(e,n,r){var i,o,s,c,u,l,h;if(!(!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM))throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){for(o=n.readVarint32(),o=n.offset+o,s=[];n.offset<o;)s.push(this.decode(this.type.wireType,n,!0));return s}if(this.map){if(c=a.defaultFieldValue(this.keyType),i=a.defaultFieldValue(this.type),o=n.readVarint32(),n.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+n.remaining());for((u=n.clone()).limit=u.offset+o,n.offset+=o;u.remaining()>0;)if(e=7&(l=u.readVarint32()),1==(h=l>>>3))c=this.keyElement.decode(u,e,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(u,e,h)}return[c,i]}return this.element.decode(n,e,this.id)},E.Message.Field=h,f=function(e,t,n,r,i,o,s){h.call(this,e,t,n,null,r,i,o,s),this.extension},f.prototype=Object.create(h.prototype),E.Message.ExtensionField=f,p=function(e,t,n){T.call(this,e,t,n),this.fields=[]},E.Message.OneOf=p,g=function(e,t,n,r,i){o.call(this,e,t,n,r,i),this.className="Enum",this.object=null},g.getName=function(e,t){var n,r,i=Object.keys(e);for(r=0;r<i.length;++r)if(e[n=i[r]]===t)return n;return null},(g.prototype=Object.create(o.prototype)).build=function(e){var n,r,i,o;if(this.object&&!e)return this.object;for(n=new t.Builder.Enum,i=0,o=(r=this.getChildren(g.Value)).length;o>i;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},E.Enum=g,v=function(e,t,n,r){T.call(this,e,t,n),this.className="Enum.Value",this.id=r},v.prototype=Object.create(T.prototype),E.Enum.Value=v,y=function(e,t,n,r){T.call(this,e,t,n),this.field=r},y.prototype=Object.create(T.prototype),E.Extension=y,m=function(e,t,n,r){o.call(this,e,t,n,r),this.className="Service",this.clazz=null},(m.prototype=Object.create(o.prototype)).build=function(e){return this.clazz&&!e?this.clazz:this.clazz=function(e,t){var r,i=function(t){e.Builder.Service.call(this),this.rpcImpl=t||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},o=i.prototype=Object.create(e.Builder.Service.prototype),s=t.getChildren(e.Reflect.Service.RPCMethod);for(r=0;r<s.length;r++)!function(e){o[e.name]=function(r,i){try{try{r=e.resolvedRequestType.clazz.decode(n.wrap(r))}catch(e){if(!(e instanceof TypeError))throw e}if(null===r||"object"!==zr(r))throw Error("Illegal arguments");r instanceof e.resolvedRequestType.clazz||(r=new e.resolvedRequestType.clazz(r)),this.rpcImpl(e.fqn(),r,(function(n,r){if(!n){try{r=e.resolvedResponseType.clazz.decode(r)}catch(e){}return r&&r instanceof e.resolvedResponseType.clazz?void i(null,r):void i(Error("Illegal response type received in service method "+t.name+"#"+e.name))}i(n)}))}catch(e){setTimeout(i.bind(this,e),0)}},i[e.name]=function(t,n,r){new i(t)[e.name](n,r)},Object.defineProperty&&(Object.defineProperty(i[e.name],"$options",{value:e.buildOpt()}),Object.defineProperty(o[e.name],"$options",{value:i[e.name].$options}))}(s[r]);return Object.defineProperty&&(Object.defineProperty(i,"$options",{value:t.buildOpt()}),Object.defineProperty(o,"$options",{value:i.$options}),Object.defineProperty(i,"$type",{value:t}),Object.defineProperty(o,"$type",{value:t})),i}(t,this)},E.Service=m,_=function(e,t,n,r){T.call(this,e,t,n),this.className="Service.Method",this.options=r||{}},(_.prototype=Object.create(T.prototype)).buildOpt=s.buildOpt,E.Service.Method=_,C=function(e,t,n,r,i,o,s,a){_.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null},C.prototype=Object.create(_.prototype),E.Service.RPCMethod=C,E}(i),i.Builder=function(e,t,n){function r(e){e.messages&&e.messages.forEach((function(t){t.syntax=e.syntax,r(t)})),e.enums&&e.enums.forEach((function(t){t.syntax=e.syntax}))}var i=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=i.prototype;return i.isMessage=function(e){return"string"==typeof e.name&&void 0===e.values&&void 0===e.rpc},i.isMessageField=function(e){return"string"==typeof e.rule&&"string"==typeof e.name&&"string"==typeof e.type&&void 0!==e.id},i.isEnum=function(e){return"string"==typeof e.name&&!(void 0===e.values||!Array.isArray(e.values)||0===e.values.length)},i.isService=function(e){return!("string"!=typeof e.name||"object"!==zr(e.rpc)||!e.rpc)},i.isExtend=function(e){return"string"==typeof e.ref},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach((function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t}),this),this},o.create=function(t){var r,o,s,a,c;if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){if(o=t.shift(),i.isMessage(o)){if(s=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),a={},o.oneofs&&Object.keys(o.oneofs).forEach((function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))}),this),o.fields&&o.fields.forEach((function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!==zr(e.options))throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),s.addChild(e)}),this),c=[],o.enums&&o.enums.forEach((function(e){c.push(e)})),o.messages&&o.messages.forEach((function(e){c.push(e)})),o.services&&o.services.forEach((function(e){c.push(e)})),o.extensions&&(s.extensions="number"==typeof o.extensions[0]?[o.extensions]:o.extensions),this.ptr.addChild(s),c.length>0){r.push(t),t=c,c=null,this.ptr=s,s=null;continue}c=null}else if(i.isEnum(o))s=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach((function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))}),this),this.ptr.addChild(s);else if(i.isService(o))s=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach((function(e){var t=o.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))}),this),this.ptr.addChild(s);else{if(!i.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(s=this.ptr.resolve(o.ref,!0))o.fields.forEach((function(t){var r,i,o,a;if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions&&(r=!1,s.extensions.forEach((function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)})),!r))throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)");i=t.name,this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i)),o=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,o),o.extension=a,this.ptr.addChild(a),s.addChild(o)}),this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o.import=function(t,n){var i,o,s,a,c,u,l,h,d="/";if("string"==typeof n){if(e.Util.IS_NODE,!0===this.files[n])return this.reset();this.files[n]=!0}else if("object"===zr(n)){if(i=n.root,e.Util.IS_NODE,(i.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(d="\\"),o=i+d+n.file,!0===this.files[o])return this.reset();this.files[o]=!0}if(t.imports&&t.imports.length>0){for(a=!1,"object"===zr(n)?(this.importRoot=n.root,a=!0,s=this.importRoot,n=n.file,(s.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(d="\\")):"string"==typeof n?this.importRoot?s=this.importRoot:n.indexOf("/")>=0?""===(s=n.replace(/\/[^\/]*$/,""))&&(s="/"):n.indexOf("\\")>=0?(s=n.replace(/\\[^\\]*$/,""),d="\\"):s=".":s=null,c=0;c<t.imports.length;c++)if("string"==typeof t.imports[c]){if(!s)throw Error("cannot determine import root");if("google/protobuf/descriptor.proto"===(u=t.imports[c]))continue;if(u=s+d+u,!0===this.files[u])continue;if(/\.proto$/i.test(u)&&!e.DotProto&&(u=u.replace(/\.proto$/,".json")),null===(l=e.Util.fetch(u)))throw Error("failed to import '"+u+"' in '"+n+"': file not found");/\.json$/i.test(u)?this.import(JSON.parse(l+""),u):this.import(e.DotProto.Parser.parse(l),u)}else n?/\.(\w+)$/.test(n)?this.import(t.imports[c],n.replace(/^(.+)\.(\w+)$/,(function(e,t,n){return t+"_import"+c+"."+n}))):this.import(t.imports[c],n+"_import"+c):this.import(t.imports[c]);a&&(this.importRoot=null)}return t.package&&this.define(t.package),t.syntax&&r(t),h=this.ptr,t.options&&Object.keys(t.options).forEach((function(e){h.options[e]=t.options[e]})),t.messages&&(this.create(t.messages),this.ptr=h),t.enums&&(this.create(t.enums),this.ptr=h),t.services&&(this.create(t.services),this.ptr=h),t.extends&&this.create(t.extends),this.reset()},o.resolveAll=function(){var r;if(null==this.ptr||"object"===zr(this.ptr.type))return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach((function(e){this.ptr=e,this.resolveAll()}),this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(!(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0)))throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES.enum,"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(!((r=this.ptr.parent.resolve(this.ptr.requestName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,!((r=this.ptr.parent.resolve(this.ptr.responseName,!0))&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+zr(this.ptr)+": "+this.ptr);return this.reset()},o.build=function(e){var t,n,r;if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},i.Message=function(){},i.Enum=function(){},i.Service=function(){},i}(i,i.Lang,i.Reflect),i.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){var r,i,o,s;if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(r=Object.keys(n),i=0;i<r.length;i++)o=this.keyElem.valueFromString(r[i]),s=this.valueElem.verifyValue(n[r[i]]),this.map[this.keyElem.valueToString(o)]={key:o,value:s}},i=r.prototype;return i.clear=function(){this.map={}},i.delete=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},i.entries=function(){var e,t,r=[],i=Object.keys(this.map);for(t=0;t<i.length;t++)r.push([(e=this.map[i[t]]).key,e.value]);return n(r)},i.keys=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].key);return n(t)},i.values=function(){var e,t=[],r=Object.keys(this.map);for(e=0;e<r.length;e++)t.push(this.map[r[e]].value);return n(t)},i.forEach=function(e,t){var n,r,i=Object.keys(this.map);for(r=0;r<i.length;r++)e.call(t,(n=this.map[i[r]]).value,n.key,this)},i.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},i.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map?this.map[t].value:void 0},i.has=function(e){return this.keyElem.valueToString(this.keyElem.verifyValue(e))in this.map},r}(0,i.Reflect),i.loadProto=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=void 0),i.loadJson(i.DotProto.Parser.parse(e),t,n)},i.protoFromString=i.loadProto,i.loadProtoFile=function(e,t,n){if(t&&"object"===zr(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadProto(r,n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===zr(e)?e.root+"/"+e.file:e);return null===r?null:i.loadProto(r,n,e)},i.protoFromFile=i.loadProtoFile,i.newBuilder=function(e){return void 0===(e=e||{}).convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=i.convertFieldsToCamelCase),void 0===e.populateAccessors&&(e.populateAccessors=i.populateAccessors),new i.Builder(e)},i.loadJson=function(e,t,n){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(n=t,t=null),t&&"object"===zr(t)||(t=i.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t.import(e,n),t.resolveAll(),t},i.loadJsonFile=function(e,t,n){if(t&&"object"===zr(t)?(n=t,t=null):t&&"function"==typeof t||(t=null),t)return i.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,(function(r){if(null!==r)try{t(null,i.loadJson(JSON.parse(r),n,e))}catch(e){t(e)}else t(Error("Failed to fetch file"))}));var r=i.Util.fetch("object"===zr(e)?e.root+"/"+e.file:e);return null===r?null:i.loadJson(JSON.parse(r),n,e)},r=hw,i.loadProto(r,void 0,"").build("Modules").probuf}(fw,dw),pw);mw.getModule=function(e){var t=new mw[e];return t.getArrayData=function(){var e=t.toArrayBuffer();return e=fg(e)?[].slice.call(new Int8Array(e)):e},t};var _w,Cw,Ew="pgMsgP",Tw="chatMsg",Iw="pcMsgP",Rw={PRIVATE:"ppMsgS",GROUP:"pgMsgS",CHATROOM:"chatMsgS"},Sw="delMsg",Mw="joinChrm",Nw="joinChrmR",Ow="exitChrm",ww="setKV",Aw="delKV",Uw="setKVS",bw="delKVS",Lw="qryRelationR",Pw="delRelation",Dw="setSeAtt",xw={PRIVATE:"cleanPMsg",GROUP:"cleanGMsg",ULTRA_GROUP:"cleanGMsg",CUSTOMER_SERVICE:"cleanCMsg",SYSTEM:"cleanSMsg"},kw="qryPMsg",Vw="qryGMsg",Bw="qryCHMsg",Gw="qryCMsg",Fw="qrySMsg",Kw=((gw={})["ppMsgP"]=ng.PRIVATE,gw[Ew]=ng.GROUP,gw[Tw]=ng.CHATROOM,gw[Iw]=ng.CUSTOMER_SERVICE,gw),qw=((vw={})[ng.PRIVATE]=kw,vw[ng.GROUP]=Vw,vw[ng.CHATROOM]=Bw,vw[ng.CUSTOMER_SERVICE]=Gw,vw[ng.SYSTEM]=Fw,vw),Hw=((yw={})[ng.PRIVATE]=xw.PRIVATE,yw[ng.GROUP]=xw.GROUP,yw[ng.ULTRA_GROUP]=xw.ULTRA_GROUP,yw[ng.CUSTOMER_SERVICE]=xw.CUSTOMER_SERVICE,yw[ng.SYSTEM]=xw.SYSTEM,yw),jw="1",Yw="0",Ww=1,Qw=2,Jw=3,zw=function(){function e(e){this._codec="websocket"===e?mw:zO,this._connectType=e}return e.prototype.decodeByPBName=function(e,t,n){var r,i=this,o=e,s=((r={})[nN]=i._formatSyncMessages,r[tN]=i._formatReceivedMessage,r[$M]=i._formatSentMessage,r[uN]=i._formatHistoryMessages,r[hN]=i._formatConversationList,r[TN]=i._formatChatRoomInfos,r[RN]=i._formatRTCUserList,r[bN]=i._formatRTCData,r[JN]=i._formatChatRoomKVList,r[rO]=i._formatUserSetting,r[sO]=i._formatConversationStatus,r[vO]=i._formatGrpReadReceiptQryResp,r[tO]=i._formatSetUserSettingOutput,r[iO]=i._formatUserSettingNotification,r[wO]=i._formatUltraMsgChangeList,r[PO]=i._formatUltraOperateStatusNotifyList,r[bO]=i._formatUltraMsgList,r[CN]=i._formatChrmKVVersion,r[BO]=i._formatRTCRoomKVList,r[UN]=i._formatRTCAuidenceJoinRoomData,r[FO]=i._formatRTCJoinedUserInfo,r)[t];try{o=e.length>0&&i._codec[t].decode(e),gg(o)&&(o=function(e){for(var t in e)gg(e[t])&&(e[t]=ky(e[t]));return e}(o)),vg(s)&&(o=s.call(this,o,n))}catch(n){Mg.error("PB parse error\n",n,e,t)}return o},e.prototype._readBytes=function(e){var t=e.offset,n=e.buffer,r=e.limit;if(t)try{var i=fg(n)?new Uint8Array(n):n;return zM.readUTF(i.subarray(t,r))}catch(e){Mg.info("readBytes error\n",e)}return e},e.prototype._formatBytes=function(e){if(!e)return e;var t=this._readBytes(e);try{t=JSON.parse(t)}catch(e){Mg.info("formatBytes error\n",e)}return t||e},e.prototype._formatSyncMessages=function(e,t){t=t||{};var n=this,r=e.list,i=e.syncTime,o=e.finished;return(yg(o)||null===o)&&(e.finished=!0),e.syncTime=ky(i),e.list=Hy(r,(function(e){return n._formatReceivedMessage(e,t)})),e},e.prototype._formatReceivedMessage=function(e,t){if(!e)return e;var n=(t=t||{}).currentUserId,r=t.connectedTime,i=e.content,o=e.fromUserId,s=e.type,a=e.groupId,c=e.status,u=e.dataTime,l=e.classname,h=e.msgId,d=e.extraContent,f=e.pushContent,p=e.pushExt,g=e.configFlag,v=e.extStatus;e.toUserId,e.groupUnpush;var y=(e.direction||Hg.RECEIVE)===Hg.SEND,m=function(e){var t=Jr.READ;return{isPersited:!!(16&e),isCounted:!!(32&e),isMentioned:!!(64&e),disableNotification:!!(512&e),receivedStatus:t=2&e?Jr.RETRIEVED:t,canIncludeExpansion:!!(1024&e)}}(c),_=m.isPersited,C=m.isCounted,E=m.isMentioned,T=m.disableNotification,I=m.receivedStatus,R=m.canIncludeExpansion,S=!!(2&(v||0)),M=!!(4&(v||0)),N=[ng.GROUP,ng.CHATROOM,ng.RTC_ROOM,ng.ULTRA_GROUP].indexOf(s)>-1?a:o,O=y?n:o,w=ky(u),A=w<r,U=s===ng.CHATROOM,b=this._formatBytes(i),L={};if(p&&(L=Gy(p.pushConfigs,p.pushId)),b.user){var P=b.user,D=P.portrait,x=P.portraitUri,k=D||x;k&&(b.user.portrait=b.user.portraitUri=k)}var V,B=la(la({},L),{pushTitle:null==p?void 0:p.title,pushContent:f,pushData:f,disablePushTitle:!!g&&Boolean(4&g),forceShowDetailContent:!!g&&Boolean(8&g),templateId:null==p?void 0:p.templateId}),G=y?Hg.SEND:Hg.RECEIVE;U&&o===n&&(G=Hg.SEND),d&&(V={},V=Zy(d));var F={conversationType:s,targetId:N,senderUserId:O,messageType:l,messageUId:h,isPersited:_,isCounted:C,isMentioned:E,sentTime:w,messageDirection:G,receivedTime:$y.getTime(),disableNotification:T,receivedStatus:I,canIncludeExpansion:R,content:b,expansion:V,configFlag:g,pushConfig:B,channelId:e.busChannel||"",isInterrupt:S,isModifyMessage:M};return s!==ng.ULTRA_GROUP&&(F.isOffLineMessage=A),F},e.prototype._formatSentMessage=function(e,t){var n,r=e.content,i=e.classname,o=e.sessionId,s=e.msgId,a=e.extraContent,c=e.pushExt,u=e.pushContent,l=e.configFlag,h=e.extStatus,d=t.signal,f=t.currentUserId,p=d.date,g=d.topic,v=d.targetId,y=!!(2&(h||0)),m=function(e){return{isPersited:!!(1&e),isCounted:!!(2&e),disableNotification:!!(32&e),canIncludeExpansion:!!(64&e)}}(o),_=m.isPersited,C=m.isCounted,E=m.disableNotification,T=m.canIncludeExpansion,I=Kw[g]||ng.PRIVATE,R=Yy(Rw,g),S=this._formatBytes(r),M=v;i===Xg.RECALL&&(I=S.conversationType||I,M=S.targetId||v),a&&(n={},n=Zy(a));var N={};c&&(N=Gy(c.pushConfigs,c.pushId));var O=la(la({},N),{pushTitle:null==c?void 0:c.title,pushContent:u,pushData:u,disablePushTitle:!!l&&Boolean(4&l),forceShowDetailContent:!!l&&Boolean(8&l),templateId:null==c?void 0:c.templateId});return{conversationType:I,targetId:M,messageType:i,messageUId:s,isPersited:_,isCounted:C,isStatusMessage:R,senderUserId:f,content:this._formatBytes(r),sentTime:1e3*p,receivedTime:$y.getTime(),messageDirection:Hg.SEND,isOffLineMessage:!1,disableNotification:E,canIncludeExpansion:T,expansion:n,pushConfig:O,channelId:e.busChannel||"",isInterrupt:y}},e.prototype._formatHistoryMessages=function(e,t){var n=this,r=t.conversation||{},i=e.list,o=e.hasMsg,s=r.targetId,a=ky(e.syncTime),c=[];return qy(i,(function(e){var i=n._formatReceivedMessage(e,t);r.conversationType===ng.ULTRA_GROUP?i.targetId=e.groupId||r.targetId:i.targetId=s,c.push(i)}),{isReverse:!0}),{syncTime:a,list:c,hasMore:!!o}},e.prototype._formatUltraMsgChangeList=function(e){var t=e.list,n=e.syncTime,r=e.hasNext;return{syncTime:n,list:t&&t.map((function(e){var t=e.targetId,n=e.type,r=e.time,i=e.changeType,o=e.msgUID,s=e.msgTime,a=e.busChannel,c=e.isAdmin,u=e.isDel,l=e.operatorId;return{targetId:t,conversationType:n,changeType:i,messageUId:o,changeTime:ky(r),sendTime:ky(s),channelId:a,isAdmin:c,isDel:u,operatorId:l}})),hasNext:r}},e.prototype._formatUltraOperateStatusNotifyList=function(e){var t=e.type,n=e.notifyType,r=e.info,i=e.summary,o=[],s=[],a=2==(2&n),c=1==(1&n);return c&&Array.isArray(r)&&r.forEach((function(e){var t=e.targetId,n=e.busChannel,r=e.userId,i=e.opType,s=e.optime,a=ky(s);o.push({targetId:t,channelId:n,userId:r,operationType:i,operationTime:a})})),a&&Array.isArray(i)&&i.forEach((function(e){var t=e.targetId,n=e.busChannel,r=e.count,i=e.opType;s.push({targetId:t,channelId:n,count:r,operationType:i})})),{conversationType:t,info:o,summary:s,hasInfo:c,hasSummary:a}},e.prototype._formatUltraMsgList=function(e,t){var n=this,r=e.list;return{list:r&&r.map((function(e){return n._formatReceivedMessage(e,t)}))}},e.prototype._formatConversationList=function(e,t){var n=this,r=e.info,i=t.afterDecode||function(){},o={list:(r=Hy(r,(function(e){var r=e.msg,o=e.userId,s=e.type,a=e.unreadCount,c=e.busChannel,u=e.versionTime,l=e.remindCount,h=null;r&&((h=n._formatReceivedMessage(r,t)).targetId=o);var d={targetId:o,conversationType:s,unreadMessageCount:ky(a)||0,latestMessage:h||{},channelId:c||""};return s===ng.ULTRA_GROUP&&(d.versionTime=ky(u)||0,d.unreadMentionedCount=ky(l)||0),i(d)||d})))||[]};return((null==t?void 0:t.conversationType)||ng.NONE)===ng.ULTRA_GROUP&&(o.isFinished=e.isFinished),o},e.prototype._formatSetUserSettingOutput=function(e){return e},e.prototype._formatChatRoomInfos=function(e){var t=e.userTotalNums,n=e.userInfos,r=Hy(n,(function(e){var t=e.id,n=e.time;return{id:t,time:ky(n)}}));return{userCount:t,userInfos:r}},e.prototype._formatChatRoomKVList=function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return t=Hy(t=t||[],(function(e){var t=e.key,n=e.value,r=e.status,i=e.timestamp,o=e.uid,s=e.version,a=function(e){return{isAutoDelete:!!(1&e),isOverwrite:!!(2&e),type:4&e?av.DELETE:av.UPDATE}}(r);return{key:t,value:n,isAutoDelete:a.isAutoDelete,isOverwrite:a.isOverwrite,type:a.type,userId:o,timestamp:ky(i),version:ky(s)}})),{kvEntries:t,isFullUpdate:n,syncTime:r}},e.prototype._formatUserSetting=function(e){var t=this,n=e.items,r=e.version,i={};return qy(n||[],(function(e){var n=e.key,r=e.version,o=e.value;e.version=ky(r),e.value=t._readBytes(o),"Tag"===n&&e.tags.forEach((function(e){e.createdTime=ky(e.createdTime),e.tagName=e.name})),i[n]=e})),{settings:i,version:r}},e.prototype._formatConversationStatus=function(e){var t=e.state,n=[];return qy(t,(function(e){var t=e.type,r=e.channelId,i=e.time,o=e.stateItem,s=e.busChannel,a=$g.CLOSE,c=tv.NOT_SET,u=!1,l=[];qy(o,(function(e){var t=e.sessionStateType,n=e.value,r=e.tags;switch(t){case Ww:a=n===jw?$g.OPEN:$g.CLOSE,c=Number(n)||tv.NOT_SET;break;case Qw:u=n===jw;break;case Jw:l=r}})),n.push({conversationType:t,type:t,targetId:r,notificationStatus:a,notificationLevel:c,isTop:u,updatedTime:ky(i),tags:l,channelId:s||""})})),n},e.prototype._formatRTCUserList=function(e){var t=e.users,n=e.token,r=e.sessionId,i=e.roomInfo,o=e.entries,s=e.offlineKickTime,a={};return qy(t,(function(e){var t=e.userId,n=e.userData,r={};qy(n,(function(e){var t=e.key,n=e.value;r[t]=n})),a[t]=r})),{users:a,token:n,sessionId:r,roomInfo:i,kvEntries:o,offlineKickTime:s}},e.prototype._formatRTCData=function(e){var t=e.outInfo,n={};return qy(t,(function(e){n[e.key]=e.value})),n},e.prototype._formatRTCRoomInfo=function(e){var t=e.roomId,n=e.userCount,r=e.roomData,i={id:t,total:n};return qy(r,(function(e){i[e.key]=e.value})),i},e.prototype._formatGrpReadReceiptQryResp=function(e){var t=e.totalMemberNum,n=e.list;return n.forEach((function(e){e.readTime=ky(e.readTime)})),{totalMemberCount:t,list:n}},e.prototype._formatUserSettingNotification=function(e){return e},e.prototype._formatRTCRoomKVList=function(e){var t=e.entries,n=e.bFullUpdate,r=e.syncTime;return{kvEntries:t=(t=t||[]).map((function(e){var t=e.timestamp;return Object.assign(e,{timestamp:ky(t)})})),isFullUpdate:n,syncTime:r}},e.prototype._formatChrmKVVersion=function(e){return e},e.prototype._formatRTCAuidenceJoinRoomData=function(e){return e},e.prototype._formatRTCJoinedUserInfo=function(e){return(e.info||[]).map((function(e){return{deviceId:e.deviceId,roomId:e.roomId,joinTime:ky(e.joinTime)}}))},e.prototype.encodeServerConfParams=function(){var e=this._codec.getModule(rN);return e.setNothing(1),e.getArrayData()},e.prototype._getUpMsgModule=function(e,t){var n,r,i,o="comet"===this._connectType,s=e.conversationType,a=t.messageType,c=t.isMentioned,u=t.mentionedType,l=t.mentionedUserIdList,h=t.content,d=t.pushContent,f=t.pushData,p=t.directionalUserIdList,g=t.isFilerWhiteBlacklist,v=t.isVoipPush,y=t.canIncludeExpansion,m=t.expansion,_=t.pushConfig,C=t.channelId;[ng.GROUP,ng.ULTRA_GROUP].includes(s);var E=this._codec.getModule($M),T=function(e){var t=e.isStatusMessage,n=e.isPersited,r=e.isCounted;t&&(n=r=!1);var i=0;return n&&(i|=1),r&&(i|=2),e.isMentioned&&(i|=4),e.disableNotification&&(i|=32),e.canIncludeExpansion&&(i|=64),i}(t),I=_||{},R=I.pushTitle,S=I.pushContent,M=I.pushData,N=I.iOSConfig,O=I.androidConfig,w=I.templateId,A=I.disablePushTitle,U=I.forceShowDetailContent,b=0;E.setSessionId(T),c&&h&&(h.mentionedInfo={userIdList:(null===(n=h.mentionedInfo)||void 0===n?void 0:n.userIdList)||l||[],type:(null===(r=h.mentionedInfo)||void 0===r?void 0:r.type)||u||rv.ALL,mentionedContent:(null===(i=h.mentionedInfo)||void 0===i?void 0:i.mentionedContent)||""});var L=S||d||"",P=M||f||"";if(L&&E.setPushText(L),P&&E.setAppData(P),p&&E.setUserId(p),b|=v?1:0,b|=g?2:0,b|=A?4:0,b|=U?8:0,E.setConfigFlag(b),E.setClassname(a),h.user&&h.user.portraitUri&&(h.user.portrait=h.user.portraitUri),E.setContent(JSON.stringify(h)),y&&m){var D={};qy(m,(function(e,t){D[t]={v:e}})),E.setExtraContent(JSON.stringify(D))}if(_){var x=this._codec.getModule(eN);if(R&&x.setTitle(R),N&&O){var k=By(N,O);x.setPushConfigs(k)}(null==O?void 0:O.notificationId)&&x.setPushId(null==O?void 0:O.notificationId),x.setTemplateId(w||""),E.setPushExt(o?x.getArrayData():x)}return yg(C)||E.setBusChannel(C),E},e.prototype.encodeUpMsg=function(e,t){return this._getUpMsgModule(e,t).getArrayData()},e.prototype.encodeSyncMsg=function(e){var t=e.sendboxTime,n=e.inboxTime,r=e.broadcastSyncTime,i=this._codec.getModule(oN);return i.setIspolling(!1),i.setIsPullSend(!0),i.setSendBoxSyncTime(t),i.setSyncTime(n),i.setBroadcastSyncTime(r),i.getArrayData()},e.prototype.encodeChrmSyncMsg=function(e,t){e=e||0,t=t||0;var n=this._codec.getModule(sN);return n.setCount(t),n.setSyncTime(e),n.getArrayData()},e.prototype.encodeGetHistoryMsg=function(e,t){var n=t.count,r=t.order,i=t.timestamp,o=t.channelId,s=this._codec.getModule(cN);return s.setTargetId(e),s.setTime(i),s.setCount(n),s.setOrder(r),s.setBusChannel(o||""),s.getArrayData()},e.prototype.encodeSuperSyncMsg=function(e){var t=this._codec.getModule(SO);return t.setSyncTime(e),t.getArrayData()},e.prototype.encodeGetConversationList=function(e){var t=(e=e||{}).count,n=e.startTime,r=this._codec.getModule(lN);return r.setType(1),r.setCount(t),r.setStartTime(n),r.getArrayData()},e.prototype.encodeOldConversationList=function(e){var t=(e=e||{}).count,n=e.type,r=e.startTime,i=e.order;t=t||0,r=r||0,i=i||0;var o=this._codec.getModule(lN);return o.setType(n),o.setCount(t),o.setStartTime(r),o.setOrder(i),o.getArrayData()},e.prototype.encodeRemoveOldConversationList=function(e){var t=(e=e||{}).conversationType,n=e.channelId,r=this._codec.getModule(gN);return r.setType(t),n&&r.setBusChannel([n]),r.getArrayData()},e.prototype.encodeRemoveConversationList=function(e){var t=this,n=this._codec.getModule(dN),r=[];return qy(e,(function(e){var n=e.conversationType,i=e.targetId,o=t._codec.getModule(fN);o.setType(n),o.setChannelId(i),r.push(o)})),n.setSessions(r),n.getArrayData()},e.prototype.encodeDeleteMessages=function(e,t,n,r){var i=this._codec.getModule(vN),o=[];return qy(n,(function(e){o.push({msgId:e.messageUId,msgDataTime:e.sentTime,direct:e.messageDirection})})),i.setType(e),i.setConversationId(t),i.setMsgs(o),i.setBusChannel(r),i.getArrayData()},e.prototype.encodeClearMessages=function(e,t,n,r){var i=this._codec.getModule(yN);return t=t||(new Date).getTime(),i.setDataTime(t),i.setTargetId(e),i.setBusChannel(n),i.setConversationType(r),i.getArrayData()},e.prototype.encodeClearUnreadCount=function(e,t){var n=e.conversationType,r=e.targetId,i=e.channelId,o=t.timestamp,s=this._codec.getModule(mN);return o=o||+new Date,s.setType(n),s.setChannelId(r),s.setMsgTime(o),s.setBusChannel(i),s.getArrayData()},e.prototype.encodeExpandUltraMessage=function(e,t){var n=e.targetId,r=e.conversationType,i=e.channelId,o=e.messageUId,s=e.sendTime,a=e.keys,c={mid:o,put:e.expansion,del:a,clear:e.removeAll?1:0},u=this._codec.getModule(MO);return u.setFromUserId(t),u.setTargetId(n),u.setType(r),u.setBusChannel(i||""),u.setMsgUID(o),u.setMsgTime(s),u.setContent(JSON.stringify(c)),u.getArrayData()},e.prototype.encodemodifyMessage=function(e,t){var n=e.targetId,r=e.conversationType,i=e.channelId,o=e.messageUId,s=e.sendTime,a=e.content,c=this._codec.getModule(MO);return c.setFromUserId(t),c.setTargetId(n),c.setType(r),c.setBusChannel(i||""),c.setMsgUID(o),c.setMsgTime(s),c.setContent(JSON.stringify(a)),c.getArrayData()},e.prototype.encodeQueryMsgChange=function(e){var t=this._codec.getModule(NO);return t.setSyncTime(e),t.getArrayData()},e.prototype.encodeMsgQuery=function(e){var t=e.targetId,n=e.conversationType,r=e.messages,i=this._codec.getModule(AO),o=r.map((function(e){return{msgTime:e.sendTime,msgUID:e.messageUId,busChannel:e.channelId}}));return i.setTargetId(t),i.setType(n),i.setQuery(o),i.getArrayData()},e.prototype.encodeOperateStatus=function(e,t,n,r){var i=this._codec.getModule(LO);return i.setTargetId(e),i.setType(t),i.setBusChannel(n),i.setOpType(r),i.getArrayData()},e.prototype.encodeJoinOrQuitChatRoom=function(){var e=this._codec.getModule(_N);return e.setNothing(1),e.getArrayData()},e.prototype.encodeGetChatRoomInfo=function(e,t){var n=this._codec.getModule(EN);return n.setCount(e),n.setOrder(t),n.getArrayData()},e.prototype.encodeSetUltraGroupDefaultNotificationLevel=function(e,t){var n=this._codec.getModule(dO);return n.setUnpushLevel(e),n.setBusChannel(t),n.getArrayData()},e.prototype.encodeGetUltraGroupDefaultNotificationLevel=function(e){var t=this._codec.getModule(hO);return t.setBusChannel(e),t.getArrayData()},e.prototype.encodeGetFileToken=function(e,t,n,r){var i=this._codec.getModule(BN);return i.setType(e),i.setKey(t),i.setHttpMethod(n),i.setQueryString(r),i.getArrayData()},e.prototype.encodeGetFileUrl=function(e,t,n,r){var i=this._codec.getModule(e);return i.setType(t),i.setKey(n),r&&i.setFileName(r),i.getArrayData()},e.prototype.encodeModifyChatRoomKV=function(e,t,n){var r="comet"===this._connectType,i=this._codec.getModule(YN),o=t.key,s=t.value,a=t.notificationExtra,c=t.isSendNotification,u=t.type,l=t.timestamp,h=u||av.UPDATE,d=em(t,h),f={key:o,value:s||"",uid:n,version:l};if(yg(d)||(f.status=d),i.setEntry(f),c){var p={conversationType:ng.CHATROOM,targetId:e},g={key:o,value:s,extra:a,type:h},v=this._getUpMsgModule(p,{messageType:Xg.CHRM_KV_NOTIFY,content:g,isPersited:!1,isCounted:!1});r?i.setNotification(v.getArrayData()):i.setNotification(v),i.setBNotify(!0),i.setType(ng.CHATROOM)}return i.getArrayData()},e.prototype.encodeModifyChatRoomKVS=function(e,t,n){this._connectType;var r=this._codec.getModule(WN),i=t.entries,o=t.type||av.UPDATE,s=em(t,o),a=[];return i.forEach((function(e){var t={key:e.key,value:e.value||"",uid:n,version:e.timestamp};yg(s)||(t.status=s),a.push(t)})),r.setEntry(a),r.getArrayData()},e.prototype.encodePullChatRoomKV=function(e){var t=this._codec.getModule($N);return t.setTimestamp(e),t.getArrayData()},e.prototype.encodePullUserSetting=function(e){var t=this._codec.getModule(nO);return t.setVersion(e),t.getArrayData()},e.prototype.encodeGetConversationStatus=function(e){var t=this._codec.getModule(oO);return t.setTime(e),t.getArrayData()},e.prototype.encodeSetConversationStatus=function(e){var t=this,n="comet"===this._connectType,r=this._codec.getModule(uO),i=$y.getTime(),o=[];return qy(e,(function(e){var r=t._codec.getModule(aO),s=e.conversationType,a=e.targetId,c=e.notificationStatus,u=e.isTop,l=e.channelId,h=e.notificationLevel,d=[];r.setType(s),r.setChannelId(a),r.setTime(i),r.setBusChannel(l);var f=c===$g.OPEN,p={};yg(c)||(p[Ww]=f),yg(h)||(p[Ww]=h),yg(u)||(p[Qw]=u),qy(p,(function(e,r){if(!yg(e)){var i=t._codec.getModule(cO);e=e?jw:Yw,yg(h)||Number(r)!==Ww||(e=String(h)),i.setSessionStateType(Number(r)),i.setValue(e);var o=n?i.getArrayData():i;d.push(o)}})),r.setStateItem(d);var g=n?r.getArrayData():r;o.push(g)})),r.setVersion(i),r.setState(o),r.getArrayData()},e.prototype.encodeReadReceipt=function(e,t){var n=this._codec.getModule(pO);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},e.prototype.encodeCreateTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(mO),o=[];return e.forEach((function(e){var t=n._codec.getModule(_O);t.setTagId(e.tagId),t.setName(e.tagName),o.push(r?t.getArrayData():t)})),i.setTags(o),i.setVersion(t),i.getArrayData()},e.prototype.encodeMessageReader=function(e,t){var n=this._codec.getModule(pO);return n.setMsgId(e),t&&n.setChannelId(t),n.getArrayData()},e.prototype.encodeRemoveTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(CO),o=[];return e.forEach((function(e){var t=n._codec.getModule(_O);t.setTagId(e),o.push(r?t.getArrayData():t)})),i.setTags(o),i.setVersion(t),i.getArrayData()},e.prototype.encodeDisConversationTag=function(e){var t=this._codec.getModule(EO);return t.setTagId(e),t.getArrayData()},e.prototype.encodeUpdateConversationTag=function(e,t){var n=this,r="comet"===this._connectType,i=this._codec.getModule(uO),o=[];return t.forEach((function(t){var i=n._codec.getModule(aO),s=n._codec.getModule(cO),a=[];e.forEach((function(e){var t=n._codec.getModule(_O);t.setTagId(e.tagId),yg(e.isTop)||t.setIsTop(e.isTop),a.push(r?t.getArrayData():t)})),s.setSessionStateType(Jw),s.setValue(JSON.stringify(a)),s.setTags(a),i.setType(t.conversationType),i.setChannelId(t.targetId),i.setTime(Date.now()),i.setStateItem([r?s.getArrayData():s]),o.push(r?i.getArrayData():i)})),i.setState(o),i.setVersion($y.getTime()),i.getArrayData()},e.prototype.encodeReportSDKInfo=function(e){var t=this._codec.getModule(TO);return t.setSdkInfo(e),t.getArrayData()},e.prototype.encodeUltraGroup=function(e,t){var n=this._codec.getModule(RO);return n.setSyncTime(e),n.setIsEraseMsgContent(t),n.getArrayData()},e.prototype.encodeJoinRTCRoom=function(e,t,n,r,i){var o=this,s="comet"===this._connectType,a=this._codec.getModule(IN);if(e=e||0,a.setRoomType(e),yg(t)||a.setBroadcastType(t),yg(n)||a.setJoinType(n),r){var c=[],u=this._codec.getModule(kN);for(var l in r)u.setKey(l),u.setValue(r[l]),s?c.push(u.getArrayData()):c.push(u);a.setInnerDatas(c)}if(i){var h=[];Object.keys(i).forEach((function(e){var t=o._codec.getModule(kN);t.setKey(e),t.setValue(i[e]),s?h.push(t.getArrayData()):h.push(t)})),a.setOuterDatas(h)}return a.getArrayData()},e.prototype.encodeQuitRTCRoom=function(){return this._codec.getModule(SN).getArrayData()},e.prototype.encodeSetRTCData=function(e,t,n,r,i){var o=this._codec.getModule(MN);if(o.setInterior(n),o.setTarget(r),o.setKey(e),o.setValue(t),i){i.name&&o.setObjectName(i.name);var s=i.content;s&&(gg(s)&&(s=JSON.stringify(s)),o.setContent(s))}return o.getArrayData()},e.prototype.encodeUserSetRTCData=function(e,t,n,r){var i=this,o="comet"===this._connectType,s=this._codec.getModule(NN);s.setObjectName(n);var a=this._codec.getModule(kN);a.setKey(e.name),a.setValue(e.content),o?s.setContent(a.getArrayData()):s.setContent(a);var c=[];return["uris","mcu_uris"].forEach((function(e){var n=i._codec.getModule(kN);n.setKey(e);var s="uris"===e?t:r;n.setValue(s),o?c.push(n.getArrayData()):c.push(n)})),s.setValueInfo(c),s.getArrayData()},e.prototype.encodeUserSetRTCCDNUris=function(e,t){this._connectType;var n=this._codec.getModule(NN);n.setObjectName(e);var r=this._codec.getModule(kN);return r.setKey("cdn_uris"),r.setValue(t),n.setValueInfo(r),n.getArrayData()},e.prototype.encodeGetRTCData=function(e,t,n){var r=this._codec.getModule(ON);return r.setInterior(t),r.setTarget(n),r.setKey(e),r.getArrayData()},e.prototype.encodeRemoveRTCData=function(e,t,n,r){var i=this._codec.getModule(ON);i.setInterior(t),i.setTarget(n),i.setKey(e);var o=(r=r||{}).name,s=r.content;return!yg(o)&&i.setObjectName(o),yg(s)||(gg(s)&&(s=JSON.stringify(s)),i.setContent(s)),i.getArrayData()},e.prototype.encodeSetRTCOutData=function(e,t,n){var r=this._codec.getModule(wN);r.setTarget(t),dg(e)||(e=[e]),qy(e,(function(t,n){t.key=t.key?t.key.toString():t.key,t.value=t.value?t.value.toString():t.value,e[n]=t})),r.setValueInfo(e);var i=(n=n||{}).name,o=n.content;return!yg(i)&&r.setObjectName(i),yg(o)||(gg(o)&&(o=JSON.stringify(o)),r.setContent(o)),r.getArrayData()},e.prototype.ecnodeGetRTCOutData=function(e){var t=this._codec.getModule(LN);return t.setUserId(e),t.getArrayData()},e.prototype.encodeSetRTCState=function(e){var t=this._codec.getModule(AN);return t.setState(e),t.getArrayData()},e.prototype.encodeGetRTCRoomInfo=function(){var e=this._codec.getModule(DN);return e.setOrder(2),e.getArrayData()},e.prototype.encodeSetRTCUserInfo=function(e,t){var n=this._codec.getModule(kN);return n.setKey(e),n.setValue(t),n.getArrayData()},e.prototype.encodeRemoveRTCUserInfo=function(e){var t=this._codec.getModule(VN);return t.setKey(e),t.getArrayData()},e.prototype.encodeIdentityChangeInfo=function(e,t,n){void 0===n&&(n=!1);var r=this._codec.getModule(IN);return r.setRoomType(dv.LIVE),t&&r.setBroadcastType(t),r.setIdentityChangeType(e),r.setNeedSysChatroom(n),r.getArrayData()},e.prototype.encodePullRTCRoomKV=function(e,t){var n=this._codec.getModule(VO);return n.setTimestamp(t),n.setRoomId(e),n.getArrayData()},e.prototype.encodeQueryUserJoinedInfo=function(e){var t=this._codec.getModule(GO);return t.setUserId(e),t.getArrayData()},e.prototype.encodeRequestRoomPK=function(e){var t=e.invitedRoomId,n=e.invitedUserId,r=e.inviteSessionId,i=e.inviteTimeout,o=e.inviteInfo,s=this._codec.getModule(qO);return s.setInvitedRoomId(t),s.setInvitedUserId(n),s.setInviteSessionId(r),s.setTimeoutTime(i),s.setInviteInfo(o),s.getArrayData()},e.prototype.encodeCancelRoomPK=function(e){var t=e.invitedRoomId,n=e.invitedUserId,r=e.inviteSessionId,i=e.inviteInfo,o=this._codec.getModule(HO);return o.setInvitedRoomId(t),o.setInvitedUserId(n),o.setInviteSessionId(r),o.setInviteInfo(i),o.getArrayData()},e.prototype.encodeResponseRoomPK=function(e){var t=e.inviteUserId,n=e.inviteRoomId,r=e.inviteSessionId,i=e.content,o=e.key,s=e.value,a=e.agree?1:0,c=this._codec.getModule(jO);return c.setInviteUserId(t),c.setInviteRoomId(n),c.setInviteSessionId(r),c.setContent(i),c.setKey(o),c.setValue(s),c.setAnswerCode(a),c.getArrayData()},e.prototype.encodeEndRoomPK=function(e){var t=e.endRoomId,n=e.sessionId,r=e.content,i=e.keys,o=this._codec.getModule(YO);return o.setInviteRoomId(t),o.setInviteSessionId(n),o.setInviteContent(r),o.setInviteRoomKeys(i),o.getArrayData()},e.prototype.encodebindRTCRoomForChatroom=function(e){var t=this._codec.getModule(WO);return t.setRtcRoomId(e.rtcRoomId),t.getArrayData()},e}(),Xw=function(e,t){this._watcher=t,this.codec=new zw(e)};!function(e){e.GET="GET",e.POST="POST"}(_w||(_w={})),function(e){e.WIFI="wifi",e.FOUR_G="4g",e.THREE_G="3g",e.TWO_G="2g",e.FIVE_G="2g",e.THREE_GENT="3gnet",e.UNKONWN="unknown"}(Cw||(Cw={}));var Zw=function(e,t){return e&&t?t+"_"+e:e||Date.now()},$w=function(){function e(e){this.header=e,this._name=null,this.lengthSize=0,this.messageId=0,this.timestamp=0,this.syncMsg=!1,this.identifier=""}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return Zw(e,t)},e.prototype.read=function(e,t,n){this.readMessage(e,t,n)},e.prototype.readMessage=function(e,t,n){return{stream:e,length:t}},e}(),eA=function(){function e(e){this.lengthSize=0,this.messageId=0,this.topic="",this.targetId="",this.identifier="",this._header=new JM(e,!1,PM.AT_MOST_ONCE,!1)}return e.prototype.getIdentifier=function(){var e=this.messageId,t=this.identifier;return Zw(e,t)},e.prototype.write=function(e){var t=this.getHeaderFlag();e.write(t),this.writeMessage(e)},e.prototype.setHeaderQos=function(e){this._header.qos=e},e.prototype.getHeaderFlag=function(){return this._header.encode()},e.prototype.getLengthSize=function(){return this.lengthSize},e.prototype.getBufferData=function(){var e=new ZM;this.write(e);var t=e.getBytesArray();return new Int8Array(t)},e.prototype.getCometData=function(){var e=this.data||{};return JSON.stringify(e)},e}(),tA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=xM.CONN_ACK,t.status=null,t.userId=null,t.timestamp=0,t}return ua(t,e),t.prototype.readMessage=function(e,n,r){if(e.readByte(),this.status=+e.readByte(),n<=t.MESSAGE_LENGTH)return{stream:e,length:n};if(r===VM.V4){var i=e.readByte();1&i&&(this.userId=e.readUTF()),2&i&&e.readUTF(),4&i&&(this.timestamp=e.readLong()),8&i&&(this.messageId=e.read2Byte())}else{this.userId=e.readUTF();var o=e.readUTF();Mg.debug("server sessionId -> "+o),this.timestamp=e.readLong()}return{stream:e,length:n}},t.MESSAGE_LENGTH=2,t}($w),nA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=xM.DISCONNECT,t.status=0,t}return ua(t,e),t.prototype.readMessage=function(e,t){return e.readByte(),this.status=+e.readByte(),{stream:e,length:t}},t.MESSAGE_LENGTH=2,t}($w),rA=function(e){function t(){var t=e.call(this,DM.PING_REQ)||this;return t._name=xM.PING_REQ,t}return ua(t,e),t.prototype.writeMessage=function(e){},t}(eA),iA=function(e){function t(t){var n=e.call(this,t)||this;return n._name=xM.PING_RESP,n}return ua(t,e),t}($w),oA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageId=0,t}return ua(t,e),t.prototype.readMessage=function(e,t){var n=256*e.readByte()+e.readByte();return this.messageId=parseInt(n.toString(),10),{stream:e,length:t}},t}($w),sA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.messageId=0,t}return ua(t,e),t.prototype.writeMessage=function(e){var t=this.messageId,n=255&t,r=(65280&t)>>8;e.write(r),e.write(n)},t}(eA),aA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=xM.PUBLISH,t.topic="",t.targetId="",t.syncMsg=!1,t.identifier=kM.PUB,t}return ua(t,e),t.prototype.readMessage=function(t,n){return this.date=t.readInt(),this.topic=t.readUTF(),this.targetId=t.readUTF(),e.prototype.readMessage.call(this,t,n),this.data=t.readAll(),{stream:t,length:n}},t}(oA),cA=function(e){function t(t,n,r){var i=e.call(this,DM.PUBLISH)||this;return i._name=xM.PUBLISH,i.syncMsg=!1,i.identifier=kM.PUB,i.topic=t,i.data=ug(n)?zM.writeUTF(n):n,i.targetId=r,i}return ua(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(sA),uA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=xM.PUB_ACK,t.status=0,t.date=0,t.millisecond=0,t.messageUId="",t.timestamp=0,t.identifier=kM.PUB,t.topic="",t.targetId="",t}return ua(t,e),t.prototype.readMessage=function(t,n){return e.prototype.readMessage.call(this,t,n),this.date=t.readInt(),this.status=256*t.readByte()+t.readByte(),this.millisecond=256*t.readByte()+t.readByte(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=t.readUTF(),{stream:t,length:n}},t}(oA),lA=function(e){function t(t){var n=e.call(this,DM.PUB_ACK)||this;return n._name=xM.PUB_ACK,n.status=0,n.date=0,n.millisecond=0,n.messageUId="",n.timestamp=0,n.messageId=t,n}return ua(t,e),t.prototype.writeMessage=function(t){e.prototype.writeMessage.call(this,t)},t}(sA),hA=function(e){function t(t,n,r){var i=e.call(this,DM.QUERY)||this;return i.name=xM.QUERY,i.identifier=kM.QUERY,i.topic=t,i.data=ug(n)?zM.writeUTF(n):n,i.targetId=r,i}return ua(t,e),t.prototype.writeMessage=function(t){t.writeUTF(this.topic),t.writeUTF(this.targetId),e.prototype.writeMessage.call(this,t),t.write(this.data)},t}(sA),dA=function(e){function t(t){var n=e.call(this,DM.QUERY_CONFIRM)||this;return n._name=xM.QUERY_CON,n.messageId=t,n}return ua(t,e),t}(sA),fA=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name=xM.QUERY_ACK,t.status=0,t.identifier=kM.QUERY,t.topic="",t.targetId="",t}return ua(t,e),t.prototype.readMessage=function(t,n){return e.prototype.readMessage.call(this,t,n),this.date=t.readInt(),this.status=256*t.readByte()+t.readByte(),this.data=t.readAll(),{stream:t,length:n}},t}(oA),pA=function(e){var t,n=e.type;switch(n){case DM.CONN_ACK:t=new tA(e);break;case DM.PUBLISH:(t=new aA(e)).syncMsg=e.syncMsg;break;case DM.PUB_ACK:t=new uA(e);break;case DM.QUERY_ACK:t=new fA(e);break;case DM.SUB_ACK:case DM.UNSUB_ACK:case DM.PING_RESP:t=new iA(e);break;case DM.DISCONNECT:t=new nA(e);break;default:t=new $w(e),Mg.error("No support for deserializing "+n+" messages")}return t},gA=bo.charAt,vA=ui,yA=An,mA=jm,_A="String Iterator",CA=yA.set,EA=yA.getterFor(_A);mA(String,"String",(function(e){CA(this,{type:_A,string:vA(e),index:0})}),(function(){var e,t=EA(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=gA(n,r),t.index+=e.length,{value:e,done:!1})}));var TA,IA=Qr,RA=R,SA=ye,MA=Pe,NA=or,OA=ui,wA=o,AA=BR,UA=kc,bA=FR,LA=KR,PA=te,DA=HR,xA=[],kA=RA(xA.sort),VA=RA(xA.push),BA=wA((function(){xA.sort(void 0)})),GA=wA((function(){xA.sort(null)})),FA=UA("sort"),KA=!wA((function(){if(PA)return PA<70;if(!(bA&&bA>3)){if(LA)return!0;if(DA)return DA<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)xA.push({k:t+r,v:n})}for(xA.sort((function(e,t){return t.v-e.v})),r=0;r<xA.length;r++)t=xA[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));IA({target:"Array",proto:!0,forced:BA||!GA||!FA||!KA},{sort:function(e){void 0!==e&&SA(e);var t=MA(this);if(KA)return void 0===e?kA(t):kA(t,e);var n,r,i=[],o=NA(t);for(r=0;r<o;r++)r in t&&VA(i,t[r]);for(AA(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:OA(t)>OA(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<o;)delete t[r++];return t}}),function(e){e[e.ppMsgP=1]="ppMsgP",e[e.ppMsgN=2]="ppMsgN",e[e.ppMsgS=3]="ppMsgS",e[e.pgMsgP=4]="pgMsgP",e[e.chatMsg=5]="chatMsg",e[e.pcMsgP=6]="pcMsgP",e[e.qryPMsg=7]="qryPMsg",e[e.qryGMsg=8]="qryGMsg",e[e.qryCHMsg=9]="qryCHMsg",e[e.qryCMsg=10]="qryCMsg",e[e.qrySMsg=11]="qrySMsg",e[e.recallMsg=12]="recallMsg",e[e.prMsgS=13]="prMsgS",e[e.rrMsg=14]="rrMsg",e[e.rrList=15]="rrList",e[e.s_ntf=16]="s_ntf",e[e.s_msg=17]="s_msg",e[e.s_stat=18]="s_stat",e[e.s_cmd=19]="s_cmd",e[e.s_us=20]="s_us",e[e.pullUS=21]="pullUS",e[e.pgMsgS=22]="pgMsgS",e[e.chatMsgS=23]="chatMsgS",e[e.qrySessionsAtt=24]="qrySessionsAtt",e[e.pullMsg=25]="pullMsg",e[e.qrySessions=26]="qrySessions",e[e.delSessions=27]="delSessions",e[e.delMsg=28]="delMsg",e[e.updRRTime=29]="updRRTime",e[e.chrmPull=30]="chrmPull",e[e.joinChrm=31]="joinChrm",e[e.joinChrmR=32]="joinChrmR",e[e.exitChrm=33]="exitChrm",e[e.queryChrmI=34]="queryChrmI",e[e.setKV=35]="setKV",e[e.delKV=36]="delKV",e[e.pullKV=37]="pullKV",e[e.qryRelation=38]="qryRelation",e[e.delRelation=39]="delRelation",e[e.pullSeAtts=40]="pullSeAtts",e[e.setSeAtt=41]="setSeAtt",e[e.qnTkn=42]="qnTkn",e[e.qnUrl=43]="qnUrl",e[e.aliUrl=44]="aliUrl",e[e.s3Url=45]="s3Url",e[e.stcUrl=46]="stcUrl",e[e.cleanPMsg=47]="cleanPMsg",e[e.cleanGMsg=48]="cleanGMsg",e[e.cleanCMsg=49]="cleanCMsg",e[e.cleanSMsg=50]="cleanSMsg",e[e.rtcRJoin_data=51]="rtcRJoin_data",e[e.rtcRExit=52]="rtcRExit",e[e.rtcPing=53]="rtcPing",e[e.rtcSetData=54]="rtcSetData",e[e.rtc_ntf=55]="rtc_ntf",e[e.viewerJoinR=56]="viewerJoinR",e[e.viewerExitR=57]="viewerExitR",e[e.rtcPullKv=58]="rtcPullKv",e[e.rtcIdentityChange=59]="rtcIdentityChange",e[e.userSetData=60]="userSetData",e[e.rtcQryData=61]="rtcQryData",e[e.rtcDelData=62]="rtcDelData",e[e.rtcSetOutData=63]="rtcSetOutData",e[e.rtcQryUserOutData=64]="rtcQryUserOutData",e[e.rtcToken=65]="rtcToken",e[e.rtcUserState=66]="rtcUserState",e[e.rtcRInfo=67]="rtcRInfo",e[e.rtcUData=68]="rtcUData",e[e.rtcUPut=69]="rtcUPut",e[e.rtcUDel=70]="rtcUDel",e[e.rtcUList=71]="rtcUList",e[e.rtcQueryJoined=72]="rtcQueryJoined",e[e.rtcInvite=73]="rtcInvite",e[e.rtcCancelInvite=74]="rtcCancelInvite",e[e.rtcInviteAnswer=75]="rtcInviteAnswer",e[e.rtcEndInvite=76]="rtcEndInvite",e[e.addSeTag=77]="addSeTag",e[e.delSeTag=78]="delSeTag",e[e.addTag=79]="addTag",e[e.delTag=80]="delTag",e[e.disTag=81]="disTag",e[e.reportsdk=82]="reportsdk",e[e.pullUgSes=83]="pullUgSes",e[e.pullUgMsg=84]="pullUgMsg",e[e.ugMsg=85]="ugMsg",e[e.qryUgMsg=86]="qryUgMsg",e[e.updUgRTime=87]="updUgRTime",e[e.upMsgEx=88]="upMsgEx",e[e.modifyMsg=89]="modifyMsg",e[e.qryMsgChange=90]="qryMsgChange",e[e.qryMsg=91]="qryMsg",e[e.operate=92]="operate",e[e.s_opNtf=93]="s_opNtf",e[e.ugUnpushQuery=94]="ugUnpushQuery",e[e.ugUnpushSet=95]="ugUnpushSet",e[e.setRtcRoomId=96]="setRtcRoomId"}(TA||(TA={}));var qA,HA,jA=TA,YA=function(e,t,n,r,i,o,s,a){return"".concat(e,"://").concat(t,"/websocket?appId=").concat(n,"&token=").concat(encodeURIComponent(r),"&sdkVer=").concat(o,"&pid=").concat(s,"&apiVer=").concat(i.isFromUniapp?"uniapp":"normal").concat(i.connectPlatform?"&platform="+i.connectPlatform:"").concat(a?"&protocolVer="+a:"")},WA=function(e){return[jA.ppMsgS,jA.pgMsgS,jA.chatMsgS].map((function(e){return jA[e]})).indexOf(e)>=0};!function(e){e[e.REDIRECT=0]="REDIRECT",e[e.OTHER_DEVICE_LOGIN=1]="OTHER_DEVICE_LOGIN",e[e.BLOCK=2]="BLOCK",e[e.REMOTE_CLOSE=3]="REMOTE_CLOSE",e[e.LOGOUT=4]="LOGOUT",e[e.BLOCK_NEW=5]="BLOCK_NEW",e[e.REDIRECT_NEW=6]="REDIRECT_NEW"}(qA||(qA={})),function(e){e.IM_NAVI="IM-stats_navi-S",e.IM_WEBSOCKET="IM-stats_websocket-S",e.IM_COMET="IM-stats_comet-S",e.IM_CONNECTION_DURATION="IM-stats_con_dur-S"}(HA||(HA={}));var QA=function(e,t){Mg.info("websocket send -> messageId: ".concat(e.messageId," topic: ").concat(e.topic));var n=e.getBufferData();t.send(n.buffer)};var JA=function(e){function t(t,n){var r=e.call(this,"websocket",n)||this;return r._runtime=t,r._socket=null,r._messageIds={},r._syncMessageIds={},r._failedCount=0,r.ALLOW_FAILED_TIMES=2,r._timer=null,r._idCount=0,r._generateMessageId=function(){return r._idCount>=65535&&(r._idCount=0),++r._idCount},r}return ua(t,e),t.prototype.connect=function(e,t,n,r,i,o){return ha(this,void 0,void 0,(function(){var s=this;return da(this,(function(a){return[2,new Promise((function(a){var c=n.slice(),u=!1;i=Qc(i),s._watcher.status(Qg.CONNECTING),function n(){return ha(s,void 0,void 0,(function(){var s,l,h;return da(this,(function(d){switch(d.label){case 0:return 0===c.length||u?[2]:(u=!0,s=c.shift(),Mg.setStatisticsData(HA.IM_WEBSOCKET,{startTime:(new Date).getTime(),host:s,protocol:sg.WS}),[4,this._connect(e,t,s,r,i,o)]);case 1:if(l=d.sent(),h=l===Yg.SUCCESS||l===Jg.REDIRECT?l:Jy(l),Mg.setStatisticsData(HA.IM_WEBSOCKET,{endTime:(new Date).getTime(),code:h}),function(e){ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d,f,p,g;return da(this,(function(v){switch(v.label){case 0:t=HA.IM_WEBSOCKET,n=Mg.getStatisticsBaseData(),r=n.sdkPrivate,i=n.serverPrivate,o=n.bundleId,s=Mg.getStatisticsData(t),a=s.protocol,c=s.startTime,u=s.endTime,l=s.code,h=s.host,d=Cw.UNKONWN,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,e.getNetworkType()];case 2:return d=v.sent(),[3,4];case 3:return f=v.sent(),Mg.info(f.message),[3,4];case 4:return p=0,hg(c)&&hg(u)&&u>c&&c&&(p=u-c),g={spr:r,pr:i,bid:o,ptc:a,dur:p,cod:l,hos:h,net:d},Mg.reportStatisticsLog(t,g),[2]}}))}))}(this._runtime),l===Yg.SUCCESS)this._checkAlive(),a(l);else if(l===Jg.REDIRECT)a(l);else{if(0===c.length)return a(Jy(l)),[2];u=!1,n()}return[2]}}))}))}()}))]}))}))},t.prototype._connect=function(e,t,n,r,i,o){return ha(this,void 0,void 0,(function(){var s,a,c,u,l,h=this;return da(this,(function(d){switch(d.label){case 0:return s=r.replace("http","ws"),a=YA(s,n,e,t,this._runtime,i,"",o),Mg.info("conenct start -> ".concat(a)),this.sendConnectTime=Date.now(),c=this._runtime.createWebSocket(a),u=function(e){h._timer&&(clearTimeout(h._timer),h._timer=null),h._socket===c&&(h._socket=null,h._watcher.status(e))},[4,new Promise((function(e){c.onMessage((function(t){if("[object ArrayBuffer]"===Object.prototype.toString.call(t)){var n=function(e,t){var n=new Uint8Array(e),r=new XM(n),i=r.readByte(),o=new JM(i),s=pA(o);return s.read(r,n.length-1,t),s}(t,o);if(n instanceof iA&&h._pingResolve)return h._pingResolve(Yg.SUCCESS),void(h._pingResolve=void 0);if(n instanceof tA)return Mg.info("recv connect ack -> ".concat(n.status)),n.status!==Jg.ACCEPTED?(Mg.warn("connect failed: ".concat(n.status)),void e(n.status)):(Mg.info("connect success -> ".concat(a)),h.connectedTime=n.timestamp,h.userId=n.userId||"",h._idCount=n.messageId,void e(Yg.SUCCESS));if(n instanceof nA){var r=n.status;switch(Mg.warn("recv disconnect signal -> status: ".concat(r)),r){case qA.BLOCK_NEW:case qA.BLOCK:h._watcher.status(Qg.BLOCKED);break;case qA.OTHER_DEVICE_LOGIN:h._watcher.status(Qg.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case qA.REDIRECT_NEW:case qA.REDIRECT:h._watcher.status(Qg.REDIRECT);break;default:h._watcher.status(Qg.DISCONNECT_BY_SERVER)}}else h._onReceiveSignal(n)}else Mg.error("Socket received invalid data:",t)})),c.onClose((function(t,n){for(var r in Mg.warn("websocket closed! code:",t,"reason:",n),u(Qg.CONNECTION_CLOSED),h._messageIds){var i=h._messageIds[r];delete h._messageIds[r],i(Yg.RC_NET_CHANNEL_INVALID)}e(t)})),c.onError((function(t){for(var n in Mg.error("websocket error!",null==t?void 0:t.stack),u(Qg.WEBSOCKET_ERROR),h._messageIds){var r=h._messageIds[n];delete h._messageIds[n],r(Yg.RC_NET_CHANNEL_INVALID)}e(Yg.NETWORK_ERROR)})),c.onOpen((function(){return Mg.info("websocket open =>",a)})),setTimeout((function(){e(Yg.TIMEOUT)}),Js)}))];case 1:return(l=d.sent())===Yg.SUCCESS?this._socket=c:(Mg.warn("connect result -> code: ".concat(l,", url: ").concat(a)),c.close()),[2,l]}}))}))},t.prototype._checkAlive=function(){var e;return ha(this,void 0,void 0,(function(){var t,n=this;return da(this,(function(r){switch(r.label){case 0:return this._socket?(Mg.info("send ping ->"),this.sendOnly(new rA),[4,new Promise((function(e){n._pingResolve=e,n._timer&&clearTimeout(n._timer),n._timer=setTimeout((function(){n._pingResolve=void 0,e(Yg.TIMEOUT)}),15e3)}))]):[2];case 1:return(t=r.sent())!==Yg.SUCCESS?(this._failedCount+=1,Mg.warn("ping failed count: ".concat(this._failedCount,", code: ").concat(t)),this._failedCount>=this.ALLOW_FAILED_TIMES?(this._failedCount=0,Mg.warn("ping timeout, close current websocket to reconnect!"),null===(e=this._socket)||void 0===e||e.close(),this._socket=null,this._watcher.status(Qg.NETWORK_UNAVAILABLE)):this._checkAlive(),[2]):(Mg.info("recv pong <-"),this._failedCount=0,setTimeout((function(){return n._checkAlive()}),15e3),[2])}}))}))},t.prototype._onReceiveSignal=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a=this;return da(this,(function(c){switch(c.label){case 0:return t=e.messageId,e.header&&e.header.qos!==PM.AT_MOST_ONCE&&(e instanceof aA&&!e.syncMsg&&(Mg.info("send pubAck -> ".concat(t," ").concat(e.topic)),this.sendOnly(new lA(t))),e instanceof fA&&(Mg.info("send queryCon -> ".concat(t," ").concat(e.topic)),this.sendOnly(new dA(t)))),t>0&&(e instanceof uA||e instanceof fA)&&(Mg.info("recv ack -> messageId: ".concat(t," ").concat(e.topic)),(n=this._messageIds[t])&&(n(e),delete this._messageIds[t]),(r=this._syncMessageIds[t])&&(delete this._syncMessageIds[t],r(e))),e instanceof aA?(i=e.syncMsg,o=e.topic,Mg.info("recv PublishReader -> messageId: ".concat(t," ").concat(o)),o===jA[jA.userSetData]?[2]:!i||WA(o)?(this._watcher.signal(e),[2]):[4,new Promise((function(e){a._syncMessageIds[t]=e}))]):[3,2];case 1:s=c.sent(),delete this._syncMessageIds[t],this._watcher.signal(e,s),c.label=2;case 2:return[2]}}))}))},t.prototype.sendOnly=function(e){this._socket&&((e instanceof cA||e instanceof hA)&&(e.messageId=this._generateMessageId()),QA(e,this._socket))},t.prototype.send=function(e,t,n,r){return void 0===r&&(r=$s),ha(this,void 0,void 0,(function(){var i,o,s,a,c=this;return da(this,(function(u){switch(u.label){case 0:return this._socket?(i=this._generateMessageId(),e.messageId=i,QA(e,this._socket),[4,new Promise((function(e){c._messageIds[i]=e,setTimeout((function(){c._messageIds[i]&&delete c._messageIds[i],e()}),r)}))]):[3,2];case 1:return(o=u.sent())?o instanceof fA||o instanceof uA?(s=t&&o.data&&[Yg.SUCCESS,Yg.CHATROOM_KV_STORE_NOT_ALL_SUCCESS].indexOf(o.status)>=0,a=s?this.codec.decodeByPBName(o.data,t,n):o,0!==o.status?(Mg.warn("send failed -> message: ".concat(i,", respPBName: ").concat(t,", status: ").concat(o.status)),[2,{code:o.status,data:t&&o.data?a:null}]):[2,{code:Yg.SUCCESS,data:a}]):[2,{code:o}]:(Mg.warn("send timeout -> message: ".concat(i,", respPBName: ").concat(t,", timeout: ").concat(r)),[2,{code:Yg.TIMEOUT}]);case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.close=function(){this._socket&&(this._socket.close(),this._socket=null,this._watcher.status(Qg.DISCONNECTED))},t}(Xw);var zA=function(e){function t(t,n){var r=e.call(this,"comet",n)||this;return r._runtime=t,r._messageIds={},r._syncMessageIds={},r._idCount=0,r._generateMessageId=function(){return++r._idCount},r._pid=encodeURIComponent((new Date).getTime()+Math.random()+""),r}return ua(t,e),t.prototype.handleCometRes=function(e){var t=this;if(200!==e.status&&202!==e.status)return!1;var n=ug(e.data)?JSON.parse(e.data):e.data;return n?!dg(n)||(qy(n,(function(e){return ha(t,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d=this;return da(this,(function(f){switch(f.label){case 0:if((t=e.sessionid)&&(this._sessionid=t),n=function(e){var t=e.headerCode,n=new JM(t),r=pA(n);for(var i in e)r[i]=e[i];return r}(e),r=n.messageId,i=n._header,o=n.status,s=i&&i.qos!==PM.AT_MOST_ONCE,r&&n.getIdentifier&&((a=this._messageIds[r])&&a(n),this._syncMessageIds[r]&&this._syncMessageIds[r](n)),s&&(n instanceof aA&&!n.syncMsg&&(c=new lA(r),this.sendOnly(c)),n instanceof fA&&(c=new dA(r),this.sendOnly(c))),n instanceof nA){switch(o){case qA.OTHER_DEVICE_LOGIN:this._watcher.status(Qg.KICKED_OFFLINE_BY_OTHER_CLIENT);break;case qA.BLOCK:case qA.BLOCK_NEW:this._watcher.status(Qg.BLOCKED);break;case qA.REDIRECT_NEW:case qA.REDIRECT:this._watcher.status(Qg.REDIRECT);break;default:this._watcher.status(Qg.DISCONNECT_BY_SERVER)}return[2]}return n instanceof aA?(u=n.syncMsg,l=n.topic,!u||WA(l)?(this._watcher.signal(n),[2,!1]):[4,new Promise((function(e){d._syncMessageIds[r]=e}))]):[3,2];case 1:h=f.sent(),delete this._syncMessageIds[r],this._watcher.signal(n,h),f.label=2;case 2:return[2]}}))}))})),!0):(Mg.error("received data is not a validJson",n),!1)},t.prototype._startPullSignal=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i;return da(this,(function(o){switch(o.label){case 0:return t=(new Date).getTime(),n="".concat(e,"://").concat(this._domain,"/pullmsg.js?sessionid=").concat(this._sessionid,"&timestrap=").concat(t,"&pid=").concat(this._pid),[4,this._runtime.httpReq({url:n,body:{pid:this._pid},timeout:45e3})];case 1:return r=o.sent(),i=this.handleCometRes(r),this._isDisconnected||(i?this._startPullSignal(e):(this._isDisconnected=!0,this._watcher.status(Qg.NETWORK_UNAVAILABLE))),[2]}}))}))},t.prototype.connect=function(e,t,n,r,i,o){return ha(this,void 0,void 0,(function(){var o,s,a=this;return da(this,(function(c){return i=Qc(i),this._protocol=r,this._isDisconnected=!1,this._watcher.status(Qg.CONNECTING),o=n.slice(),s=!1,[2,new Promise((function(n){a._watcher.status(Qg.CONNECTING),function c(){return ha(a,void 0,void 0,(function(){var a,u,l;return da(this,(function(h){switch(h.label){case 0:return 0===o.length||s?[2]:(s=!0,a=o.shift(),Mg.setStatisticsData(HA.IM_COMET,{startTime:(new Date).getTime(),host:a,protocol:sg.NAVI}),[4,this._connect(e,t,a,r,i)]);case 1:if(u=h.sent(),l=u===Yg.SUCCESS||u===Jg.REDIRECT?u:Jy(u),Mg.setStatisticsData(HA.IM_COMET,{endTime:(new Date).getTime(),code:l}),function(e){ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d,f,p,g;return da(this,(function(v){switch(v.label){case 0:t=HA.IM_COMET,n=Mg.getStatisticsBaseData(),r=n.sdkPrivate,i=n.serverPrivate,o=n.bundleId,s=Mg.getStatisticsData(t),a=s.protocol,c=s.startTime,u=s.endTime,l=s.code,h=s.host,d=Cw.UNKONWN,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,e.getNetworkType()];case 2:return d=v.sent(),[3,4];case 3:return f=v.sent(),Mg.info(f.message),[3,4];case 4:return p=0,hg(c)&&hg(u)&&u>c&&c&&(p=u-c),g={spr:r,pr:i,bid:o,ptc:a,dur:p,cod:l,hos:h,net:d},Mg.reportStatisticsLog(t,g),[2]}}))}))}(this._runtime),u===Yg.SUCCESS)this._startPullSignal(r),n(u);else if(u===Jg.REDIRECT)n(u);else{if(0===o.length)return n(Jy(u)),[2];s=!1,c()}return[2]}}))}))}()}))]}))}))},t.prototype._connect=function(e,t,n,r,i){return ha(this,void 0,void 0,(function(){var o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return o=function(e){return 200!==e.status&&202!==e.status?(Mg.error("handle comet res -> res: ".concat(JSON.stringify(e||{}))),!1):!!e.data&&(function(e){if(gg(e))return!0;var t=!1;try{var n=JSON.parse(e);t=JSON.stringify(n)===e}catch(e){t=!1}return t}(e.data)?gg(e.data)?e.data:JSON.parse(e.data):(Mg.error("received data is not a validJson",e.data),!1))},s=YA(r,n,e,t,this._runtime,i,this._pid),this.sendConnectTime=Date.now(),Mg.info("conenct start -> ".concat(s)),[4,this._runtime.httpReq({url:s,body:{pid:this._pid},timeout:Js})];case 1:return a=u.sent(),c=o(a),this._domain=n,c&&0===c.status?(this._sessionid=c.sessionid,this.userId=c.userId,this.connectedTime=c.timestamp,Mg.info("connect success -> userId: ".concat(c.userId,", url: ").concat(s))):Mg.warn("connect result -> code: ".concat(null==c?void 0:c.status,", url: ").concat(s)),[2,null==c?void 0:c.status]}}))}))},t.prototype.sendCometData=function(e,t){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:return n=(t=this)._domain,r=t._sessionid,i=t._pid,o=e.messageId,s=e.topic,a=e.targetId,c=e.getHeaderFlag(),u=s?"".concat(this._protocol,"://").concat(n,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(r,"&topic=").concat(s,"&targetid=").concat(a,"&pid=").concat(i):"".concat(this._protocol,"://").concat(n,"/websocket?messageid=").concat(o,"&header=").concat(c,"&sessionid=").concat(r,"&pid=").concat(i),[4,this._runtime.httpReq({url:u,method:_w.POST,body:e.getCometData()})];case 1:return l=h.sent(),this.handleCometRes(l),[2]}}))}))},t.prototype.sendOnly=function(e){this.sendCometData(e)},t.prototype.send=function(e,t,n,r){return void 0===r&&(r=$s),ha(this,void 0,void 0,(function(){var i,o,s,a,c=this;return da(this,(function(u){switch(u.label){case 0:return i=this._generateMessageId(),e.messageId=i,this.sendCometData(e),[4,new Promise((function(e){c._messageIds[i]=e,setTimeout((function(){delete c._messageIds[i],e()}),r)}))];case 1:return(o=u.sent())?(s=t&&o.data&&[Yg.SUCCESS,Yg.CHATROOM_KV_STORE_NOT_ALL_SUCCESS].indexOf(o.status)>=0,a=s?this.codec.decodeByPBName(o.data,t,n):o,0!==o.status?[2,{code:o.status,data:t&&o.data?a:null}]:[2,{code:Yg.SUCCESS,data:a}]):[2,{code:Yg.TIMEOUT}]}}))}))},t.prototype.close=function(){this._isDisconnected=!0,this._watcher.status(Qg.DISCONNECTED)},t}(Xw),XA=Qr,ZA=Mc.find,$A=au,eU="find",tU=!0;eU in[]&&Array(1).find((function(){tU=!1})),XA({target:"Array",proto:!0,forced:tU},{find:function(e){return ZA(this,e,arguments.length>1?arguments[1]:void 0)}}),$A(eU);var nU=function(e){return["navi",e].join("_")};function rU(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d,f,p,g;return da(this,(function(v){switch(v.label){case 0:t=HA.IM_NAVI,n=Mg.getStatisticsBaseData(),r=n.sdkPrivate,i=n.serverPrivate,o=n.bundleId,s=Mg.getStatisticsData(t),a=s.protocol,c=s.startTime,u=s.endTime,l=s.code,h=s.host,d=Cw.UNKONWN,v.label=1;case 1:return v.trys.push([1,3,,4]),[4,e.getNetworkType()];case 2:return d=v.sent(),[3,4];case 3:return f=v.sent(),Mg.debug(f.message),[3,4];case 4:return p=0,hg(c)&&hg(u)&&u>c&&c&&(p=u-c),g={spr:r,pr:i,bid:o,ptc:a,dur:p,cod:l,hos:h,net:d},Mg.reportStatisticsLog(t,g),[2]}}))}))}var iU=function(){function e(e,t,n){this.runtime=e,this._watcher=t,this._options=n,this._naviInfo=null,this._appkey=this._options.appkey,this._apiVer=this._options.apiVersion,this._apiVersion=Qc(this._options.apiVersion)}return e.prototype.getNaviInfo=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return n&&this._clear(e),r=function(e,t,n){var r,i,o=nU(e);try{var s=n.getItem(o);i=s?JSON.parse(s):[]}catch(e){i=[]}var a=Date.now();return i.length>0&&(i=i.filter((function(e){return a-e.timestamp<Qs}))),0===i.length?n.removeItem(o):n.setItem(o,JSON.stringify(i)),(null===(r=i.find((function(e){return e.token===t})))||void 0===r?void 0:r.naviInfo)||null}(this._appkey,e,this.runtime.localStorage),r?(this._naviInfo=r,[2,r]):(i=this._options.navigators.slice(),t.length&&t.forEach((function(e){i.indexOf(e)<0&&i.unshift(e)})),[4,this.requestNaviInfo(i,this._appkey,e)]);case 1:return(r=o.sent())?(this._naviInfo=r,this.setNaviInfo2Cache(e,r),[2,r]):[2,r]}}))}))},e.prototype.setNaviInfo2Cache=function(e,t){this._naviInfo=t,function(e,t,n,r){var i,o=nU(e);try{var s=r.getItem(o);i=s?JSON.parse(s):[]}catch(e){i=[]}var a=Date.now();i.length>0&&(i=i.filter((function(e){return a-e.timestamp<Qs&&t!==e.token}))),i.push({timestamp:a,naviInfo:n,token:t}),r.setItem(o,JSON.stringify(i))}(this._appkey,e,t,this.runtime.localStorage)},e.prototype.getInfoFromCache=function(e){return la({},this._naviInfo)},e.prototype._clear=function(e){!function(e,t,n){var r,i=nU(e);try{var o=n.getItem(i);r=o?JSON.parse(o):[]}catch(e){r=[]}var s=Date.now();r.length>0&&(r=r.filter((function(e){return s-e.timestamp<Qs&&t!==e.token}))),0===r.length?n.removeItem(i):n.setItem(i,JSON.stringify(r))}(this._appkey,e,this.runtime.localStorage)},e}(),oU=Qr,sU=Mc.findIndex,aU=au,cU="findIndex",uU=!0;cU in[]&&Array(1).findIndex((function(){uU=!1})),oU({target:"Array",proto:!0,forced:uU},{findIndex:function(e){return sU(this,e,arguments.length>1?arguments[1]:void 0)}}),aU(cU);var lU=s,hU=R,dU=Ci,fU=B,pU=hU(h.f),gU=hU([].push),vU=function(e){return function(t){for(var n,r=fU(t),i=dU(r),o=i.length,s=0,a=[];o>s;)n=i[s++],lU&&!pU(r,n)||gU(a,e?[n,r[n]]:r[n]);return a}},yU={entries:vU(!0),values:vU(!1)}.values;Qr({target:"Object",stat:!0},{values:function(e){return yU(e)}});var mU={exports:{}},_U={},CU=O,EU=B,TU=Wn.f,IU=Wf,RU="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];_U.f=function(e){return RU&&"Window"==CU(e)?function(e){try{return TU(e)}catch(e){return IU(RU)}}(e):TU(EU(e))};var SU=o((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),MU=o,NU=K,OU=O,wU=SU,AU=Object.isExtensible,UU=MU((function(){AU(1)}))||wU?function(e){return!!NU(e)&&((!wU||"ArrayBuffer"!=OU(e))&&(!AU||AU(e)))}:AU,bU=!o((function(){return Object.isExtensible(Object.preventExtensions({}))})),LU=Qr,PU=R,DU=dn,xU=K,kU=ke,VU=Ot.f,BU=Wn,GU=_U,FU=UU,KU=bU,qU=!1,HU=Ke("meta"),jU=0,YU=function(e){VU(e,HU,{value:{objectID:"O"+jU++,weakData:{}}})},WU=mU.exports={enable:function(){WU.enable=function(){},qU=!0;var e=BU.f,t=PU([].splice),n={};n[HU]=1,e(n).length&&(BU.f=function(n){for(var r=e(n),i=0,o=r.length;i<o;i++)if(r[i]===HU){t(r,i,1);break}return r},LU({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:GU.f}))},fastKey:function(e,t){if(!xU(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!kU(e,HU)){if(!FU(e))return"F";if(!t)return"E";YU(e)}return e[HU].objectID},getWeakData:function(e,t){if(!kU(e,HU)){if(!FU(e))return!0;if(!t)return!1;YU(e)}return e[HU].weakData},onFreeze:function(e){return KU&&qU&&FU(e)&&!kU(e,HU)&&YU(e),e}};DU[HU]=!0;var QU=Qr,JU=r,zU=R,XU=Gr,ZU=Jt.exports,$U=mU.exports,eb=nf,tb=Ju,nb=G,rb=K,ib=o,ob=cf,sb=Fu,ab=Yv,cb=Ot.f,ub=Gi,lb=wu,hb=mc,db=Ju,fb=nf,pb=jm,gb=Yu,vb=s,yb=mU.exports.fastKey,mb=An.set,_b=An.getterFor,Cb={getConstructor:function(e,t,n,r){var i=e((function(e,i){db(e,o),mb(e,{type:t,index:ub(null),first:void 0,last:void 0,size:0}),vb||(e.size=0),null!=i&&fb(i,e[r],{that:e,AS_ENTRIES:n})})),o=i.prototype,s=_b(t),a=function(e,t,n){var r,i,o=s(e),a=c(e,t);return a?a.value=n:(o.last=a={index:i=yb(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),vb?o.size++:e.size++,"F"!==i&&(o.index[i]=a)),e},c=function(e,t){var n,r=s(e),i=yb(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return lb(o,{clear:function(){for(var e=s(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,vb?e.size=0:this.size=0},delete:function(e){var t=this,n=s(t),r=c(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),vb?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=s(this),r=hb(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!c(this,e)}}),lb(o,n?{get:function(e){var t=c(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),vb&&cb(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=_b(t),o=_b(r);pb(e,t,(function(e,t){mb(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),gb(t)}},Eb=function(e,t,n){var r=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),o=r?"set":"add",s=JU[e],a=s&&s.prototype,c=s,u={},l=function(e){var t=zU(a[e]);ZU(a,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!rb(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return i&&!rb(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!rb(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(XU(e,!nb(s)||!(i||a.forEach&&!ib((function(){(new s).entries().next()})))))c=n.getConstructor(t,e,r,o),$U.enable();else if(XU(e,!0)){var h=new c,d=h[o](i?{}:-0,1)!=h,f=ib((function(){h.has(1)})),p=ob((function(e){new s(e)})),g=!i&&ib((function(){for(var e=new s,t=5;t--;)e[o](t,t);return!e.has(-0)}));p||((c=t((function(e,t){tb(e,a);var n=ab(new s,e,c);return null!=t&&eb(t,n[o],{that:n,AS_ENTRIES:r}),n}))).prototype=a,a.constructor=c),(f||g)&&(l("delete"),l("has"),r&&l("get")),(g||d)&&l(o),i&&a.clear&&delete a.clear}return u[e]=c,QU({global:!0,forced:c!=s},u),sb(c,e),i||n.setStrong(c,e,r),c};Eb("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),Cb);var Tb="outbox",Ib="inbox",Rb="broadcastbox",Sb=function(e,t,n){return[e,t,n].join("_")},Mb=function(){function e(e,t){this._runtime=e,this._appkey=t,this._users={}}return e.prototype._getMemData=function(e){return this._users[e]||(this._users[e]={inboxTime:0,outboxTime:0,broadcastSyncTime:0})},e.prototype.setInboxTime=function(e,t){var n=this._getMemData(t);if(!(n.inboxTime>e)){n.inboxTime=e;var r=Sb(Ib,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getInboxTime=function(e){var t=this._getMemData(e);if(0===t.inboxTime){var n=Sb(Ib,this._appkey,e);t.inboxTime=parseInt(this._runtime.localStorage.getItem(n))||0}return t.inboxTime},e.prototype.setBroadcastSyncTime=function(e,t){var n=this._getMemData(t);if(!(n.broadcastSyncTime>=e||yg(e))){n.broadcastSyncTime=e;var r=Sb(Rb,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getBroadcastSyncTime=function(e){var t=this._getMemData(e);if(!t||0===t.broadcastSyncTime){var n=Sb(Rb,this._appkey,e);t.broadcastSyncTime=parseInt(this._runtime.localStorage.getItem(n))||1}return t.broadcastSyncTime},e.prototype.setOutboxTime=function(e,t){var n=this._getMemData(t);if(!(n.outboxTime>=e)){n.outboxTime=e;var r=Sb(Tb,this._appkey,t);this._runtime.localStorage.setItem(r,e.toString())}},e.prototype.getOutboxTime=function(e){var t=this._getMemData(e);if(0===t.outboxTime){var n=Sb(Tb,this._appkey,e);t.outboxTime=parseInt(this._runtime.localStorage.getItem(n))||0}return t.outboxTime},e}(),Nb={_caches:{},set:function(e,t){this._caches[e]=t},get:function(e){return this._caches[e]||0},clear:function(e){this._caches[e]=0}},Ob=function(){function e(e,t){this._kvCaches={},this._chatroomId=e,this._currentUserId=t}return e.prototype._add=function(e){var t=e.key;e.isDeleted=!1,this._kvCaches[t]=e},e.prototype._remove=function(e){var t=e.key,n=this._kvCaches[t];n&&(n.isDeleted=!0,this._kvCaches[t]=n)},e.prototype._setEntry=function(e,t){var n=e.key,r=e.type,i=e.isOverwrite,o=e.userId,s=this._getSetUserId(n),a=r===av.DELETE,c=s===o,u=!this._isExisted(n),l=a?this._remove:this._add;(t||i||c||u)&&l.call(this,e)},e.prototype.getValue=function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.value},e.prototype.getVersion=function(e){var t=this._kvCaches[e]||{};return t.isDeleted?null:t.version},e.prototype.getAllValue=function(){var e={};for(var t in this._kvCaches)this._kvCaches[t].isDeleted||(e[t]=this._kvCaches[t].value);return e},e.prototype._getSetUserId=function(e){return(this._kvCaches[e]||{}).userId},e.prototype._isExisted=function(e){var t=this._kvCaches[e]||{},n=t.value,r=t.isDeleted;return n&&!r},e.prototype.setEntries=function(e){var t=this,n=e.kvEntries,r=e.isFullUpdate;n=n||[],(r=r||!1)&&this.clear(),n.forEach((function(e){t._setEntry(e,r)})),Mg.debug("end setEntries")},e.prototype.clear=function(){this._kvCaches={}},e}(),wb=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._storeCaches={},this._engine=e}return e.prototype._startPull=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.chrmId,n=e.timestamp,(r=Nb.get(t))>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullChatroomEntry(t,r)]);case 1:return i=a.sent(),o=i.code,s=i.data,this._isPulling=!1,o===Yg.SUCCESS?(Nb.set(t,s.syncTime||0),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.reset=function(e){Nb.clear(e);var t=this._storeCaches[e];t&&t.clear()},e.prototype.pullEntry=function(e,t){this._pullQueue.push({chrmId:e,timestamp:t}),this._startPull()},e.prototype.setLocal=function(e,t,n){var r=this._storeCaches[e];_g(r)||(r=new Ob(e,n)),r.setEntries(t),this._storeCaches[e]=r},e.prototype.getValue=function(e,t){var n=this._storeCaches[e];return n?n.getValue(t):null},e.prototype.getVersion=function(e,t){var n=this._storeCaches[e];return n?n.getVersion(t):null},e.prototype.getAll=function(e){var t=this._storeCaches[e],n={};return t&&(n=t.getAllValue()),n},e}(),Ab=function(){function e(e,t,n,r){this._runtime=e,this._appkey=t,this._userId=n,this._canJoinMulipleChrm=r,this._sessionKey="",this._joinedChrmsInfo={},this._sessionKey="sync-chrm-".concat(this._appkey,"-").concat(this._userId)}return e.prototype.set=function(e,t){void 0===t&&(t=10),!this._canJoinMulipleChrm&&(this._joinedChrmsInfo={}),this._joinedChrmsInfo[e]=t,this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo))},e.prototype.get=function(){var e,t;try{t=this._runtime.sessionStorage.getItem(this._sessionKey),e=JSON.parse(t||"{}")}catch(n){Mg.error("parse rejoined chrm infos error -> ".concat(t)),e={}}return e},e.prototype.remove=function(e){delete this._joinedChrmsInfo[e],_g(this._joinedChrmsInfo)?this._runtime.sessionStorage.setItem(this._sessionKey,JSON.stringify(this._joinedChrmsInfo)):this.clear()},e.prototype.clear=function(){this._joinedChrmsInfo={},this._runtime.sessionStorage.removeItem(this._sessionKey)},e}(),Ub="converStatusChanged",bb=function(){function e(e,t,n){this._eventEmitter=new Kg,this._pullQueue=[],this._isPulling=!1,this._storage=oa(e.runtime),this._appkey=t,this._currentUserId=n,this._engine=e,this._storagePullTimeKey="con-s-".concat(t,"-").concat(n)}return e.prototype._set=function(e){var t=this;if(!yg(e)&&Array.isArray(e)){var n=this._storage.get(this._storagePullTimeKey)||0,r=e.length;e.forEach((function(e,i){var o=e.updatedTime||0;n=o>n?o:n,e.conversationType=e.type,t._eventEmitter.emit(Ub,{statusItem:e,isLastPull:i===r-1})})),this._storage.set(this._storagePullTimeKey,n)}},e.prototype._startPull=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullConversationStatus(e)]);case 1:return t=i.sent(),n=t.code,r=t.data,n===Yg.SUCCESS?(this._isPulling=!1,this._set(r),this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pull=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.watch=function(e){this._eventEmitter.on(Ub,(function(t){e(t)}))},e.prototype.unwatch=function(){this._eventEmitter.off(Ub,(function(e){}))},e}(),Lb={c:{keyName:"unreadMessageCount",defaultVal:0},hm:{keyName:"hasMentioned",defaultVal:!1},m:{keyName:"mentionedInfo",defaultVal:null},t:{keyName:"lastUnreadTime",defaultVal:0},lt:{keyName:"lastReadTime",defaultVal:0},nc:{keyName:"notificationStatus",defaultVal:2},nl:{keyName:"notificationLevel",defaultVal:0},to:{keyName:"isTop",defaultVal:!1},tg:{keyName:"tags",defaultVal:{}},mc:{keyName:"unreadMentionedCount",defaultVal:0}},Pb={};for(var Db in Lb){var xb=Lb[Db].keyName;Pb[xb]=Db}var kb,Vb=function(){function e(e,t,n){this._appkey=t,this._currentUserId=n;var r="con-".concat(t,"-").concat(n);this.storage=new aa(e,r),this._localStore=new aa(e,"CONVER-".concat(t,"-").concat(n))}return e.prototype._getStoreKey=function(e,t,n){return"".concat(n,"_").concat(e,"_").concat(t)},e.prototype._getConOptionByKey=function(e){var t=(e=e||"").split("_");if(t.length>=2){var n=t.shift(),r=t.shift(),i=t.join("_");return{conversationType:Number(r),targetId:i,channelId:n}}return{conversationType:ng.PRIVATE,targetId:"",channelId:""}},e.prototype.updateMentionedData=function(e){var t=this,n=e.conversationType,r=e.targetId,i=e.messageType,o=e.isMentioned,s=e.content,a=e.senderUserId,c=e.channelId,u=this._getStoreKey(n,r,c),l=this._localStore.get(u)||{},h=Pb.mentionedInfo,d=Pb.hasMentioned,f=l[h]||{},p=f.userIdList||[],g=s.mentionedInfo;if(g){if(o&&n===ng.GROUP)(g.userIdList||[]).forEach((function(e){e===t._currentUserId&&p.indexOf(a)<0&&p.push(a)})),g.type===rv.ALL&&p.indexOf(a)<0&&p.push(a);if(i===Xg.RECALL&&n===ng.GROUP){var v=p.indexOf(a);v>=0&&p.splice(v,1)}g={userIdList:p,type:(null==g?void 0:g.type)||f.type},0!==p.length?(l[h]=g,l[d]=!0):(delete l[h],delete l[d]),_g(l)?this._localStore.set(u,l):this._localStore.remove(u)}},e.prototype.set=function(e,t,n,r){var i=this._getStoreKey(e,t,r),o=this._localStore.get(i)||{};for(var s in n){var a=Pb[s],c=n[s];if(!yg(a)&&!yg(c)&&"hasMentioned"!==s&&"MentionedInfo"!==s){if(c===Lb[a].defaultVal||"tags"===s&&!_g(c))delete o[a];else if("tags"===s){var u=c;for(var l in u)u[l].isTop||delete u[l].isTop;o[a]=c}else o[a]=c;o.c||(delete o.t,delete o.hm,delete o.m,delete o.mc)}}_g(o)?this._localStore.set(i,o):this._localStore.remove(i)},e.prototype.get=function(e,t,n){void 0===n&&(n="");var r=this._getStoreKey(e,t,n),i=this._localStore.get(r)||{},o={};for(var s in Lb){var a=Lb[s],c=a.keyName,u=a.defaultVal;o[c]=i[s]||Wy(u)}return o},e.prototype.getValue=function(e){var t=this._localStore.getValues()||{},n=[];for(var r in t){var i=this._getConOptionByKey(r),o={conversationType:i.conversationType,targetId:i.targetId,channelId:i.channelId},s=t[r];for(var a in s)if(Lb[a]){var c=Lb[a],u=c.keyName,l=c.defaultVal;o[u]=s[a]||Wy(l)}o=e?e(o):o,n.push(o)}return n},e.prototype.getValueForTag=function(){var e=this._localStore.getValues()||{},t={};for(var n in e){var r=this._getConOptionByKey(n),i=r.conversationType,o=r.targetId,s={},a=e[n];for(var c in a){var u=Lb[c],l=u.keyName,h=u.defaultVal;s[l]=a[c]||Wy(h)}for(var d in s.tags){yg(t[d])&&(t[d]=[]);var f=Object.assign({},s,{conversationType:i,targetId:o});delete f.tags,t[d].push(f)}}return t},e.prototype.adaptOldStore=function(){try{var e=this.storage.getValues();if(0===Object.keys(e).length)return;for(var t in e){var n="_".concat(t);this._localStore.set(n,e[t])}this.storage.clear()}catch(e){Mg.error("adaptOldStore error: ".concat(e.message))}},e}(),Bb=[ng.PRIVATE,ng.GROUP,ng.SYSTEM,ng.PUBLIC_SERVICE,ng.APP_PUBLIC_SERVICE],Gb="conversationChanged",Fb="conTagStatusChanged",Kb=function(){function e(e,t,n,r,i){var o=this;this._updatedConversations={},this._conTagStatusChanged=!1,this._eventEmitter=new Kg,this._draftMap={},this._recallMsgTimeMap={},this._appkey=t,this._loginUserId=n,this._store=new Vb(e.runtime,t,n),this._statusManager=new bb(e,t,n),this._statusManager.watch((function(e){var t=e.statusItem,n=e.isLastPull;o.addStatus(t,n)})),this._eventEmitter.on(Gb,(function(e){r(e)})),this._eventEmitter.on(Fb,(function(){i()}))}return e.prototype._calcUnreadCount=function(e,t){var n=e.content,r=e.messageType,i=e.sentTime,o=e.isCounted,s=e.messageDirection,a=e.senderUserId,c=s===Hg.SEND&&a===this._loginUserId,u=r===Xg.RECALL,l=gg(n),h=!1,d={},f=t.lastUnreadTime||0,p=t.lastReadTime||0,g=t.unreadMessageCount||0;if(f>i||c)return{hasChanged:h,localConversation:t,updateItems:d};if(o&&(t.unreadMessageCount=g+1,t.lastUnreadTime=i,h=!0),u&&l){var v="".concat(e.conversationType,"_").concat(e.channelId,"_").concat(e.targetId),y=!this._recallMsgTimeMap[v]||this._recallMsgTimeMap[v]&&!this._recallMsgTimeMap[v].find((function(e){return e===n.sentTime})),m=f>=n.sentTime;p&&(m=p<n.sentTime),m&&g&&y&&(!this._recallMsgTimeMap[v]&&(this._recallMsgTimeMap[v]=[]),this._recallMsgTimeMap[v].push(n.sentTime),t.unreadMessageCount=g-1,h=!0)}return h&&(d.unreadMessageCount={val:t.unreadMessageCount,time:i}),{hasChanged:h,localConversation:t,updateItems:d}},e.prototype._calcMentionedInfo=function(e,t){var n=e.content,r=(e.messageDirection,e.isMentioned),i=e.sentTime;Hg.SEND;var o=gg(n),s=!1,a={};return r&&o&&n.mentionedInfo&&(t.hasMentioned=!0,s=!0,a.hasMentioned={val:!0,time:i},a.mentionedInfo={val:n.mentionedInfo,time:i}),{hasChanged:s,localConversation:t,updateItems:a}},e.prototype._calcMentionedCount=function(e,t){var n=e.content,r=e.messageDirection,i=!1;if(e.isMentioned&&r===Hg.RECEIVE&&(null==n?void 0:n.mentionedInfo)){var o=n.mentionedInfo,s=o.type,a=o.userIdList;if(s===rv.ALL||(a||[]).includes(this._loginUserId)){i=!0;var c=t.unreadMentionedCount||0;t.unreadMentionedCount=c+1}}return{hasChanged:i,localConversation:t}},e.prototype._setUpdatedConversation=function(e){if(gg(e)){var t=e.conversationType,n=e.targetId,r=e.channelId,i="".concat(t,"_").concat(n),o=this._store.get(t,n,r)||{};this._updatedConversations[i]=Object.assign(o,e)}},e.prototype._setConTagStatusChanged=function(e,t,n,r){var i=(this._store.get(e,t,r)||{}).tags||{};if(Object.keys(i).length===Object.keys(n).length){for(var o in i)if(!n[o]||i[o].isTop!==n[o].isTop)return void(this._conTagStatusChanged=!0)}else this._conTagStatusChanged=!0},e.prototype.addStatus=function(e,t){var n=e.conversationType,r=e.targetId,i=e.updatedTime,o=e.notificationStatus,s=e.notificationLevel,a=e.isTop,c=e.tags,u=e.channelId,l={},h={};n!==ng.ULTRA_GROUP&&(yg(o)||(h.notificationStatus={time:i,val:o}),yg(s)||(h.notificationLevel={time:i,val:s}),yg(a)||(h.isTop={time:i,val:a}),yg(c)||(h.tags={time:i,val:c},null==c||c.forEach((function(e){l[e.tagId]={isTop:e.isTop}}))),this._setConTagStatusChanged(n,r,l,u),this._store.set(n,r,{notificationStatus:o,notificationLevel:s,isTop:a,tags:l},u),this._setUpdatedConversation({conversationType:n,targetId:r,updatedItems:h,channelId:u}),t&&this._notifyConversationChanged())},e.prototype._notifyConversationChanged=function(){var e=[];for(var t in this._updatedConversations)e.push(this._updatedConversations[t]);0!==e.length&&(this._eventEmitter.emit(Gb,e),this._updatedConversations={},this._conTagStatusChanged&&(this._eventEmitter.emit(Fb),this._conTagStatusChanged=!1))},e.prototype.setConversationCacheByMessage=function(e,t){var n=this,r=e.conversationType,i=e.isPersited,o=e.targetId,s=e.channelId;if(Bb.indexOf(r)>=0){var a=!1,c=this._store.get(r,o,s),u={};if([this._calcUnreadCount,this._calcMentionedInfo,this._calcMentionedCount].forEach((function(t){var r=t.call(n,e,c),i=r.hasChanged,o=r.localConversation,s=r.updateItems;a=a||i,u=la(la({},u),s),c=Wy(o)})),a&&this._store.set(r,o,c,s),this._store.updateMentionedData(e),i){var l=this._store.get(r,o,s);l.updatedItems=la({latestMessage:{time:e.sentTime,val:e}},u),l.latestMessage=e;var h=Object.assign(l,{conversationType:r,targetId:o,channelId:s});this._setUpdatedConversation(h)}(a||i)&&this._notifyConversationChanged()}},e.prototype.get=function(e,t,n){return void 0===n&&(n=""),this._store.get(e,t,n)},e.prototype.getAllUnreadCount=function(e,t,n){var r=this._store.getValue(),i=0;return r.forEach((function(e){var r=e.unreadMessageCount,o=e.notificationStatus,s=e.notificationLevel,a=e.conversationType;r=r||0,(n||1!==o||s===tv.NOT_SET||s===tv.ALL_MESSAGE)&&(t.length>0?t.includes(Number(a))&&(i+=Number(r)):i+=Number(r))})),i},e.prototype.getUnreadCountByTag=function(e,t){var n=this._store.getValueForTag()[e]||[],r=0;return n.forEach((function(e){var n=e.unreadMessageCount,i=e.notificationStatus,o=e.notificationLevel;(t||1!==i||-1===o||0===o)&&(n=n||0,r+=Number(n))})),r},e.prototype.getUnreadCount=function(e,t,n){return this._store.get(e,t,n).unreadMessageCount||0},e.prototype.clearUnreadCount=function(e,t,n,r){void 0===r&&(r=!0);var i=this._store.get(e,t,n);i.lastReadTime=i.lastUnreadTime,this._recallMsgTimeMap["".concat(e,"_").concat(n,"_").concat(t)]=[];var o=i.unreadMessageCount,s=i.hasMentioned,a={};if(o&&(i.unreadMessageCount=0,a.unreadMessageCount={val:0,time:Date.now()}),s&&(i.hasMentioned=!1,i.unreadMentionedCount=0,i.mentionedInfo=void 0,a.hasMentioned={val:!1,time:Date.now()},a.mentionedInfo={val:void 0,time:Date.now()}),this._store.set(e,t,i,n),r&&0!==Object.keys(a).length){var c=Object.assign(i,{conversationType:e,targetId:t,channelId:n,updatedItems:a});this._setUpdatedConversation(c),this._notifyConversationChanged()}},e.prototype.clearAllUnreadCount=function(){var e=this;this._store.getValue().forEach((function(t){t.unreadMessageCount&&(t.unreadMessageCount=0,t.lastReadTime=t.lastUnreadTime,e._recallMsgTimeMap={},e._store.set(t.conversationType,t.targetId,t,t.channelId))}))},e.prototype.startPullConversationStatus=function(e){this._statusManager.pull(e)},e.prototype.setDraft=function(e,t,n,r){var i="".concat(e,"_").concat(t,"_").concat(r);this._draftMap[i]=n},e.prototype.getDraft=function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return this._draftMap[r]},e.prototype.clearDraft=function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);delete this._draftMap[r]},e.prototype.addTagStatus=function(e,t,n,r){void 0===r&&(r="");var i=this._store.get(e,t,r).tags;i=Object.assign(i,n),this._store.set(e,t,{tags:i},r)},e.prototype.deleteTagStatus=function(e,t,n,r){void 0===r&&(r="");var i=this._store.get(e,t,r).tags;n.forEach((function(e){delete i[e]})),this._store.set(e,t,{tags:i},r)},e.prototype.getConversationListForTag=function(){return this._store.getValueForTag()},e.prototype.getBlockConversationList=function(){return this._store.getValue().filter((function(e){return e.notificationStatus===$g.OPEN||-1!==e.notificationLevel&&0!==e.notificationLevel})).map((function(e){return{conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId}}))},e.prototype.getTopConversationList=function(){return(this._store.getValue()||{}).filter((function(e){return e.isTop})).map((function(e){return{conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId}}))},e.prototype.adaptOldStore=function(){this._store.adaptOldStore()},e.prototype.getUnreadMentionedCount=function(e,t,n){return void 0===e&&(e=""),this.get(t,n,e).unreadMentionedCount||0},e.prototype.getAllUnreadMentionedCount=function(){var e=this._store.getValue(),t=0;return e.forEach((function(e){var n=e.unreadMentionedCount;n=n||0,t+=Number(n)})),t},e.prototype.getAllConversationState=function(){return this._store.getValue().filter((function(e){return e.unreadMessageCount||e.unreadMentionedCount})).map((function(e){return{conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId,unreadCount:e.unreadMessageCount||0,unreadMentionedCount:e.unreadMentionedCount||0}}))},e}(),qb=function(){function e(e,t,n,r){this._pullQueue=[],this._isPulling=!1,this._storageTagKey="tag-".concat(t,"-").concat(n),this._storagePullTimeKey="us-s-".concat(t,"-").concat(n),this._storage=oa(e.runtime),this._engine=e,this._tagWatcherFunc=r}return e.prototype._updateTag=function(e){var t=e.tags,n={};t.forEach((function(e){n[e.tagId]={tagName:e.tagName,createdTime:e.createdTime}})),this._storage.set(this._storageTagKey,n),this._tagWatcherFunc()},e.prototype.addTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){var t,r=(null===(t=n[e.tagId])||void 0===t?void 0:t.createdTime)||e.createdTime||0;n[e.tagId]={tagName:e.tagName,createdTime:r}})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.deleteTag=function(e,t){var n=this._storage.get(this._storageTagKey)||{};e.forEach((function(e){delete n[e]})),this._storage.set(this._storageTagKey,n),this._storage.set(this._storagePullTimeKey,t)},e.prototype.getTagsInfo=function(){return this._storage.get(this._storageTagKey)||{}},e.prototype.getTags=function(){var e=this._storage.get(this._storageTagKey)||{},t=[];for(var n in e)t.push({tagId:n,tagName:e[n].tagName,createdTime:e[n].createdTime,conversationCount:0});return t.sort((function(e,t){return(e.createdTime||0)-(t.createdTime||0)}))},e.prototype.getTagById=function(e){var t=this._storage.get(this._storageTagKey)||{};return t[e]?{tagId:e,tagName:t[e].tagName,createdTime:t[e].createdTime,conversationCount:0}:null},e.prototype._startPull=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],[4,this._engine.pullUserSettings(e)]);case 1:return t=c.sent(),n=t.code,r=t.data,n!==Yg.SUCCESS||yg(r)?(this._isPulling=!1,this._startPull()):(o=(i=r).settings,s=i.version,a=o.Tag,yg(a)||this._updateTag(a),this._storage.set(this._storagePullTimeKey,s),this._isPulling=!1,this._startPull()),[2]}}))}))},e.prototype.pullUserSettings=function(e){var t=this._storage.get(this._storagePullTimeKey)||0;(e>t||0===e)&&(this._pullQueue.push(t),this._startPull())},e.prototype.getVersion=function(){return this._storage.get(this._storagePullTimeKey)||0},e}(),Hb=function(){function e(e){this._pullQueue=[],this._isPulling=!1,this._pullTime=0,this._engine=e}return e.prototype._startPull=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._isPulling||0===this._pullQueue.length?[2]:(this._isPulling=!0,e=this._pullQueue.splice(0,1)[0],t=e.roomId,n=e.timestamp,(r=this._pullTime)>n?(this._isPulling=!1,this._startPull(),[2]):[4,this._engine.pullRTCRoomEntry(t,r)]);case 1:return i=a.sent(),o=i.code,s=i.data,o===Yg.SUCCESS?(this._isPulling=!1,this._pullTime=s.syncTime||0,this._startPull()):this._startPull(),[2]}}))}))},e.prototype.pullEntry=function(e,t){this._pullQueue.push({roomId:e,timestamp:t}),this._startPull()},e.prototype.reset=function(){this._pullTime=0,this._isPulling=!1},e}(),jb=function(e,t){return["send_msg",e,t].join("_")},Yb=function(){function e(e,t){this._runtime=e,this._appkey=t,this._sendMessageMap={},this._userId=""}return e.prototype.init=function(e){this._userId=e;var t=jb(this._appkey,e);this._sendMessageMap=this._getLocalInfo(t)},e.prototype._getLocalInfo=function(e){var t=this._runtime.localStorage.getItem(e);try{return t?JSON.parse(t):{}}catch(e){return{}}},e.prototype.setMessage=function(e,t){this._sendMessageMap[e]=t;var n=jb(this._appkey,this._userId),r=this._getLocalInfo(n);r[e]=t,this._runtime.localStorage.setItem(n,JSON.stringify(r))},e.prototype.getSendMessageMap=function(){return this._sendMessageMap},e.prototype.removeByUID=function(e){delete this._sendMessageMap[e]},e.prototype.removeByTimestamp=function(e){var t=jb(this._appkey,this._userId),n=this._getLocalInfo(t);Object.keys(n).forEach((function(t){n[t]<e&&delete n[t]})),this._runtime.localStorage.setItem(t,JSON.stringify(n))},e}();(kb={})[ng.PRIVATE]=jA.qryPMsg,kb[ng.GROUP]=jA.qryGMsg,kb[ng.CHATROOM]=jA.qryCHMsg,kb[ng.CUSTOMER_SERVICE]=jA.qryCMsg,kb[ng.SYSTEM]=jA.qrySMsg;var Wb=[jA[jA.recallMsg],jA[jA.ppMsgS],jA[jA.pgMsgS],jA[jA.ppMsgP],jA[jA.pgMsgP],jA[jA.chatMsg],jA[jA.pcMsgP],jA[jA.prMsgS],jA[jA.updUgRTime]],Qb=function(){function e(e,t,n){this.ULTRA_GROUP_CONVERSATION="ultragroupconversation";var r="".concat(this.ULTRA_GROUP_CONVERSATION,"-").concat(t,"-").concat(n);this._localStore=new aa(e,r)}return e.prototype.set=function(e,t,n,r){var i=this._getStoreKey(e,t,r),o=this._localStore.get(i)||{};for(var s in n){var a=zb[s],c=n[s];if(!yg(a)&&!yg(c))c===Jb[a].defaultVal?delete o[a]:o[a]=c}_g(o)?this._localStore.set(i,o):this._localStore.remove(i)},e.prototype.get=function(e,t,n){void 0===n&&(n="");var r=this._getStoreKey(e,t,n),i=this._localStore.get(r)||{},o={};for(var s in Jb){var a=Jb[s],c=a.keyName,u=a.defaultVal;o[c]=i[s]||Wy(u)}return o},e.prototype._getStoreKey=function(e,t,n){return"".concat(n,"_").concat(e,"_").concat(t)},e}(),Jb={nc:{keyName:"notificationStatus",defaultVal:2},nl:{keyName:"notificationLevel",defaultVal:0}},zb={};for(var Xb in Jb){var Zb=Jb[Xb].keyName;zb[Zb]=Xb}var $b=function(){function e(e,t,n){this._store=new Qb(e.runtime,t,n)}return e.prototype.addUltraGroupStatus=function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,i=e.notificationLevel,o=e.channelId;t===ng.ULTRA_GROUP&&this._store.set(t,n,{notificationStatus:r,notificationLevel:i},o)},e.prototype.get=function(e,t,n){return void 0===n&&(n=""),this._store.get(e,t,n)},e}(),eL=function(e,t,n,r,i,o){return{conversationType:e,targetId:t,senderUserId:o,messageDirection:Hg.SEND,isCounted:!!n.isCounted,isMentioned:!!n.isMentioned,content:n.content,messageType:n.messageType,isOffLineMessage:!1,isPersited:!!n.isPersited,messageUId:r,sentTime:i,receivedTime:0,disableNotification:!!n.disableNotification,isStatusMessage:!!n.isStatusMessage,canIncludeExpansion:!!n.canIncludeExpansion,expansion:n.canIncludeExpansion?n.expansion:null,receivedStatus:Jr.UNREAD,pushConfig:n.pushConfig,channelId:n.channelId,isInterrupt:n.isInterrupt}},tL=function(e){return e.sort((function(e,t){var n,r,i=(null===(n=e.latestMessage)||void 0===n?void 0:n.sentTime)||0;return((null===(r=t.latestMessage)||void 0===r?void 0:r.sentTime)||0)-i}))},nL=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i._customMessageType={},i._reconnectTimer=-1,i._pullOfflineFinished=!1,i._miniConnectUrl="",i.currentUserId="",i._connectedTime=0,i._localConnectedTime=0,i._status=Qg.DISCONNECTED,i._pullingMsg=!1,i._pullQueue=[],i._chrmsQueue={},i._latestSyncTimestamp=0,i._intervalTimer=-1,i._pullChatroomEntryTimestamp=0,i._intervalTimerForChrmPull=-1,i._lastSyncUltraMsgTimeStamp=0,i._lastSyncUltraMsgLocalTimeStamp=0,i._ultraGroupTimer=-1,i._isUltraPulling=!1,i._ultraGroupTimeQue=[],i._isUltraGroupListExist=!1,i._ultraGroupMap={},i._firstPullUltraGroupTime=0,i._ultraMsgMap={},i._pullUltraChangeMessageQue=[],i._isPullingUltraChangeMessage=!1,i._lastPullingUltraChangeMessageTime=0,i._ultraMsgChangeMap={},i._letterbox=new Mb(t,r.appkey),i._sendMessageStore=new Yb(t,r.appkey),i._chrmEntryHandler=new wb(i),i._connectType=r.connectionType,i}return ua(t,e),t.prototype._formatJSONPUrl=function(e,t,n,r){var i=this.runtime.isSupportSocket()&&"websocket"===this._connectType?"navi":"cometnavi";return"".concat(e,"/").concat(i,".js?appId=").concat(n,"&token=").concat(encodeURIComponent(t),"&callBack=").concat(r,"&v=").concat(this._apiVersion,"&r=").concat(Date.now())},t.prototype.getNaviInfo=function(t,n,r){var i;return ha(this,void 0,void 0,(function(){var o;return da(this,(function(s){return this.runtime.useNavi||(o=void 0,o=this.runtime.isSupportSocket()&&"websocket"===this._connectType?Xs.join(","):Zs.join(","),this._miniConnectUrl=(null===(i=this._options.miniCMPProxy)||void 0===i?void 0:i.length)?this._options.miniCMPProxy.join(","):o||"",n=[]),[2,e.prototype.getNaviInfo.call(this,t,n,r)]}))}))},t.prototype.requestNaviInfo=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l,h,d,f;return da(this,(function(p){switch(p.label){case 0:r="getServerEndpoint",i=0,o=e.length,p.label=1;case 1:return i<o?(s=this._formatJSONPUrl(e[i],n,t,r),Mg.debug("req navi => ".concat(s)),[4,this.runtime.httpReq({url:s,timeout:1e4,dataType:"text"})]):[3,4];case 2:if(a=p.sent(),c=(new Date).getTime(),Mg.setStatisticsData(HA.IM_NAVI,{endTime:c}),200!==a.status)return u=void 0,403===a.status?(u=Yg.RC_CONN_USER_OR_PASSWD_ERROR,Mg.error("request navi error: "+u)):401===a.status&&(u=Yg.RC_CONN_APP_BLOCKED_OR_DELETED,Mg.error("request navi error: "+u)),Mg.setStatisticsData(HA.IM_NAVI,{code:u}),rU(this.runtime),[3,3];try{return l=a.data.match(/{[\d\D]+}/),0===(h=l&&l[0]?l[0]:"").indexOf('{\\"code\\":')&&(h=JSON.parse('"'+h+'"')),f=JSON.parse(h),d=/^https/.test(s)?"https":"http",f.protocol=d,this.runtime.useNavi||(f.server="",f.backupServer=this._miniConnectUrl,f.logSwitch=0),Mg.updateStatisticsBaseData({serverPrivate:f.type===og.PRIVATE?og.PRIVATE:og.OPEN}),Mg.setStatisticsData(HA.IM_NAVI,{code:Yg.SUCCESS}),f.userId&&(Mg.updateUploadLogAttr({userId:f.userId}),Sg.init(f.userId)),rU(this.runtime),[2,f]}catch(e){Mg.error("parse navi err =>",e)}p.label=3;case 3:return i+=1,[3,1];case 4:return this.runtime.useNavi?[2,null]:(f={code:200,protocol:"https",server:"",voipCallInfo:"",kvStorage:0,openHttpDNS:!1,historyMsg:!1,chatroomMsg:!1,uploadServer:"https://upload.qiniup.com",bosAddr:"https://gz.bcebos.com",location:"",monitor:0,joinMChrm:!1,openMp:0,openUS:0,grpMsgLimit:0,isFormatted:0,gifSize:2048,logSwitch:0,logPolicy:"",compDays:0,msgAck:"",activeServer:"",qnAddr:"",extkitSwitch:0,alone:!1,voipServer:"",offlinelogserver:"",backupServer:this._miniConnectUrl},Mg.setStatisticsData(HA.IM_NAVI,{code:f.code,startTime:0,endTime:0,host:""}),rU(this.runtime),[2,f])}}))}))},t.prototype.getConnectedTime=function(){return this._connectedTime},t.prototype.connect=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a=this;return da(this,(function(c){switch(c.label){case 0:return n=[],this.naviInfo=t,t.server?n.push(t.server):Mg.warn("navi.server is invalid"),(r=t.backupServer)&&r.split(",").forEach((function(e){n.indexOf(e)<0&&n.push(e)})),0===n.length?(Mg.error("navi invaild.",n),[2,Yg.UNKNOWN]):(i=this.runtime.createDataChannel({status:function(r){a._connectionStatusHandler(r,e,n,t.protocol)},signal:this._signalHandler.bind(this)},this._options.connectionType),o=VM.V3,1===t.openAnti&&(o=VM.V4),[4,i.connect(this._appkey,e,n,t.protocol,this._apiVer,o)]);case 1:return(s=c.sent())===Yg.SUCCESS?(this._channel=i,this.currentUserId=i.userId,this._connectedTime=i.connectedTime,this._localConnectedTime=Math.floor((Date.now()+i.sendConnectTime)/2),this._watcher.status(Qg.CONNECTED),this._status=Qg.CONNECTED,this._pullOfflineFinished=!1,this._conversationManager=new Kb(this,this._appkey,this.currentUserId,this._watcher.conversation,this._watcher.conversationTag),this._ultraGroupManager=new $b(this,this._appkey,this.currentUserId),this._conversationManager.startPullConversationStatus(0),this._userSettingManager=new qb(this,this._appkey,this.currentUserId,this._watcher.tag),this._userSettingManager.pullUserSettings(0),this._sendMessageStore.init(this.currentUserId),this._conversationManager.adaptOldStore(),this._rtcKVManager=new Hb(this),this._joinedChrmManager=new Ab(this.runtime,this._appkey,this.currentUserId,t.joinMChrm),this._startSyncInterval(),1===t.ugMsg&&this._startUltraSyncInterval()):i.close(),[2,s]}}))}))},t.prototype._connectionStatusHandler=function(e,t,n,r){if(Mg.warn("connection status changed:",e),this._status=e,e!==Qg.CONNECTING)if(e!==Qg.CONNECTED){if(this._channel&&e!==Qg.DISCONNECTED)return e===Qg.BLOCKED||e===Qg.KICKED_OFFLINE_BY_OTHER_CLIENT||e===Qg.DISCONNECT_BY_SERVER?(this.disconnect(),void this._watcher.status(e)):void(e!==Qg.REDIRECT?(this._watcher.status(e),this._try2Reconnect(t,n,r)):this._watcher.status(e));this._watcher.status(e)}else this._watcher.status(e);else this._watcher.status(e)},t.prototype._try2Reconnect=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i=this;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=VM.V3,1===this.naviInfo.openAnti&&(r=VM.V4),[4,this._channel.connect(this._appkey,e,t,n,this._apiVer,r)]):[2];case 1:return o.sent()===Yg.SUCCESS?(this._pullOfflineFinished=!1,this._startSyncInterval(),this._watcher.status(Qg.CONNECTED),this._status=Qg.CONNECTED,1===this.naviInfo.ugMsg&&this._startUltraSyncInterval(),this._rejoinChrm(),Mg.__insertLogIntoDatabase(),[2]):(this._watcher.status(Qg.WEBSOCKET_UNAVAILABLE),this._status=Qg.WEBSOCKET_UNAVAILABLE,this._reconnectTimer=setTimeout((function(){i._reconnectTimer=-1,i._try2Reconnect(e,t,n)}),5e3),[2])}}))}))},t.prototype._signalHandler=function(e,t){var n=e.syncMsg,r=e.topic;if(n)this._receiveSyncMsg(e,t);else{var i=jA[r];if(i)switch(i){case jA.s_ntf:Mg.info("recv s_ntf -> signal.messageId: ".concat(e.messageId)),this._pullMsg(e);break;case jA.s_msg:this._receiveMsg(e);break;case jA.s_cmd:this._receiveStateNotify(e);break;case jA.s_us:this._receiveSettingNotify(e);break;case jA.rtc_ntf:this._receiveRtcKv(e);break;case jA.s_opNtf:this._pullOperateStatusNotify(e)}else Mg.error("unknown topic:",r)}},t.prototype._receiveStateNotify=function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,aN),r=n.time,i=n.type,o=n.chrmId;switch(i){case 2:this._chrmEntryHandler.pullEntry(o,r);break;case 3:this._conversationManager.startPullConversationStatus(r);break;case 4:this._chrmEntryHandler.reset(o),this._watcher.chatroom({chatroomDestroyed:e.targetId});break;case 6:this._ultraGroupTimeQue.push(r),this._syncUltraMsg(this._lastSyncUltraMsgTimeStamp);break;case 7:this._pullUltraChangeMessageQue.push(r),this._pullUltraChangeMessageList(this._lastPullingUltraChangeMessageTime)}},t.prototype._receiveSettingNotify=function(e){var t,n=(null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,iO)).version;this._userSettingManager.pullUserSettings(n)},t.prototype._receiveRtcKv=function(e){var t,n=null===(t=this._channel)||void 0===t?void 0:t.codec.decodeByPBName(e.data,kO),r=n.time,i=n.type,o=n.roomId;if(1===i)this._rtcKVManager.pullEntry(o,r)},t.prototype._receiveMessageExpansion=function(e){var t=e.content,n=t.put,r=t.del,i=t.mid;n&&this._watcher.expansion({updatedExpansion:{messageUId:i,expansion:n}}),r&&this._watcher.expansion({deletedExpansion:{messageUId:i,deletedKeys:r}})},t.prototype._receiveSyncMsg=function(e,t){var n,r;if(Wb.includes(e.topic)){if(e.topic===jA[jA.updUgRTime]){var i=null===(n=this._channel)||void 0===n?void 0:n.codec.decodeByPBName(e.data,mN),o=i.channelId,s=i.busChannel,a=this._ultraGroupMap[s+"_"+o];return a&&(a.unreadMessageCount=0,a.unreadMentionedCount=0,a.lastReadTime=t.timestamp,this._watcher.conversation(Xy([a]))),void(t&&(this._ultraMsgMap[t.messageUId]=t.timestamp))}var c=null===(r=this._channel)||void 0===r?void 0:r.codec.decodeByPBName(e.data,$M,{currentUserId:this.currentUserId,signal:e});c=this._handleMsgProperties(c),t&&(c.sentTime=t.timestamp,c.messageUId=t.messageUId),this._pullingMsg?this._pullQueue.push((null==t?void 0:t.timestamp)||c.sentTime):(t&&this._sendMessageStore.setMessage(t.messageUId,t.timestamp),c.messageType!==Xg.EXPANSION_NOTIFY?(c.messageType===Xg.SYNC_READ_STATUS&&this._conversationManager.clearUnreadCount(c.conversationType,c.targetId,c.channelId),this._conversationManager.setConversationCacheByMessage(c,!0),this._watcher.batchMessage([c])):this._receiveMessageExpansion(c))}},t.prototype._pullMsg=function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,aN),n=t.type,r=t.chrmId,i=t.time;if(Mg.info("s_ntf -> type: ".concat(n,", chrmId: ").concat(r,", time: ").concat(i)),2===n){var o=this._chrmsQueue[r];if(!o)return;o.queue.push(i),this._pullChrmMsg(r)}else this._pullQueue.push(i),this._syncMsg()}},t.prototype._startSyncInterval=function(){var e=this;this._stopSyncInterval();this._intervalTimer=setInterval((function(){Date.now()-e._latestSyncTimestamp>=18e4&&e._syncMsg()}),3e4),this._latestSyncTimestamp=Date.now(),this._syncMsg()},t.prototype._stopSyncInterval=function(){-1!==this._intervalTimer&&(clearInterval(this._intervalTimer),this._intervalTimer=-1)},t.prototype._syncMsg=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,a,c,u,l,h,d,f,p,g,v,y=this;return da(this,(function(m){switch(m.label){case 0:return this._pullingMsg?[2]:this._channel?(this._pullingMsg=!0,e=this._letterbox.getOutboxTime(this.currentUserId),t=this._letterbox.getInboxTime(this.currentUserId),n=this._letterbox.getBroadcastSyncTime(this.currentUserId),Mg.info("pullMsg -> sendboxTime: ".concat(e,", inboxTime: ").concat(t,", broadcastSyncTime: ").concat(n)),r=this._channel.codec.encodeSyncMsg({sendboxTime:e,inboxTime:t,broadcastSyncTime:n}),i=new hA(jA[jA.pullMsg],r,this.currentUserId),[4,this._channel.send(i,nN,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId})]):(this._pullingMsg=!1,[2]);case 1:return o=m.sent(),s=o.code,a=o.data,this._latestSyncTimestamp=Date.now(),s!==Yg.SUCCESS||!a||yg(a.finished)||yg(a.list)||yg(a.syncTime)?(Mg.warn("pullMsg failed -> code:",s,", data: ",a),this._pullingMsg=!1,[2]):(c=a.list,u=a.finished,l=a.syncTime,h=a.broadcastSyncTime,d=void 0===h?1:h,Mg.info("pullMsg success -> syncTime: ".concat(l,", finished: ").concat(u)),f=0,p=[],c.forEach((function(e){if(e.messageDirection===Hg.SEND&&(f=Math.max(e.sentTime,f),y._sendMessageStore.getSendMessageMap()[e.messageUId]))return void y._sendMessageStore.removeByUID(e.messageUId);if(e.messageType!==Xg.EXPANSION_NOTIFY){if(e.messageType===Xg.SYNC_READ_STATUS){if(e.senderUserId!==y.currentUserId)return;y._conversationManager.clearUnreadCount(e.conversationType,e.targetId,e.channelId)}var t=y._handleMsgProperties(e);y._conversationManager.setConversationCacheByMessage(t,!0),p.push(t)}else y._receiveMessageExpansion(e)})),this._watcher.batchMessage(p),this._letterbox.setInboxTime(l,this.currentUserId),this._letterbox.setOutboxTime(f,this.currentUserId),this._letterbox.setBroadcastSyncTime(d,this.currentUserId),this._sendMessageStore.removeByTimestamp(f),this._pullingMsg=!1,g=this._pullQueue.filter((function(e){return e>l})),this._pullQueue.length=0,(v=this._pullQueue).push.apply(v,g),u&&!this._pullOfflineFinished&&(this._pullOfflineFinished=!0,this._watcher.pullFinished()),(!u||g.length>0)&&this._syncMsg(),[2])}}))}))},t.prototype._receiveMsg=function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,tN,{currentUserId:this.currentUserId,connectedTime:this._channel.connectedTime});if((t=this._handleMsgProperties(t)).conversationType!==ng.RTC_ROOM){if(this._pullingMsg)return;if(this._pullQueue.length>0)return void this._syncMsg()}t.senderUserId===this.currentUserId&&this._sendMessageStore.setMessage(t.messageUId,t.sentTime),t.isStatusMessage||t.senderUserId===this.currentUserId||this._letterbox.setInboxTime(t.sentTime,this.currentUserId),t.messageType!==Xg.EXPANSION_NOTIFY?t.messageType===Xg.SYNC_READ_STATUS&&t.senderUserId!==this.currentUserId||(this._conversationManager.setConversationCacheByMessage(t,!0),this._watcher.batchMessage([t])):this._receiveMessageExpansion(t)}},t.prototype._handleMsgProperties=function(e,t){void 0===t&&(t=!1);var n,r=e.messageType,i=e.isCounted,o=e.isPersited,s=e.isStatusMessage,a=r in ra,c=r in this._customMessageType;if(n=a?la(la({},ra[r]),{isStatusMessage:ia.includes(r)}):c?this._customMessageType[r]:{isCounted:!mg(i)&&i,isPersited:!mg(o)&&o,isStatusMessage:!1},Object.assign(e,n),t&&!yg(s)&&(e.isStatusMessage=s),!t){var u=e.content.user;if(u){var l=u.portrait,h=u.portraitUri,d=l||h;d&&(u.portrait=u.portraitUri=d)}}return e},t.prototype.getHistoryMessage=function(e,t,n,r,i,o){return void 0===o&&(o=""),ha(this,void 0,void 0,(function(){var s,a,c,u,l,h,d,f,p;return da(this,(function(g){switch(g.label){case 0:return a=(s=this).currentUserId,c=s._channel,u=qw[e]||kw,l=1===r&&0===n,c?(h=c.codec.encodeGetHistoryMsg(t,{timestamp:n,count:l?2:r,order:i,channelId:o}),[4,c.send(new hA(u,h,a),uN,{currentUserId:a,connectedTime:c.connectedTime,conversation:{targetId:t}})]):[3,2];case 1:return d=g.sent(),(f=d.code)!==Yg.SUCCESS?[2,{code:f}]:(p=d.data,l&&2===p.list.length&&(p.hasMore=!0,0===i?p.list.shift():p.list.pop()),[2,{code:f,data:{list:p.list,hasMore:p.hasMore}}]);case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.reportSDKInfo=function(e){var t=this.currentUserId,n=this._channel;if(n){Mg.info("reportSDKInfo ->",e);var r=n.codec.encodeReportSDKInfo(JSON.stringify(e)),i=new hA(jA[jA.reportsdk],r,t);n.send(i).then((function(e){var t=e.code;t!==Yg.SUCCESS&&Mg.warn("reportSDKInfo failed -> code: ".concat(t))}))}},t.prototype.deleteRemoteMessage=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:return o=(i=this).currentUserId,(s=i._channel)?(a=s.codec.encodeDeleteMessages(e,t,n,r),c=new hA(Sw,a,o),[4,s.send(c)]):[3,2];case 1:return u=h.sent(),l=u.code,Yg.SUCCESS,[2,l];case 2:return[2,Yg.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.deleteRemoteMessageByTimestamp=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,h;return da(this,(function(d){switch(d.label){case 0:return o=(i=this).currentUserId,(s=i._channel)?(a=s.codec.encodeClearMessages(t,n,r,e),c=Hw[e],u=new hA(c,a,o),[4,s.send(u)]):[3,2];case 1:return l=d.sent(),h=l.code,Yg.SUCCESS,[2,h];case 2:return[2,Yg.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.getConversationList=function(e,t,n,r,i){return void 0===e&&(e=300),ha(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,h,d=this;return da(this,(function(f){switch(f.label){case 0:return o=(i=this).currentUserId,s=i._channel,t=t||ng.PRIVATE,s?(a=s.codec.encodeOldConversationList({count:e,type:t,startTime:n,order:r}),c=new hA(Lw,a,o),[4,s.send(c,hN,{currentUserId:o,connectedTime:s.connectedTime,afterDecode:function(e){var t=e.conversationType,n=e.targetId,r=e.channelId,i=d._conversationManager.get(t,n,r);return Object.assign(e,i),e}})]):[3,2];case 1:return u=f.sent(),l=u.code,h=u.data,l!==Yg.SUCCESS?[2,{code:l}]:[2,{code:l,data:null==h?void 0:h.list}];case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.removeConversation=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return(r=this._channel)?(i=r.codec.encodeRemoveOldConversationList({conversationType:e,channelId:n,targetId:t}),o=new hA(Pw,i,t),[4,r.send(o)]):[3,2];case 1:return s=c.sent(),Mg.info("RemoveConversation =>",s),a=s.code,Yg.SUCCESS,[2,a];case 2:return[2,Yg.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype.getConversation=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return e!==ng.ULTRA_GROUP?[3,1]:(r=this._ultraGroupMap[n+"_"+t])?[3,3]:[2,{code:Yg.CONVER_GET_ERROR}];case 1:return(i=this._conversationManager.get(e,t,n))?[4,this.getHistoryMessage(e,t,0,1,0)]:[2,{code:Yg.CONVER_GET_ERROR}];case 2:if(o=u.sent(),s=o.code,a=o.data,s!==Yg.SUCCESS)return[2,{code:Yg.CONVER_GET_ERROR}];c=(null==a?void 0:a.list[0])||null,r={conversationType:e,targetId:t,channelId:n,unreadMessageCount:i.unreadMessageCount||0,latestMessage:c,notificationStatus:i.notificationStatus||$g.CLOSE,notificationLevel:i.notificationLevel||tv.NOT_SET,isTop:i.isTop||!1,lastUnreadTime:i.lastUnreadTime||0,unreadMentionedCount:i.unreadMentionedCount||0},u.label=3;case 3:return[2,{code:Yg.SUCCESS,data:r}]}}))}))},t.prototype.getAllConversationUnreadCount=function(e,t,n){var r=this._conversationManager.getAllUnreadCount(e,t,n);return Promise.resolve({code:Yg.SUCCESS,data:r})},t.prototype.getConversationUnreadCount=function(e,t,n){var r,i;return i=e===ng.ULTRA_GROUP?(null===(r=this._ultraGroupMap[n+"_"+t])||void 0===r?void 0:r.unreadMessageCount)||0:this._conversationManager.getUnreadCount(e,t,n),Promise.resolve({code:Yg.SUCCESS,data:i})},t.prototype.clearConversationUnreadCount=function(e,t,n){return this._conversationManager.clearUnreadCount(e,t,n,!1),Promise.resolve(Yg.SUCCESS)},t.prototype.clearAllUnreadCount=function(){return this._conversationManager.clearAllUnreadCount(),Promise.resolve(Yg.SUCCESS)},t.prototype.getFirstUnreadMessage=function(e,t){throw new Error("Method not implemented.")},t.prototype.saveConversationMessageDraft=function(e,t,n,r){return this._conversationManager.setDraft(e,t,n,r),Promise.resolve(Yg.SUCCESS)},t.prototype.getConversationMessageDraft=function(e,t,n){var r=this._conversationManager.getDraft(e,t,n);return Promise.resolve({code:Yg.SUCCESS,data:r})},t.prototype.clearConversationMessageDraft=function(e,t,n){return this._conversationManager.clearDraft(e,t,n),Promise.resolve(Yg.SUCCESS)},t.prototype.pullConversationStatus=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l=this;return da(this,(function(h){switch(h.label){case 0:return n=(t=this)._channel,r=t.currentUserId,n?(i=n.codec.encodeGetConversationStatus(e),o=new hA(jA[jA.pullSeAtts],i,r),[4,n.send(o,sO)]):[3,2];case 1:return s=h.sent(),a=s.code,c=s.data,a!==Yg.SUCCESS?[2,{code:a}]:(u=[],Array.isArray(c)&&c.forEach((function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,i=e.channelId,o=e.isTop,s=e.notificationLevel,a=l._ultraGroupMap[i+"_"+n];t===ng.ULTRA_GROUP?a&&(void 0!==r&&(a.notificationStatus=r),void 0!==s&&(a.notificationLevel=s),void 0===s&&void 0===r||l._ultraGroupManager.addUltraGroupStatus(e),"boolean"==typeof o&&(a.isTop=o)):u.push(e)})),[2,{code:a,data:u}]);case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.batchSetConversationStatus=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d=this;return da(this,(function(f){switch(f.label){case 0:return n=(t=this).currentUserId,(r=t._channel)?(i=r.codec.encodeSetConversationStatus(e),o=new hA(Dw,i,n),[4,r.send(o,lO)]):[3,2];case 1:return s=f.sent(),a=s.code,c=s.data,a===Yg.SUCCESS?(u=c,l=[],e.forEach((function(e){var t=e.conversationType,n=e.targetId,r=e.notificationStatus,i=e.notificationLevel,o=e.channelId,s=e.isTop;if(t===ng.ULTRA_GROUP){var a=d._ultraGroupMap[o+"_"+n];a&&(void 0!==r&&(a.notificationStatus=r),void 0!==i&&(a.notificationLevel=i),void 0===i&&void 0===r||d._ultraGroupManager.addUltraGroupStatus(a),void 0!==s&&(a.isTop=s),l.push(a))}else d._conversationManager.addStatus(la(la({},e),{updatedTime:u.version}),!0)})),l.length>0&&(h=Xy(l),h=tL(h),this._watcher.conversation(h)),[2,a]):[2,a];case 2:return[2,Yg.RC_NET_CHANNEL_INVALID]}}))}))},t.prototype._joinChrm=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u;return da(this,(function(l){switch(l.label){case 0:return(r=this._channel)?(i=r.codec.encodeJoinOrQuitChatRoom(),o=new hA(n?Nw:Mw,i,e),[4,r.send(o,CN)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return s=l.sent(),a=s.code,c=s.data,a===Yg.SUCCESS&&(u=c.joinTime,this._chrmsQueue[e]||(this._chrmsQueue[e]={pulling:!1,queue:[],timestamp:0}),this._pullChrmMsg(e,t,u),this.naviInfo.kvStorage&&this._chrmEntryHandler.pullEntry(e,0),this._joinedChrmManager.set(e,t),this._startSyncIntervalForChrmPull()),[2,a]}}))}))},t.prototype._rejoinChrm=function(){return ha(this,void 0,void 0,(function(){var e,t,n,r,i,o;return da(this,(function(s){switch(s.label){case 0:for(n in e=this._joinedChrmManager.get(),t=[],e)t.push(n);r=0,s.label=1;case 1:return r<t.length?(i=t[r],[4,this._joinChrm(i,e[i]||10,!0)]):[3,4];case 2:(o=s.sent())===Yg.SUCCESS?this._watcher.chatroom({rejoinedRoom:{chatroomId:i,count:e[i]}}):this._watcher.chatroom({rejoinedRoom:{chatroomId:i,errorCode:o}}),s.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype._pullChrmMsg=function(e,t,n){return void 0===t&&(t=10),void 0===n&&(n=0),ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l,h,d,f,p;return da(this,(function(g){switch(g.label){case 0:return this._channel?(r=this._chrmsQueue[e],i=r.pulling,o=r.timestamp,i?[2]:(r.pulling=!0,s=this._channel.codec.encodeChrmSyncMsg(o,t),a=new hA(jA[jA.chrmPull],s,e),[4,this._channel.send(a,nN,{connectedTime:this._channel.connectedTime,currentUserId:this.currentUserId})])):[2];case 1:return c=g.sent(),u=c.code,l=c.data,r.pulling=!1,u===Yg.SUCCESS&&l?(h=l.list,d=l.syncTime,f=l.finished,r.timestamp=n?Math.max(d,n):d,r.queue=r.queue.filter((function(e){return e>d})),p=[],h.forEach((function(e){e.sentTime<o||p.push(e)})),this._watcher.batchMessage(p),(!f||r.queue.length>0)&&this._pullChrmMsg(e),[2]):(Mg.warn("pull chatroom msg failed, code:",u,", data:",l),[2])}}))}))},t.prototype.joinChatroom=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._joinChrm(e,t,!1)]}))}))},t.prototype.joinExistChatroom=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._joinChrm(e,t,!0)]}))}))},t.prototype.quitChatroom=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o;return da(this,(function(s){switch(s.label){case 0:return(t=this._channel)?(n=t.codec.encodeJoinOrQuitChatRoom(),r=new hA(Ow,n,e),[4,t.send(r)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return i=s.sent(),(o=i.code)===Yg.SUCCESS&&(delete this._chrmsQueue[e],this._chrmEntryHandler.reset(e),this._joinedChrmManager.remove(e)),[2,o]}}))}))},t.prototype.getChatroomInfo=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return(r=this._channel)?(i=r.codec.encodeGetChatRoomInfo(t,n),o=new hA(jA[jA.queryChrmI],i,e),[4,r.send(o,TN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return s=u.sent(),a=s.code,c=s.data,a!==Yg.SUCCESS?[2,{code:a}]:[2,{code:a,data:c}]}}))}))},t.prototype.getChatroomHistoryMessages=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u;return da(this,(function(l){switch(l.label){case 0:return(i=this._channel)?(o=i.codec.encodeGetHistoryMsg(e,{timestamp:t,count:n,order:r}),s=new hA(Bw,o,e),[4,i.send(s,uN,{conversation:{targetId:e}})]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return a=l.sent(),c=a.code,u=a.data,c!==Yg.SUCCESS?[2,{code:c}]:[2,{code:c,data:{list:u.list,hasMore:u.hasMore}}]}}))}))},t.prototype._modifyChatroomKV=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:return r=(n=this)._channel,i=n.currentUserId,r?(o=this._chrmEntryHandler.getVersion(e,t.key),t.version=null==o?this.getServerTime():o,s=r.codec.encodeModifyChatRoomKV(e,t,i),a=t.type===av.UPDATE?ww:Aw,c=new hA(a,s,e),[4,r.send(c,CN)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return u=h.sent(),(l=u.code)===Yg.SUCCESS?(this._chrmEntryHandler.setLocal(e,{kvEntries:[t],syncTime:(new Date).getTime()},i),[2,l]):[2,l]}}))}))},t.prototype._modifyChatroomKVS=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l,h,d,f,p=this;return da(this,(function(g){switch(g.label){case 0:return r=(n=this)._channel,i=n.currentUserId,r?(t.entries.forEach((function(t){var n=p._chrmEntryHandler.getVersion(e,t.key);t.version=null==n?p.getServerTime():n})),o=r.codec.encodeModifyChatRoomKVS(e,t,i),s=t.type===av.UPDATE?Uw:bw,a=new hA(s,o,e),[4,r.send(a,zN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return c=g.sent(),u=c.code,-1!==[Yg.SUCCESS,Yg.CHATROOM_KV_STORE_NOT_ALL_SUCCESS].indexOf(u)&&(h=[],delete(d=Object.assign({},t)).entries,t.entries.forEach((function(e){h.push(Object.assign({},e,d))})),u===Yg.CHATROOM_KV_STORE_NOT_ALL_SUCCESS&&(f=c.data,Mg.warn("è®¾ç½®å¤±è´¥çå±æ§ï¼",f.errorKeys),l=f.errorKeys,f&&Array.isArray(f.errorKeys)&&f.errorKeys.forEach((function(e){var t=h.findIndex((function(t){return e.key===t.key}));-1!==t&&h.splice(t,1)}))),Mg.warn("è®¾ç½®æåçå±æ§ï¼",h),this._chrmEntryHandler.setLocal(e,{kvEntries:h,syncTime:(new Date).getTime()},i)),[2,{code:u,data:l}]}}))}))},t.prototype.setChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.UPDATE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.setChatroomEntries=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.UPDATE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKVS(e,t)]}))}))},t.prototype.forceSetChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.UPDATE,t.isOverwrite=!0,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.removeChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.DELETE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.removeChatroomEntries=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.DELETE,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKVS(e,t)]}))}))},t.prototype.forceRemoveChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.type=av.DELETE,t.isOverwrite=!0,t.userId=t.userId||this.currentUserId,[2,this._modifyChatroomKV(e,t)]}))}))},t.prototype.getChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return(n=this._chrmEntryHandler.getValue(e,t))?[2,Promise.resolve({code:Yg.SUCCESS,data:n})]:[3,1];case 1:return(r=this._channel)?(i=r.codec.encodePullChatRoomKV(0),o=new hA(jA[jA.pullKV],i,e),[4,r.send(o,JN)]):[2,Promise.reject({code:Yg.RC_NET_CHANNEL_INVALID})];case 2:return s=u.sent(),(a=s.data||{})&&a.kvEntries&&a.kvEntries.length&&(c=a.kvEntries.find((function(e){return e.key===t})),void 0!==c)?[2,Promise.resolve({code:Yg.SUCCESS,data:null==c?void 0:c.value})]:[2,Promise.resolve({code:Yg.CHATROOM_KEY_NOT_EXIST})]}}))}))},t.prototype.getAllChatroomEntry=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return(t=this._chrmEntryHandler.getAll(e))&&Object.keys(t).length?[2,Promise.resolve({code:Yg.SUCCESS,data:t})]:[3,1];case 1:return(n=this._channel)?(r={},i=n.codec.encodePullChatRoomKV(0),o=new hA(jA[jA.pullKV],i,e),[4,n.send(o,JN)]):[2,Promise.reject({code:Yg.RC_NET_CHANNEL_INVALID})];case 2:return s=c.sent(),(a=s.data||{})&&a.kvEntries&&a.kvEntries.length&&a.kvEntries.forEach((function(e){e.key&&(r[e.key]=e.value||"")})),[2,Promise.resolve({code:Yg.SUCCESS,data:r})]}}))}))},t.prototype.pullChatroomEntry=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l,h,d,f;return da(this,(function(p){switch(p.label){case 0:return r=(n=this)._channel,i=n.currentUserId,r?(t||(t=this._pullChatroomEntryTimestamp),o=r.codec.encodePullChatRoomKV(t),s=new hA(jA[jA.pullKV],o,e),[4,r.send(s,JN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return a=p.sent(),c=a.code,u=a.data,c===Yg.SUCCESS?(Mg.info("Pull success ChrmKV, "+JSON.stringify(a)),this._chrmEntryHandler.setLocal(e,u,i),Mg.info("Save into cache success!"),h=(l=u).kvEntries,d=l.syncTime,this._pullChatroomEntryTimestamp=d||0,f=[],h.length>0&&(h.forEach((function(t){var n=t.key,r=t.value,i=t.type,o=t.timestamp;f.push({key:n,value:r,type:i,timestamp:o,chatroomId:e})})),this._watcher.chatroom({updatedEntries:f})),[2,{code:c,data:u}]):[2,{code:c}]}}))}))},t.prototype._startSyncIntervalForChrmPull=function(){var e=this;this._stopSyncIntervalForChrmPull(),this._intervalTimerForChrmPull=setInterval((function(){var t=Object.keys(e._chrmsQueue);0!==t.length&&e._channel?t.forEach((function(t){e._pullChrmMsg(t),e.naviInfo.kvStorage&&e._chrmEntryHandler.pullEntry(t,0)})):e._stopSyncIntervalForChrmPull()}),ta)},t.prototype._stopSyncIntervalForChrmPull=function(){"number"!=typeof this._intervalTimerForChrmPull&&(clearInterval(this._intervalTimerForChrmPull),this._intervalTimerForChrmPull=-1)},t.prototype.sendMessage=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l,h,d;return da(this,(function(f){switch(f.label){case 0:return this._channel?(n=function(e,t){return"RC:SRSMsg"===e.messageType&&Object.assign(e,{directionalUserIdList:[t]}),e}(n,this.currentUserId),n=this._handleMsgProperties(n,!0),r=!![ng.PRIVATE,ng.GROUP].includes(e)&&n.isStatusMessage,i=r?function(e){var t;return(t={},t[ng.PRIVATE]=jA.ppMsgS,t[ng.GROUP]=jA.pgMsgS,t)[e]}(e):function(e){var t;return(t={},t[ng.PRIVATE]=jA.ppMsgP,t[ng.GROUP]=jA.pgMsgP,t[ng.CHATROOM]=jA.chatMsg,t[ng.CUSTOMER_SERVICE]=jA.pcMsgP,t[ng.RTC_ROOM]=jA.prMsgS,t)[e]}(e)||jA.ppMsgP,r&&(n.isPersited=!1,n.isCounted=!1),o=this._channel.codec.encodeUpMsg({conversationType:e,targetId:t},n),(s=new cA(jA[i],o,t)).setHeaderQos(PM.AT_LEAST_ONCE),r?(this._channel.sendOnly(s),[2,{code:Yg.SUCCESS,data:eL(e,t,la({},n),"",0,this.currentUserId)}]):(a=Date.now()-this._localConnectedTime+this._connectedTime,c=eL(e,t,la({},n),"",a,this.currentUserId),[4,this._channel.send(s)])):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return u=f.sent(),l=u.code,h=u.data,l!==Yg.SUCCESS?[2,{code:l,data:c}]:(d=h,this._sendMessageStore.setMessage(d.messageUId,d.timestamp),c.sentTime=d.timestamp,c.messageUId=d.messageUId,this._conversationManager.setConversationCacheByMessage(c,!0),[2,{code:Yg.SUCCESS,data:c}])}}))}))},t.prototype.recallMsg=function(e,t,n,r,i){var o;return ha(this,void 0,void 0,(function(){var s,a,c,u,l,h,d,f,p,g,v,y,m;return da(this,(function(_){switch(_.label){case 0:return this._channel?(s=i.user,a=i.extra,c=i.isDelete,u={conversationType:e,targetId:t,messageUId:n,sentTime:r,channelId:i.channelId||"",isDelete:c||!1},s&&(u.user=s),a&&(u.extra=a),l={content:u,messageType:"RC:RcCmd",disableNotification:null==i?void 0:i.disableNotification,pushConfig:null==i?void 0:i.pushConfig,pushContent:(null===(o=i.pushConfig)||void 0===o?void 0:o.pushContent)||i.pushContent||"",channelId:i.channelId},h=jA[jA.recallMsg],d=this._channel.codec.encodeUpMsg({conversationType:e,targetId:t},l),(f=new cA(h,d,this.currentUserId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(f)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return p=_.sent(),g=p.code,v=p.data,g!==Yg.SUCCESS?[2,{code:g}]:(y=v,e===ng.ULTRA_GROUP?(this._ultraMsgMap[y.messageUId]=y.timestamp,this._updateUltraGroupWhenRecallMsg(t,i.channelId||"",n),[2,{code:Yg.SUCCESS}]):(this._sendMessageStore.setMessage(y.messageUId,y.timestamp),m=eL(e,t,la(la({},l),{isPersited:!0}),y.messageUId,y.timestamp,this.currentUserId),this._conversationManager.setConversationCacheByMessage(m,!0),[2,{code:Yg.SUCCESS,data:m}]))}}))}))},t.prototype.sendReadReceiptMessage=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeReadReceipt(t,n),i=new hA(jA[jA.rrMsg],r,e),[4,this._channel.send(i)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return[2,o.sent()]}}))}))},t.prototype.getMessageReader=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeMessageReader(t,n),i=new hA(jA[jA.rrList],r,e),[4,this._channel.send(i,vO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return[2,o.sent()]}}))}))},t.prototype.pullUserSettings=function(e){return ha(this,void 0,void 0,(function(){var t,n;return da(this,(function(r){return this._channel?(t=this._channel.codec.encodePullUserSetting(e),n=new hA(jA[jA.pullUS],t,this.currentUserId),[2,this._channel.send(n,rO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.getFileToken=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u;return da(this,(function(l){switch(l.label){case 0:return this._channel?(i=r&&"uploads"!==r?t||"":Vy(e,t),o=this._channel.codec.encodeGetFileToken(e,i,n||"",r||""),s=new hA(jA[jA.qnTkn],o,this.currentUserId),[4,this._channel.send(s,GN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return a=l.sent(),c=a.code,u=a.data,u=Object.assign(u,{fileName:i}),c===Yg.SUCCESS?[2,{code:c,data:u}]:[2,{code:c}]}}))}))},t.prototype.getFileUrl=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u,l,h,d;return da(this,(function(f){switch(f.label){case 0:return this._channel?(i="",o="",s="",t===ov.QINIU?(o=FN,s=qN):(o=KN,s=HN),i=t===ov.QINIU?jA[jA.qnUrl]:t===ov.AWS?jA[jA.s3Url]:t===ov.STC?jA[jA.stcUrl]:jA[jA.aliUrl],a=this._channel.codec.encodeGetFileUrl(o,e,n,r),c=new hA(i,a,this.currentUserId),[4,this._channel.send(c,s)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return u=f.sent(),l=u.code,h=u.data,d=h,l===Yg.SUCCESS?[2,{code:l,data:d}]:[2,{code:l}]}}))}))},t.prototype.disconnect=function(){-1!==this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=-1),this._channel&&(this._channel.close(),this._channel=void 0),this._pullQueue.length=0,this._stopSyncInterval(),this.resetUltraGroupData()},t.prototype.resetUltraGroupData=function(){this._stopUltraSyncInterval(),this._lastSyncUltraMsgTimeStamp=0,this._lastSyncUltraMsgLocalTimeStamp=0,this._isUltraPulling=!1,this._ultraGroupTimeQue=[],this._isUltraGroupListExist=!1,this._ultraGroupMap={}},t.prototype.destroy=function(){throw new Error("JSEngine's method not implemented.")},t.prototype.registerMessageType=function(e,t,n,r,i){this._customMessageType[e]={isPersited:t,isCounted:n,isStatusMessage:i}},t.prototype.getServerTime=function(){return Date.now()-this._localConnectedTime+this._connectedTime},t.prototype.getCurrentUserId=function(){return this.currentUserId},t.prototype.createTag=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeCreateTag([e],t),r=new hA(jA[jA.addSeTag],n,this.currentUserId),[4,this._channel.send(r,tO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Yg.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.addTag([la(la({},e),{createdTime:a})],a),[2,{code:Yg.SUCCESS,data:s}])}}))}))},t.prototype.removeTag=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeRemoveTag([e],t),r=new hA(jA[jA.delSeTag],n,this.currentUserId),[4,this._channel.send(r,tO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Yg.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.deleteTag([e],a),[2,{code:Yg.SUCCESS}])}}))}))},t.prototype.updateTag=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?(t=this._userSettingManager.getVersion(),n=this._channel.codec.encodeCreateTag([e],t),r=new hA(jA[jA.addSeTag],n,this.currentUserId),[4,this._channel.send(r,tO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Yg.SUCCESS?[2,{code:o}]:(a=s.version,this._userSettingManager.addTag([e],a),[2,{code:Yg.SUCCESS,data:s}])}}))}))},t.prototype.getTagList=function(){return ha(this,void 0,void 0,(function(){var e,t;return da(this,(function(n){return e=this._userSettingManager.getTags(),t=this._conversationManager.getConversationListForTag(),e.forEach((function(e){e.conversationCount=t[e.tagId]?t[e.tagId].length:0})),[2,{code:Yg.SUCCESS,data:e}]}))}))},t.prototype.addTagForConversations=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s=this;return da(this,(function(a){switch(a.label){case 0:return this._channel?this._userSettingManager.getTagById(e)?(n=this._channel.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new hA(jA[jA.addTag],n,this.currentUserId),[4,this._channel.send(r)]):[2,{code:Yg.TAG_NOT_EXIST}]:[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return(i=a.sent().code)!==Yg.SUCCESS?[2,{code:i}]:((o={})[e]={},t.forEach((function(e){s._conversationManager.addTagStatus(e.conversationType,e.targetId,o,e.channelId)})),[2,{code:Yg.SUCCESS}])}}))}))},t.prototype.removeTagForConversations=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o=this;return da(this,(function(s){switch(s.label){case 0:return this._channel?(n=this._channel.codec.encodeUpdateConversationTag([{tagId:e}],t),r=new hA(jA[jA.delTag],n,this.currentUserId),[4,this._channel.send(r)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return(i=s.sent().code)!==Yg.SUCCESS?[2,{code:i}]:(t.forEach((function(t){o._conversationManager.deleteTagStatus(t.conversationType,t.targetId,[e],t.channelId)})),[2,{code:Yg.SUCCESS}])}}))}))},t.prototype.removeTagsForConversation=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return this._channel?(n=e.conversationType,r=e.targetId,i=e.channelId,o=t.map((function(e){return{tagId:e}})),s=this._channel.codec.encodeUpdateConversationTag(o,[e]),a=new hA(jA[jA.delTag],s,this.currentUserId),[4,this._channel.send(a)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return(c=u.sent().code)!==Yg.SUCCESS?[2,{code:c}]:(this._conversationManager.deleteTagStatus(n,r,t,i),[2,{code:Yg.SUCCESS}])}}))}))},t.prototype.getConversationListByTag=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l,h;return da(this,(function(d){switch(d.label){case 0:return i=(r=this).currentUserId,(o=r._channel)?(s=o.codec.encodeOldConversationList({count:n,type:ng.PRIVATE,startTime:t}),a=new hA(Lw,s,i),[4,o.send(a,hN,{currentUserId:i,connectedTime:o.connectedTime})]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return c=d.sent(),u=c.code,l=c.data,h=this._conversationHasTagFilter(e,null==l?void 0:l.list),Mg.info("GetConversationListByTag",h),u!==Yg.SUCCESS?[2,{code:u}]:[2,{code:u,data:h}]}}))}))},t.prototype._conversationHasTagFilter=function(e,t){var n=this,r=[],i=[];function o(e,t){return e.latestMessage&&t.latestMessage?e.latestMessage.sentTime-t.latestMessage.sentTime:0}return t.forEach((function(t){var o=t.conversationType,s=t.targetId,a=t.channelId,c=n._conversationManager.get(o,s,a),u=c.hasMentioned,l=c.mentionedInfo,h=c.lastUnreadTime,d=c.notificationStatus,f=c.isTop,p=c.tags,g=c.unreadMessageCount,v=p&&p[e];if(v){var y=la(la({},t),{hasMentioned:u,mentionedInfo:l,lastUnreadTime:h,notificationStatus:d,isTop:f,unreadMessageCount:g});v.isTop?r.push(la(la({},y),{isTopInTag:!0})):i.push(la(la({},y),{isTopInTag:!1}))}})),fa(fa([],r.sort(o),!0),i.sort(o),!0)},t.prototype.getUnreadCountByTag=function(e,t){return ha(this,void 0,void 0,(function(){var n;return da(this,(function(r){return this._channel?(n=this._conversationManager.getUnreadCountByTag(e,t),[2,{code:Yg.SUCCESS,data:n}]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.setConversationStatusInTag=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l,h,d;return da(this,(function(f){switch(f.label){case 0:return this._channel?(r=t.targetId,i=t.conversationType,o=t.channelId,s=n.isTop,a=[{tagId:e,isTop:s}],(c=this._conversationManager.get(i,r,o)).tags&&Object.hasOwnProperty.call(c.tags,e)?(u=this._channel.codec.encodeUpdateConversationTag(a,[t]),l=new hA(jA[jA.addTag],u,this.currentUserId),[4,this._channel.send(l)]):[2,{code:Yg.NO_TAG_IN_CONVER}]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return(h=f.sent().code)!==Yg.SUCCESS?[2,{code:h}]:((d={})[e]={},s&&(d[e].isTop=!0),this._conversationManager.addTagStatus(i,r,d,o),[2,{code:Yg.SUCCESS}])}}))}))},t.prototype.getTagsForConversation=function(e){var t;return ha(this,void 0,void 0,(function(){var n,r,i,o;return da(this,(function(s){if(!this._channel)return[2,{code:Yg.RC_NET_CHANNEL_INVALID}];if(n=this._conversationManager.get(e.conversationType,e.targetId,e.channelId),r=this._userSettingManager.getTagsInfo(),i=[],n.tags)for(o in n.tags)i.push({tagId:o,tagName:null===(t=r[o])||void 0===t?void 0:t.tagName});return[2,{code:Yg.SUCCESS,data:i}]}))}))},t.prototype.getBlockConversationList=function(){var e=this._conversationManager.getBlockConversationList();return Promise.resolve({code:Yg.SUCCESS,data:e})},t.prototype.getTopConversationList=function(){var e=this._conversationManager.getTopConversationList();return Promise.resolve({code:Yg.SUCCESS,data:e})},t.prototype.getUnreadMentionedCount=function(e){var t,n;return n=e.conversationType===ng.ULTRA_GROUP?(null===(t=this._ultraGroupMap[e.channelId+"_"+e.targetId])||void 0===t?void 0:t.unreadMentionedCount)||0:this._conversationManager.getUnreadMentionedCount(e.channelId,e.conversationType,e.targetId),Promise.resolve({code:Yg.SUCCESS,data:n})},t.prototype.getAllUnreadMentionedCount=function(){var e=this._conversationManager.getAllUnreadMentionedCount();return Promise.resolve({code:Yg.SUCCESS,data:e})},t.prototype.getConversationNotificationLevel=function(e,t,n){if(!this._isUltraGroupListExist&&e===ng.ULTRA_GROUP)return Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE});var r;if(!(r=e===ng.ULTRA_GROUP?this._ultraGroupManager.get(ng.ULTRA_GROUP,t,n):this._conversationManager.get(e,t,n)))return Promise.resolve({code:Yg.SUCCESS,data:tv.NOT_SET});var i=r.notificationLevel;return yg(r.notificationLevel)&&!yg(r.notificationStatus)&&(i=$g.OPEN===r.notificationStatus?1:0),Promise.resolve({code:Yg.SUCCESS,data:i})},t.prototype.getConversationNotificationStatus=function(e,t,n){var r;return(r=e===ng.ULTRA_GROUP?this._ultraGroupManager.get(ng.ULTRA_GROUP,t,n):this._conversationManager.get(e,t,n))?Promise.resolve({code:Yg.SUCCESS,data:r.notificationStatus}):Promise.resolve({code:Yg.SUCCESS,data:$g.CLOSE})},t.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){return this.getHistoryMessage(e,t,n,r,i,o)},t.prototype.getUltraGroupList=function(){return ha(this,void 0,void 0,(function(){var e,t;return da(this,(function(n){return this._isUltraGroupListExist?(e=Object.values(this._ultraGroupMap),e=tL(e),t=Xy(e),[2,{code:Yg.SUCCESS,data:t}]):[2,{code:Yg.METHOD_NOT_AVAILABLE}]}))}))},t.prototype.getBlockUltraGroupList=function(){if(!this._isUltraGroupListExist)return Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE});var e=Object.values(this._ultraGroupMap),t=[];return e.forEach((function(e){e.notificationStatus===$g.OPEN&&t.push({conversationType:ng.ULTRA_GROUP,targetId:e.targetId,channelId:e.channelId})})),Promise.resolve({code:Yg.SUCCESS,data:t})},t.prototype.getTopUltraGroupList=function(){if(!this._isUltraGroupListExist)return Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE});var e=Object.values(this._ultraGroupMap),t=[];return e.forEach((function(e){!0===e.isTop&&t.push({conversationType:ng.ULTRA_GROUP,targetId:e.targetId,channelId:e.channelId})})),Promise.resolve({code:Yg.SUCCESS,data:t})},t.prototype.getUltraGroupUnreadMentionedCountByTargetId=function(e){if(!this._isUltraGroupListExist)return Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE});var t=0;for(var n in this._ultraGroupMap){n.match(/_.*/g)[0].substring(1)===e&&(t+=this._ultraGroupMap[n].unreadMentionedCount)}return Promise.resolve({code:Yg.SUCCESS,data:t})},t.prototype.getUltraGroupUnreadCountByTargetId=function(e){var t=0;for(var n in this._ultraGroupMap){var r=this._ultraGroupMap[n];r.targetId===e&&(t+=r.unreadMessageCount||0)}return Promise.resolve({code:Yg.SUCCESS,data:t})},t.prototype.getAllUltraGroupUnreadCount=function(e){if(void 0===e&&(e=!1),!this._isUltraGroupListExist)return Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE});var t=0;for(var n in this._ultraGroupMap)t+=e?this._ultraGroupMap[n].unreadMentionedCount||0:this._ultraGroupMap[n].unreadMessageCount||0;return Promise.resolve({code:Yg.SUCCESS,data:t})},t.prototype.clearUltraUnreadcount=function(e,t){return void 0===t&&(t=""),ha(this,void 0,void 0,(function(){var n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._isUltraGroupListExist?this._channel?this._status!==Qg.CONNECTED?[2,Yg.RC_NET_UNAVAILABLE]:(n=Date.now(),r=this._channel.codec.encodeClearUnreadCount({conversationType:ng.ULTRA_GROUP,targetId:e,channelId:t},{timestamp:n}),(i=new cA(jA[jA.updUgRTime],r,this.currentUserId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(i)]):[2,Yg.RC_NET_CHANNEL_INVALID]:[2,Promise.resolve(Yg.METHOD_NOT_AVAILABLE)];case 1:return(o=a.sent().code)===Yg.SUCCESS&&(s=this._ultraGroupMap[t+"_"+e])&&(s.unreadMessageCount=0,s.unreadMentionedCount=0,s.lastReadTime=n),[2,o]}}))}))},t.prototype._getUltraGroupList=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d,f,p=this;return da(this,(function(g){switch(g.label){case 0:return this._channel&&this._status===Qg.CONNECTED?(!1,t=this._channel.codec.encodeUltraGroup(e,false),n=new hA(jA[jA.pullUgSes],t,this.currentUserId),[4,this._channel.send(n,hN,{currentUserId:this.currentUserId,conversationType:ng.ULTRA_GROUP})]):[2];case 1:return r=g.sent(),i=r.code,o=r.data,i===Yg.SUCCESS&&o?(a=(null==o?void 0:o.list)||[],c=null==o?void 0:o.isFinished,a.forEach((function(e){e.notificationStatus=$g.CLOSE,e.notificationLevel=tv.NOT_SET,e.isTop=!1,p._ultraGroupMap[e.channelId+"_"+e.targetId]=e,p._ultraGroupManager.addUltraGroupStatus(e)})),!1!==c?[3,2]:(u=a.length>0&&a[a.length-1].versionTime||0,this._getUltraGroupList(u),[3,4])):(Mg.warn("pull super conversation  failed, code:",i,", data:",o,"retrying..."),s=setTimeout((function(){p._firstPullUltraGroupTime=e,p._getUltraGroupList(e),clearTimeout(s)}),3e3),[2]);case 2:return[4,this.pullConversationStatus(this._firstPullUltraGroupTime)];case 3:l=g.sent(),h=l.code,d=l.data,h!==Yg.SUCCESS&&Mg.warn("pullConversationStatus fail code: ".concat(h,", data: ").concat(d)),f=Object.values(this._ultraGroupMap),f=tL(f),this._isUltraGroupListExist=!0,this._watcher.ultraGroupEnable(Xy(f)),0===this._firstPullUltraGroupTime&&this._syncUltraMsg(this._lastSyncUltraMsgTimeStamp),g.label=4;case 4:return[2]}}))}))},t.prototype._startUltraSyncInterval=function(){var e=this;this._lastSyncUltraMsgLocalTimeStamp=Date.now(),this._syncUltraMsg(0),function t(){e._ultraGroupTimer=setTimeout((function(){Date.now()-e._lastSyncUltraMsgLocalTimeStamp>=18e4&&e._syncUltraMsg(e._lastSyncUltraMsgTimeStamp),e._stopUltraSyncInterval(),t()}),3e4)}()},t.prototype._stopUltraSyncInterval=function(){-1!==this._ultraGroupTimer&&(clearTimeout(this._ultraGroupTimer),this._ultraGroupTimer=-1)},t.prototype._syncUltraMsg=function(e){var t;return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l,h,d,f,p=this;return da(this,(function(g){switch(g.label){case 0:return this._channel&&this._status===Qg.CONNECTED?this._isUltraPulling?[2]:(Mg.info("start pull ultra msg, time: ".concat(e)),this._isUltraPulling=!0,n=this._channel.codec.encodeSuperSyncMsg(e),r=new hA(jA[jA.pullUgMsg],n,this.currentUserId),[4,this._channel.send(r,nN,{currentUserId:this.currentUserId,conversation:{conversationType:ng.ULTRA_GROUP}})]):[2];case 1:if(i=g.sent(),o=i.code,s=i.data,Mg.info("end pull ultra msg, code: ".concat(o,", syncTime: ").concat(null==s?void 0:s.syncTime,", count: ").concat(null===(t=null==s?void 0:s.list)||void 0===t?void 0:t.length)),this._lastSyncUltraMsgLocalTimeStamp=Date.now(),o!==Yg.SUCCESS||!s)return Mg.warn("sync super  message  failed, code:",o,", data:",s),this._isUltraPulling=!1,[2];if(this._isUltraPulling=!1,a=s.list,c=s.syncTime,u=s.finished,!this._isUltraGroupListExist)return Mg.info("init getUltraGroupList"),this._firstPullUltraGroupTime=0,this._getUltraGroupList(0),this._lastSyncUltraMsgTimeStamp=c,[2];for(f in l={},h=[],a.forEach((function(e){var t,n,r,i=e.targetId,o=e.content,s=e.messageType,a=e.messageUId,u=e.channelId,d=e.isCounted;if(p._ultraMsgMap[a])delete p._ultraMsgMap[a];else{var f=0;((null===(t=null==o?void 0:o.mentionedInfo)||void 0===t?void 0:t.type)===rv.ALL||(null===(r=null===(n=null==o?void 0:o.mentionedInfo)||void 0===n?void 0:n.userIdList)||void 0===r?void 0:r.includes(p.currentUserId)))&&(f=1);var g=p._ultraGroupMap[u+"_"+i];if(g)d&&(s===Xg.RECALL?g.unreadMessageCount>0&&(g.unreadMessageCount-=1):(g.unreadMessageCount+=1,g.unreadMentionedCount+=f)),g.versionTime=c,g.latestMessage=e,l[u+"_"+i]=g,p._ultraGroupManager.addUltraGroupStatus(g);else{var v={conversationType:ng.ULTRA_GROUP,targetId:i,channelId:u,unreadMessageCount:d?1:0,unreadMentionedCount:d?f:0,versionTime:c,latestMessage:e,notificationStatus:$g.CLOSE,notificationLevel:tv.NOT_SET,isTop:!1};p._ultraGroupMap[u+"_"+i]=v,l[u+"_"+i]=v,p._ultraGroupManager.addUltraGroupStatus(v)}h.push(e)}})),Object.keys(l).length>0&&(Mg.info("notice ultragroups"),d=Object.values(l),d=tL(d),this._watcher.conversation(Xy(d))),Mg.info("notice ultragroup message"),this._watcher.batchMessage(h),this._ultraGroupTimeQue=this._ultraGroupTimeQue.filter((function(e){return e>c})),this._ultraMsgMap)this._ultraMsgMap[f]<c&&delete this._ultraMsgMap[f];return!1===u?this._syncUltraMsg(c):a&&a.length>0&&(this._lastSyncUltraMsgTimeStamp=c),this._ultraGroupTimeQue.length>0&&this._syncUltraMsg(this._lastSyncUltraMsgTimeStamp),[2]}}))}))},t.prototype.sendUltraMessage=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c,u,l,h;return da(this,(function(d){switch(d.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:("RC:SRSMsg"===t.messageType&&Mg.warn("ultra group -> direction message convert to message"),t=this._handleMsgProperties(t,!0),n=this._channel.codec.encodeUpMsg({conversationType:ng.ULTRA_GROUP,targetId:e},t),(r=new cA(jA[jA.ugMsg],n,e)).setHeaderQos(PM.AT_LEAST_ONCE),i=Date.now()-this._localConnectedTime+this._connectedTime,o=eL(ng.ULTRA_GROUP,e,la({},t),"",i,this.currentUserId),[4,this._channel.send(r)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return s=d.sent(),a=s.code,c=s.data,a!==Yg.SUCCESS?[2,{code:a,data:o}]:(u=c,o.sentTime=u.timestamp,o.messageUId=u.messageUId,this._ultraMsgMap[u.messageUId]=u.timestamp,l=t.channelId||"",(h=this._ultraGroupMap[l+"_"+e])?h.latestMessage=o:(h={conversationType:ng.ULTRA_GROUP,targetId:e,channelId:l,unreadMessageCount:0,unreadMentionedCount:0,versionTime:o.sentTime,latestMessage:o,notificationStatus:$g.CLOSE,notificationLevel:tv.NOT_SET,isTop:!1},this._ultraGroupMap[l+"_"+e]=h,this._ultraGroupManager.addUltraGroupStatus(h)),this._watcher.conversation(Xy([h])),[2,{code:a,data:o}])}}))}))},t.prototype.sendUltraGroupTypingStatus=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:(n=e.conversationType,r=e.channelId,i=e.targetId,o=this._channel.codec.encodeOperateStatus(i,n,r||"",t||0),(s=new cA(jA[jA.operate],o,i)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(s)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return(a=c.sent().code)!==Yg.SUCCESS?[2,{code:a,msg:Yg[a]}]:[2,{code:a}]}}))}))},t.prototype.getUltraGroupMessageListByMessageUId=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:e.messages&&e.messages.length<1||e.messages&&e.messages.length>20?[2,{code:Yg.MSG_LIMIT_ERROR}]:(t={},e.messages.forEach((function(e){t[e.messageUId]=void 0})),n=this._channel.codec.encodeMsgQuery(e),(r=new hA(jA[jA.qryMsg],n,this.currentUserId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(r,bO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return i=c.sent(),o=i.code,s=i.data,o!==Yg.SUCCESS?[2,{code:o,msg:Yg[o]}]:(a=(s||{}).list,Array.isArray(a)&&a.forEach((function(e){var n=e.messageUId;t[n]=e})),[2,{code:0,data:t}])}}))}))},t.prototype._pullOperateStatusNotify=function(e){if(this._channel){var t=this._channel.codec.decodeByPBName(e.data,PO),n=t.conversationType,r=t.info,i=t.summary;Mg.info("s_opNtf -> type: ".concat(n,", info: ").concat(r,", summary: ").concat(i)),this._watcher.operateStatus(t)}},t.prototype.expandUltraMessage=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:(t=this._channel.codec.encodeExpandUltraMessage(e,this.currentUserId),(n=new cA(jA[jA.upMsgEx],t,e.targetId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(n)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return r=a.sent(),i=r.code,o=r.data,i!==Yg.SUCCESS?[2,{code:i,msg:Yg[i]}]:(s=o,this._ultraMsgMap[s.messageUId]=s.timestamp,[2,{code:i}])}}))}))},t.prototype.modifyMessage=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:(t=this._channel.codec.encodemodifyMessage(e,this.currentUserId),(n=new cA(jA[jA.modifyMsg],t,e.targetId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(n)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return r=a.sent(),i=r.code,o=r.data,i!==Yg.SUCCESS?[2,{code:i,msg:Yg[i]}]:(s=o,this._ultraMsgMap[s.messageUId]=s.timestamp,[2,{code:i}])}}))}))},t.prototype._pullUltraChangeMessageList=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h,d,f,p,g,v,y,m=this;return da(this,(function(_){switch(_.label){case 0:return this._channel?this._status!==Qg.CONNECTED||this._isPullingUltraChangeMessage?[2]:(this._isPullingUltraChangeMessage=!0,t=this._channel.codec.encodeQueryMsgChange(e),(n=new cA(jA[jA.qryMsgChange],t,this.currentUserId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(n,wO)]):[2];case 1:if(r=_.sent(),i=r.code,o=r.data,this._isPullingUltraChangeMessage=!1,i!==Yg.SUCCESS)return[2];for(p in a=(s=o||{}).hasNext,c=s.list,u=(null==o?void 0:o.syncTime)||0,l=[],h={},Array.isArray(c)&&c.forEach((function(e){var t=e,n=t.targetId,r=t.conversationType,i=t.sendTime,o=t.messageUId,s=t.changeType,a=t.operatorId,c=e.channelId||"",u=r+"_"+n,d=o+"_"+c+"_"+i,f=h[u];if(f)f.add(d);else{var p=new Set([d]);h[u]=p}3!==s?m._ultraMsgChangeMap[o]=s:(m._updateUltraGroupWhenRecallMsg(n,c,o),l.push({targetId:n,conversationType:r,sendTime:i,messageUId:o,senderUserId:a,channelId:c}))})),Array.isArray(l)&&l.length>0&&this._watcher.ultraGroupMessageRecalled(l),d=function(e){var t=e.split("_"),n=t.shift(),r=t.join("_"),i=h[e],o=[];i.forEach((function(e){var t=e.split("_"),n=t[0],r=t[1],i=t[2];o.push({sendTime:Number(i),messageUId:n,channelId:r})}));var s={targetId:r,conversationType:Number(n),messages:o};f._pullUltraMessageList(s)},f=this,h)d(p);for(v in g=this._pullUltraChangeMessageQue.filter((function(e){return e>u})),this._pullUltraChangeMessageQue.length=0,(y=this._pullUltraChangeMessageQue).push.apply(y,g),this._ultraMsgMap)this._ultraMsgMap[v]<u&&delete this._ultraMsgMap[v];return a?this._pullUltraChangeMessageList(u):this._lastPullingUltraChangeMessageTime=u,[2]}}))}))},t.prototype._pullUltraMessageList=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u=this;return da(this,(function(l){switch(l.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:(t=this._channel.codec.encodeMsgQuery(e),(n=new hA(jA[jA.qryMsg],t,this.currentUserId)).setHeaderQos(PM.AT_LEAST_ONCE),[4,this._channel.send(n,bO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return r=l.sent(),i=r.code,o=r.data,i!==Yg.SUCCESS?[2,{code:i,msg:Yg[i]}]:(s=(o||{}).list,a=[],c=[],Array.isArray(s)&&s.forEach((function(e){var t=e.targetId,n=e.channelId,r=e.messageUId,i=u._ultraGroupMap[n+"_"+t];i&&i.latestMessage.messageUId===e.messageUId&&(i.latestMessage=e);var o=u._ultraMsgChangeMap[r+""];1===o?a.push(e):2===o&&c.push(e)})),a.length>0&&this._watcher.ultraGroupMessageExpansionUpdated(a||[]),c.length>0&&this._watcher.ultraGroupMessageModified(c||[]),[2])}}))}))},t.prototype.getUltraHistoryMsg=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s;return da(this,(function(a){switch(a.label){case 0:return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:(n=this._channel.codec.encodeGetHistoryMsg(e,t),r=new hA(jA[jA.qryUgMsg],n,this.currentUserId),[4,this._channel.send(r,uN,{currentUserId:this.currentUserId,conversation:{conversationType:ng.ULTRA_GROUP,targetId:e}})]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return i=a.sent(),o=i.code,s=i.data,o===Yg.SUCCESS&&s?[2,{code:o,data:s}]:(Mg.warn("get super history message  failed, code:",o,", data:",s),[2,{code:o}])}}))}))},t.prototype.searchUltraGroupMessages=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(e){return this._channel?this._status!==Qg.CONNECTED?[2,{code:Yg.RC_NET_UNAVAILABLE}]:[2,{code:Yg.SUCCESS}]:[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.setUltraGroupDefaultNotificationLevel=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._isUltraGroupListExist?(r=this._channel)?(i=r.codec.encodeSetUltraGroupDefaultNotificationLevel(t,n),o=new hA(jA[jA.ugUnpushSet],i,e),[4,r.send(o)]):[3,2]:[2,Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE})];case 1:return s=c.sent(),a=s.code,Yg.SUCCESS,[2,{code:a}];case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype.getUltraGroupDefaultNotificationLevel=function(e,t){return ha(this,void 0,void 0,(function(){var n,r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return this._isUltraGroupListExist?(n=this._channel)?(r=n.codec.encodeGetUltraGroupDefaultNotificationLevel(t),i=new hA(jA[jA.ugUnpushQuery],r,e),[4,n.send(i,fO)]):[3,2]:[2,Promise.resolve({code:Yg.METHOD_NOT_AVAILABLE})];case 1:return o=u.sent(),s=o.code,a=o.data,s===Yg.SUCCESS&&a?(c=a.unpushLevel,[2,{code:s,data:c}]):[2,{code:s}];case 2:return[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}}))}))},t.prototype._updateUltraGroupWhenRecallMsg=function(e,t,n){var r="".concat(t,"_").concat(e);if(this._ultraGroupMap[r]){var i=this._ultraGroupMap[r],o=i.latestMessage;o&&o.messageUId===n&&(i.latestMessage=null)}},t.prototype.getAllConversationState=function(){return Promise.resolve({code:Yg.SUCCESS,data:this._conversationManager.getAllConversationState()})},t.prototype.joinRTCRoom=function(e,t,n,r,i,o){return ha(this,void 0,void 0,(function(){var s,a;return da(this,(function(c){return this._channel?(s=this._channel.codec.encodeJoinRTCRoom(t,n,r,i,o),a=new hA(jA[jA.rtcRJoin_data],s,e),[2,this._channel.send(a,RN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.quitRTCRoom=function(e){return ha(this,void 0,void 0,(function(){var t,n;return da(this,(function(r){switch(r.label){case 0:return this._channel?(t=this._channel.codec.encodeQuitRTCRoom(),n=new hA(jA[jA.rtcRExit],t,e),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,r.sent().code]}}))}))},t.prototype.rtcPing=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new hA(jA[jA.rtcPing],r,e),[4,this._channel.send(i)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,o.sent().code]}}))}))},t.prototype.getRTCRoomInfo=function(e){return ha(this,void 0,void 0,(function(){var t,n;return da(this,(function(r){return this._channel?(t=this._channel.codec.encodeGetRTCRoomInfo(),n=new hA(jA[jA.rtcRInfo],t,e),[2,this._channel.send(n,xN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.getRTCUserInfoList=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o;return da(this,(function(s){switch(s.label){case 0:return this._channel?(t=this._channel.codec.encodeGetRTCRoomInfo(),n=new hA(jA[jA.rtcUData],t,e),[4,this._channel.send(n,RN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return r=s.sent(),i=r.code,o=r.data,[2,{code:i,data:o?{users:o.users}:o}]}}))}))},t.prototype.setRTCUserInfo=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeSetRTCUserInfo(t,n),i=new hA(jA[jA.rtcUPut],r,e),[4,this._channel.send(i)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,o.sent().code]}}))}))},t.prototype.removeRTCUserInfo=function(e,t){return ha(this,void 0,void 0,(function(){var n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(n=this._channel.codec.encodeRemoveRTCUserInfo(t),r=new cA(jA[jA.rtcUDel],n,e),[4,this._channel.send(r)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,i.sent().code]}}))}))},t.prototype.setRTCData=function(e,t,n,r,i,o){return ha(this,void 0,void 0,(function(){var s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?(s=this._channel.codec.encodeSetRTCData(t,n,r,i,o),a=new cA(jA[jA.rtcSetData],s,e),[4,this._channel.send(a)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,c.sent().code]}}))}))},t.prototype.setRTCTotalRes=function(e,t,n,r,i){return ha(this,void 0,void 0,(function(){var o,s;return da(this,(function(a){switch(a.label){case 0:return this._channel?(o=this._channel.codec.encodeUserSetRTCData(t,n,r,i),s=new hA(jA[jA.userSetData],o,e),[4,this._channel.send(s)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,a.sent().code]}}))}))},t.prototype.setRTCCDNUris=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(r=this._channel.codec.encodeUserSetRTCCDNUris(t,n),i=new hA(jA[jA.userSetData],r,e),[4,this._channel.send(i)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,o.sent().code]}}))}))},t.prototype.getRTCData=function(e,t,n,r){if(!this._channel)return Promise.resolve({code:Yg.RC_NET_CHANNEL_INVALID});var i=this._channel.codec.encodeGetRTCData(t,n,r),o=new hA(jA[jA.rtcQryData],i,e);return this._channel.send(o,bN)},t.prototype.removeRTCData=function(e,t,n,r,i){return ha(this,void 0,void 0,(function(){var o,s;return da(this,(function(a){switch(a.label){case 0:return this._channel?(o=this._channel.codec.encodeRemoveRTCData(t,n,r,i),s=new cA(jA[jA.rtcDelData],o,e),[4,this._channel.send(s)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,a.sent().code]}}))}))},t.prototype.setRTCOutData=function(e,t,n,r){throw new Error("JSEngine's method not implemented.")},t.prototype.getRTCOutData=function(e,t){throw new Error("JSEngine's method not implemented.")},t.prototype.getRTCToken=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i;return da(this,(function(o){return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new hA(jA[jA.rtcToken],r,e),[2,this._channel.send(i,UN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}]}))}))},t.prototype.setRTCState=function(e,t){return ha(this,void 0,void 0,(function(){var n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(n=this._channel.codec.encodeSetRTCState(t),r=new hA(jA[jA.rtcUserState],n,e),[4,this._channel.send(r)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return[2,i.sent().code]}}))}))},t.prototype.getRTCUserInfo=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(e){throw new Error("Method not implemented.")}))}))},t.prototype.getRTCUserList=function(e){if(!this._channel)return Promise.resolve({code:Yg.RC_NET_CHANNEL_INVALID});var t=this._channel.codec.encodeGetRTCRoomInfo(),n=new hA(jA[jA.rtcUList],t,e);return this._channel.send(n,RN)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return void 0===t&&(t=dv.LIVE),ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:return this._channel?(r=this._channel.codec.encodeJoinRTCRoom(t,n),i=new hA(jA[jA.viewerJoinR],r,e),[4,this._channel.send(i,KO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return o=h.sent(),s=o.code,a=o.data,s!==Yg.SUCCESS?[2,{code:s}]:(u=(c=a).rtcToken,l=c.entries,[2,{code:s,data:{token:u,kvEntries:l}}])}}))}))},t.prototype.quitLivingRoomAsAudience=function(e){return ha(this,void 0,void 0,(function(){var t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeQuitRTCRoom(),n=new hA(jA[jA.viewerExitR],t,e),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.rtcIdentityChange=function(e,t,n){return ha(this,void 0,void 0,(function(){var r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return this._channel?(r=this._channel.codec.encodeIdentityChangeInfo(t,n),i=new hA(jA[jA.rtcIdentityChange],r,e),[4,this._channel.send(i,RN)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return o=c.sent(),s=o.code,a=o.data,s!==Yg.SUCCESS?[2,{code:s}]:[2,{code:s,data:a}]}}))}))},t.prototype.pullRTCRoomEntry=function(e,t){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u;return da(this,(function(l){switch(l.label){case 0:return n=(t=this)._channel,r=t.currentUserId,n?(Mg.info("audience in room start pull KV"),i=n.codec.encodePullRTCRoomKV(e,0),o=new hA(jA[jA.rtcPullKv],i,r),[4,n.send(o,BO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return s=l.sent(),a=s.code,c=s.data,Mg.info("audience in room end pull KV, code: ".concat(a,", data: ").concat(JSON.stringify(c||{}))),a===Yg.SUCCESS?(u=c.kvEntries,this._watcher.onRTCDataChange(u,e),[2,{code:a,data:c}]):[2,{code:a}]}}))}))},t.prototype.getRTCJoinedUserInfo=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c;return da(this,(function(u){switch(u.label){case 0:return n=(t=this)._channel,r=t.currentUserId,n?(i=n.codec.encodeQueryUserJoinedInfo(e),o=new hA(jA[jA.rtcQueryJoined],i,r),[4,n.send(o,FO)]):[2,{code:Yg.RC_NET_CHANNEL_INVALID}];case 1:return s=u.sent(),a=s.code,c=s.data,a===Yg.SUCCESS?[2,{code:a,data:c}]:[2,{code:a}]}}))}))},t.prototype.getDeviceId=function(){return xp(this.runtime)},t.prototype.requestRoomPK=function(e){return ha(this,void 0,void 0,(function(){var t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeRequestRoomPK(e),n=new hA(jA[jA.rtcInvite],t,e.roomId),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.cancelRoomPK=function(e){return ha(this,void 0,void 0,(function(){var t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeCancelRoomPK(e),n=new hA(jA[jA.rtcCancelInvite],t,e.roomId),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.responseRoomPK=function(e){return ha(this,void 0,void 0,(function(){var t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeResponseRoomPK(e),n=new hA(jA[jA.rtcInviteAnswer],t,e.roomId),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.endRoomPK=function(e){return ha(this,void 0,void 0,(function(){var t,n,r;return da(this,(function(i){switch(i.label){case 0:return this._channel?(t=this._channel.codec.encodeEndRoomPK(e),n=new hA(jA[jA.rtcEndInvite],t,e.roomId),[4,this._channel.send(n)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return r=i.sent().code,this._rtcKVManager.reset(),[2,r]}}))}))},t.prototype.bindRTCRoomForChatroom=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i;return da(this,(function(o){switch(o.label){case 0:return this._channel?(t=e.chatRoomId,n=this._channel.codec.encodebindRTCRoomForChatroom(e),r=new hA(jA[jA.setRtcRoomId],n,t),[4,this._channel.send(r)]):[2,Yg.RC_NET_CHANNEL_INVALID];case 1:return i=o.sent(),[2,i.code]}}))}))},t.prototype.callExtra=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Promise.resolve({code:Yg.EXTRA_METHOD_UNDEFINED})},t.prototype.getConversationListWithAllChannel=function(){throw new Error("Method not implemented.")},t.prototype.getConversationListWithAllChannelByPage=function(e,t){throw new Error("Method not implemented.")},t.prototype.clearConversations=function(){throw new Error("Method not implemented.")},t.prototype.setUserStatusListener=function(e,t){throw new Error("Method not implemented.")},t.prototype.setUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.subscribeUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.getUserStatus=function(e){throw new Error("Method not implemented.")},t.prototype.addToBlacklist=function(e){throw new Error("Method not implemented.")},t.prototype.removeFromBlacklist=function(e){throw new Error("Method not implemented.")},t.prototype.getBlacklist=function(){throw new Error("Method not implemented.")},t.prototype.getBlacklistStatus=function(e){throw new Error("Method not implemented.")},t.prototype.insertMessage=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.deleteMessages=function(e){throw new Error("Method not implemented.")},t.prototype.deleteMessagesByTimestamp=function(e,t,n,r,i){throw new Error("Method not implemented.")},t.prototype.clearMessages=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.getMessage=function(e){throw new Error("Method not implemented.")},t.prototype.setMessageContent=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.setMessageSearchField=function(e,t,n){throw new Error("Method not implemented.")},t.prototype.searchConversationByContent=function(e,t,n,r){throw new Error("Method not implemented.")},t.prototype.searchMessageByContent=function(e,t,n,r,i,o){throw new Error("Method not implemented.")},t.prototype.getUnreadMentionedMessages=function(e,t){throw new Error("Method not implemented.")},t.prototype.setMessageSentStatus=function(e,t){throw new Error("Method not implemented.")},t.prototype.setMessageReceivedStatus=function(e,t){throw new Error("Method not implemented.")},t.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){throw new Error("Method not implemented.")},t}(iU),rL=function(){function e(e){this._context=e}return e.prototype.__getContext=function(){return this._context},e.prototype.getNaviInfo=function(){return this._context.getInfoFromCache()},e.prototype.getCoreVersion=function(){return this._context.coreVersion},e.prototype.getAPIVersion=function(){return this._context.apiVersion},e.prototype.getAppkey=function(){return this._context.appkey},e.prototype.getCurrentId=function(){return this._context.getCurrentUserId()},e.prototype.getConnectionStatus=function(){return this._context.getConnectionStatus()},e.prototype.getDeviceId=function(){return this._context.getDeviceId()},e.prototype.sendMessage=function(e,t,n){return this._context.sendMessage(e,t,n)},e.prototype.registerMessageType=function(e,t,n,r){void 0===r&&(r=[]),this._context.registerMessageType(e,t,n,r)},e.prototype.getServerTime=function(){return this._context.getServerTime()},e.prototype.getRTCJoinedUserInfo=function(e){return this._context.getRTCJoinedUserInfo(e)},e}(),iL=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ua(t,e),t.prototype.getNaviInfo=function(){return this._context.getInfoFromCache()},t.prototype.joinRTCRoom=function(e,t,n,r,i,o){return this._context.joinRTCRoom(e,t,n,r,i,o)},t.prototype.quitRTCRoom=function(e){return this._context.quitRTCRoom(e)},t.prototype.rtcPing=function(e,t,n){return this._context.rtcPing(e,t,n)},t.prototype.getRTCRoomInfo=function(e){return this._context.getRTCRoomInfo(e)},t.prototype.getRTCUserInfoList=function(e){return this._context.getRTCUserInfoList(e)},t.prototype.getRTCUserInfo=function(e){return this._context.getRTCUserInfo(e)},t.prototype.setRTCUserInfo=function(e,t,n){return this._context.setRTCUserInfo(e,t,n)},t.prototype.removeRTCUserInfo=function(e,t){return this._context.removeRTCUserInfo(e,t)},t.prototype.setRTCData=function(e,t,n,r,i,o){return this._context.setRTCData(e,t,n,r,i,o)},t.prototype.setRTCTotalRes=function(e,t,n,r,i){return this._context.setRTCTotalRes(e,t,n,r,i)},t.prototype.setRTCCDNUris=function(e,t,n){return this._context.setRTCCDNUris(e,t,n)},t.prototype.getRTCData=function(e,t,n,r){return this._context.getRTCData(e,t,n,r)},t.prototype.removeRTCData=function(e,t,n,r,i){return this._context.removeRTCData(e,t,n,r,i)},t.prototype.setRTCOutData=function(e,t,n,r){return this._context.setRTCOutData(e,t,n,r)},t.prototype.getRTCOutData=function(e,t){return this._context.getRTCOutData(e,t)},t.prototype.getRTCToken=function(e,t,n){return this._context.getRTCToken(e,t,n)},t.prototype.setRTCState=function(e,t){return this._context.setRTCState(e,t)},t.prototype.getRTCUserList=function(e){return this._context.getRTCUserList(e)},t.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._context.joinLivingRoomAsAudience(e,t,n)},t.prototype.quitLivingRoomAsAudience=function(e){return this._context.quitLivingRoomAsAudience(e)},t.prototype.rtcIdentityChange=function(e,t,n){return this._context.rtcIdentityChange(e,t,n)},t.prototype.requestRoomPK=function(e){return this._context.requestRoomPK(e)},t.prototype.cancelRoomPK=function(e){return this._context.cancelRoomPK(e)},t.prototype.responseRoomPK=function(e){return this._context.responseRoomPK(e)},t.prototype.endRoomPK=function(e){return this._context.endRoomPK(e)},t}(rL);function oL(e){return Object.assign({},e)}var sL,aL=function(){function e(e,t){var n;this._runtime=e,this._token="",this._pluginContextQueue=[],this._pluginInstanseMap={},this.coreVersion="5.3.3",this._versionInfo={},this._typingInfo={},this._isInternalConnected=!1,this._connectionStatus=Qg.DISCONNECTED,this._canRedirectConnect=!1,this._watcher={message:void 0,batchMessage:void 0,conversationState:void 0,chatroomState:void 0,connectionState:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0,pullFinished:void 0,onConnecting:void 0,onConnected:void 0,onDisconnect:void 0,onSuspend:void 0,readReceiptReceived:void 0,messageReceiptRequest:void 0,messageReceiptResponse:void 0,typingState:void 0,messageBlocked:void 0,ultraGroupEnable:void 0,operateStatus:void 0,ultraGroupMessageExpansionUpdated:void 0,ultraGroupMessageModified:void 0,ultraGroupMessageRecalled:void 0},this._typingInternalTimer=-1,this._typingExpireTime=2e3,this._typingChangedList=[],this.getChatRoomHistoryMessages=this.getChatroomHistoryMessages,this._options=Object.assign({},t),this.appkey=this._options.appkey,this.apiVersion=this._options.apiVersion,this.apiPKGName=this._options.apiPKGName||"",this._options.typingExpireTime&&(this._options.typingExpireTime<2e3?this._typingExpireTime=2e3:this._options.typingExpireTime>6e3?this._typingExpireTime=6e3:this._typingExpireTime=this._options.typingExpireTime),this._options.navigators=this._options.navigators.filter((function(e){return/^https?:\/\//.test(e)})),this._options.navigators=this._options.navigators.map((function(e){return e.replace(/\/$/g,"")})),0===this._options.navigators.length&&(n=this._options.navigators).push.apply(n,zs),Mg.updateStatisticsBaseData({bundleId:this.apiPKGName}),Mg.initReportLog({runtime:this._runtime,logSwitch:1,logPolicy:JSON.parse("{}"),appkey:this.appkey,version:this.apiVersion});var r={status:this._connectionStatusListener.bind(this),batchMessage:this._batchMessageReceiver.bind(this),chatroom:this._chatroomInfoListener.bind(this),conversation:this._conversationInfoListener.bind(this),expansion:this._expansionInfoListener.bind(this),tag:this._tagListener.bind(this),conversationTag:this._conversationTagListener.bind(this),onRTCDataChange:this._rtcDataChange.bind(this),pullFinished:this._pullFinishedListener.bind(this),ultraGroupEnable:this._ultraGroupEnableListener.bind(this),operateStatus:this._operateStatusListener.bind(this),ultraGroupMessageExpansionUpdated:this._ultraGroupMessageExpansionUpdatedListener.bind(this),ultraGroupMessageModified:this._ultraGroupMessageModifiedListener.bind(this),ultraGroupMessageRecalled:this._ultraGroupMessageRecalledListener.bind(this)};this._engine=Qy()?new RCCppEngine(e,r,this._options):new nL(e,r,this._options)}return e.init=function(t,n){return Mg.setLogLevel(n.logLevel),Mg.setLogStdout(n.logStdout),(n.indexDBSwitch||yg(n.indexDBSwitch))&&$p.init(),Mg.debug("APIContext.init =>",n.appkey,n.navigators),this._context?(Mg.error("Repeat initialize!"),this._context):(Mg.warn("RCEngine Commit:","925bcb5e5bdb7b280cfecb8939ec6f729242cbcb"),this._context=new e(t,n),Mg.__insertLogIntoDatabase(),this._context)},e.destroy=function(){this._context&&(this._context._destroy(),this._context=void 0)},e.prototype.install=function(e,t){if(this._pluginInstanseMap[e.tag])return Mg.warn("Repeat install plugin: ".concat(e.tag)),this._pluginInstanseMap[e.tag];var n="RCRTC"===e.tag?new iL(this):new rL(this),r=null;try{if(!e.verify(this._runtime))return null;r=e.setup(n,this._runtime,t)}catch(e){Mg.error("install plugin error!\n",e)}return["RCRTC","RCCall"].includes(e.tag)&&e.version&&e.name&&(this._versionInfo[e.name]=e.version),r&&this._pluginContextQueue.push(n),r&&(this._pluginInstanseMap[e.tag]=r),r},e.prototype._handleRedirect=function(){return ha(this,void 0,void 0,(function(){var e,t=this;return da(this,(function(n){switch(n.label){case 0:return Mg.debug("_handleRedirct",this._token),[4,this.connect(this._token,!0)];case 1:return(e=n.sent().code)!==Yg.SUCCESS&&this._canRedirectConnect&&(this._handleSuspend(e),setTimeout((function(){t._handleRedirect()}),5e3)),[2]}}))}))},e.prototype._connectionStatusListener=function(e){var t;return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[Qg.REDIRECT,Qg.BLOCKED,Qg.KICKED_OFFLINE_BY_OTHER_CLIENT,Qg.DISCONNECT_BY_SERVER,Qg.DISCONNECTED,Qg.NETWORK_UNAVAILABLE].includes(e)&&(Mg.setStatisticsData(HA.IM_CONNECTION_DURATION,{endTime:(new Date).getTime(),code:e}),function(e){ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:t=HA.IM_CONNECTION_DURATION,n=Mg.getStatisticsBaseData().bundleId,r=Mg.getStatisticsData(t),i=r.startTime,o=r.endTime,s=r.code,a=Cw.UNKONWN,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,e.getNetworkType()];case 2:return a=h.sent(),[3,4];case 3:return c=h.sent(),Mg.debug(c.message),[3,4];case 4:return u=0,hg(i)&&hg(o)&&o>i&&i&&(u=o-i),l={bid:n,cod:s,dur:u,net:a},Mg.reportStatisticsLog(t,l),[2]}}))}))}(this._runtime)),this._connectionStatus=e,e===Qg.REDIRECT?(this._canRedirectConnect=!0,this._handleSuspend(e),this._handleRedirect()):e===Qg.BLOCKED||e===Qg.KICKED_OFFLINE_BY_OTHER_CLIENT||e===Qg.DISCONNECT_BY_SERVER?(this._canRedirectConnect=!1,this._handleDisconnect(e)):e===Qg.CONNECTING?this._handleConnecting():e===Qg.CONNECTED?this._handleConnected():e===Qg.DISCONNECTED?this._handleDisconnect(e):e===Qg.NETWORK_UNAVAILABLE&&this._handleSuspend(e),(null===(t=this._watcher.rtcInnerWatcher)||void 0===t?void 0:t.status)&&this._watcher.rtcInnerWatcher.status(e),this._pluginContextQueue.forEach((function(t){t.onconnectionstatechange&&t.onconnectionstatechange(e)})),this._watcher.connectionState&&this._watcher.connectionState(e),[2]}))}))},e.prototype._handleConnecting=function(){this._watcher.onConnecting&&this._watcher.onConnecting()},e.prototype._handleConnected=function(){this._watcher.onConnected&&this._watcher.onConnected()},e.prototype._handleDisconnect=function(e){this._watcher.onDisconnect&&this._watcher.onDisconnect(e)},e.prototype._handleSuspend=function(e){this._watcher.onSuspend&&this._watcher.onSuspend(e)},e.prototype._messageReceiver=function(e,t,n){var r,i,o;if((e.conversationType===ng.RTC_ROOM||Object.prototype.hasOwnProperty.call(_v,e.messageType))&&this._watcher.rtcInnerWatcher&&this._watcher.rtcInnerWatcher.message)this._watcher.rtcInnerWatcher.message(oL(e));else if(-1===["RC:ChrmJoinNtf","RC:ChrmQuitNtf"].indexOf(e.messageType)||"function"!=typeof this._watcher.chatroomState){if("RC:ChrmMemChange"!==e.messageType){if(e.messageType!==Xg.TYPING_STATUS||(this._addTypingInfo(oL(e)),!this._watcher.typingState))if(e.messageType!==Xg.LOG_COMMAND||"rongcloudsystem"!==e.senderUserId)if(e.messageType!==Xg.INTERCEPT){if(!this._pluginContextQueue.some((function(t){if(!t.onmessage)return!1;try{return t.onmessage(oL(e))}catch(e){return Mg.error("plugin error =>",e),!1}})))if(this._watcher.message&&this._watcher.message(oL(e),t,n),"RC:ReadNtf"!==e.messageType)if("RC:RRReqMsg"!==e.messageType){if("RC:RRRspMsg"!==e.messageType)return e;var s=null===(o=e.content)||void 0===o?void 0:o.receiptMessageDic,a=this._engine.getCurrentUserId();s&&Array.isArray(s[a])&&"function"==typeof this._watcher.messageReceiptResponse&&this._watcher.messageReceiptResponse({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.senderUserId,s[a])}else"function"==typeof this._watcher.messageReceiptRequest&&this._watcher.messageReceiptRequest({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.content.messageUId,e.senderUserId);else"function"==typeof this._watcher.readReceiptReceived&&this._watcher.readReceiptReceived({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId},e.content.messageUId,e.content.lastMessageSendTime)}else this._MessageBlockedListener({conversationType:e.conversationType,targetId:e.targetId,channelId:e.channelId||"",blockType:e.content.interceptType,blockedMessageUId:e.content.msgUId,extra:e.content.extra});else{var c=e.content,u=c.startTime,l=c.endTime,h=c.platform,d=c.logId,f=c.uri,p=c.packageName,g={startTime:parseInt(u),endTime:parseInt(l),platform:h,logId:d,uri:f,packageName:p};null===(i=Tg.getInstance())||void 0===i||i.reportFullLog(g)}}else if("function"==typeof this._watcher.chatroomState){var v={};Array.isArray(e.content.userList)&&e.content.userList.forEach((function(e){v[e.userId]=e.status})),this._watcher.chatroomState({userChange:{users:v,chatroomId:e.targetId}})}}else this._watcher.chatroomState({userChange:{users:(r={},r[e.senderUserId]="RC:ChrmQuitNtf"===e.messageType?uv.QUIT:uv.JOIN,r),chatroomId:e.targetId}})},e.prototype._batchMessageReceiver=function(e,t,n){var r=this,i=[];e.forEach((function(e){var o=r._messageReceiver(e,t,n);o&&i.push(o)})),i.length&&this._watcher.batchMessage&&this._watcher.batchMessage(i)},e.prototype._chatroomInfoListener=function(e){this._watcher.chatroomState&&this._watcher.chatroomState(e)},e.prototype._conversationInfoListener=function(e){this._watcher.conversationState&&this._watcher.conversationState(e)},e.prototype._expansionInfoListener=function(e){this._watcher.expansion&&this._watcher.expansion(e)},e.prototype._tagListener=function(){this._watcher.tag&&this._watcher.tag()},e.prototype._conversationTagListener=function(){this._watcher.conversationTagChanged&&this._watcher.conversationTagChanged()},e.prototype._typingStatusListener=function(e){this._watcher.typingState&&this._watcher.typingState(e)},e.prototype._pullFinishedListener=function(){this._watcher.pullFinished&&this._watcher.pullFinished()},e.prototype._MessageBlockedListener=function(e){this._watcher.messageBlocked&&this._watcher.messageBlocked(e)},e.prototype._ultraGroupEnableListener=function(e){this._watcher.ultraGroupEnable&&this._watcher.ultraGroupEnable(e)},e.prototype._operateStatusListener=function(e){this._watcher.operateStatus&&this._watcher.operateStatus(e)},e.prototype._ultraGroupMessageExpansionUpdatedListener=function(e){this._watcher.ultraGroupMessageExpansionUpdated&&this._watcher.ultraGroupMessageExpansionUpdated(e)},e.prototype._ultraGroupMessageModifiedListener=function(e){this._watcher.ultraGroupMessageModified&&this._watcher.ultraGroupMessageModified(e)},e.prototype._ultraGroupMessageRecalledListener=function(e){this._watcher.ultraGroupMessageRecalled&&this._watcher.ultraGroupMessageRecalled(e)},e.prototype._rtcDataChange=function(e,t){this._pluginContextQueue.forEach((function(n){n.onrtcdatachange&&n.onrtcdatachange(e,t)}))},e.prototype.assignWatcher=function(e){var t=this;Object.keys(this._watcher).forEach((function(n){if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t._watcher[n]=vg(r)||gg(r)?r:void 0}}))},e.prototype.resetWatcher=function(){var e=this;Object.keys(this._watcher).forEach((function(t){e._watcher[t]=void 0}))},e.prototype._addTypingInfo=function(e){var t=e.senderUserId,n=e.conversationType,r=e.targetId,i=e.content,o=e.channelId,s=i.typingContentType,a=o||"",c="".concat(n,"#").concat(r,"#").concat(a);this._typingInfo[c]||(this._typingInfo[c]=[]);var u=this._typingInfo[c].findIndex((function(e){return e.userId===t}));u>=0&&this._typingInfo[c][u].messageType===s?this._typingInfo[c][u].timestamp=Date.now():(u>=0&&this._typingInfo[c].splice(u,1),this._typingInfo[c].push({userId:t,messageType:s,timestamp:Date.now()}),this._typingChangedList.includes(c)||this._typingChangedList.push(c),this._startCheckTypingInfo())},e.prototype._startCheckTypingInfo=function(){var e=this;-1===this._typingInternalTimer&&0!==Object.keys(this._typingInfo).length&&(this._typingInternalTimer=setInterval((function(){for(var t in e._typingInfo){var n=e._typingInfo[t].length;e._typingInfo[t]=e._typingInfo[t].filter((function(t){return Date.now()-t.timestamp<e._typingExpireTime})),e._typingInfo[t].length===n||e._typingChangedList.includes(t)||e._typingChangedList.push(t),0===e._typingInfo[t].length&&delete e._typingInfo[t]}if(e._typingChangedList.length>0){var r=e._typingChangedList.map((function(t){return{conversationType:Number(t.split("#")[0]),targetId:t.split("#")[1],channelId:t.split("#")[2],list:e._typingInfo[t]||[]}}));e._typingStatusListener(r),e._typingChangedList=[]}0===Object.keys(e._typingInfo).length&&(clearInterval(e._typingInternalTimer),e._typingInternalTimer=-1)}),500))},e.prototype.getConnectedTime=function(){return this._engine.getConnectedTime()},e.prototype.getServerTime=function(){return this._engine.getServerTime()},e.prototype.getDeviceId=function(){return this._engine.getDeviceId()},e.prototype.getCurrentUserId=function(){return this._engine.getCurrentUserId()},e.prototype.getConnectionStatus=function(){return this._connectionStatus},Object.defineProperty(e.prototype,"token",{get:function(){return this._token},enumerable:!1,configurable:!0}),e.prototype.connect=function(e,t,n){return void 0===t&&(t=!1),ha(this,void 0,void 0,(function(){var r,i,o,s,a,c,u;return da(this,(function(l){switch(l.label){case 0:return this._connectionStatus===Qg.CONNECTED?[2,{code:Yg.SUCCESS,userId:this._engine.getCurrentUserId()}]:this._connectionStatus===Qg.CONNECTING?[2,{code:Yg.BIZ_ERROR_CONNECTING}]:"string"!=typeof e||0===e.length?[2,{code:Yg.RC_CONN_USER_OR_PASSWD_ERROR}]:(this._token=e,r=e.split("@"),i=r[1],o=i?i.split(";").map((function(e){return/^https?:/.test(e)?e:"https://".concat(e)})):[],[4,this._engine.getNaviInfo(this._getTokenWithoutNavi(),o,t,this._options.checkCA)]);case 1:return(s=l.sent())?1===(null==s?void 0:s.type)?[2,{code:Yg.PACKAGE_ENVIRONMENT_ERROR}]:(a=Vv.getInfo(),[4,this._engine.connect(this._getTokenWithoutNavi(),s,n)]):[2,{code:Yg.RC_NAVI_RESOURCE_ERROR}];case 2:return c=l.sent(),Mg.__insertLogIntoDatabase(),c!==Jg.REDIRECT?[3,4]:(this._connectionStatus=Qg.REDIRECT,[4,this.connect(e,!0)]);case 3:return[2,l.sent()];case 4:return u=this._engine.getCurrentUserId(),c===Yg.SUCCESS&&(Mg.setStatisticsData(HA.IM_CONNECTION_DURATION,{startTime:(new Date).getTime()},!0),Mg.info("connect success, userId: ".concat(u)),1!==(null==s?void 0:s.type)&&this._engine.reportSDKInfo&&this._engine.reportSDKInfo(a),Mg.updateUploadLogAttr({runtime:this._runtime,logSwitch:(null==s?void 0:s.logSwitch)||0,logPolicy:JSON.parse((null==s?void 0:s.logPolicy)||"{}"),appkey:this.appkey,version:this.apiVersion,userId:u}),Sg.init(u),this._isInternalConnected=!0),c!==Yg.SUCCESS||Qy()||1===s.openUS&&this._pullUserSettings(),c!==Yg.SUCCESS&&(this._connectionStatus=Qg.CONNECTION_CLOSED),[2,{code:c,userId:u}]}}))}))},e.prototype._pullUserSettings=function(){return ha(this,void 0,void 0,(function(){return da(this,(function(e){return[2]}))}))},e.prototype.disconnect=function(){var e;return this._isInternalConnected=!1,clearInterval(this._typingInternalTimer),this._typingInternalTimer=-1,this._typingInfo={},null===(e=Tg.getInstance())||void 0===e||e.distroy(),Mg.__insertLogIntoDatabase(),Sg.reset(),this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondisconnect)try{e.ondisconnect()}catch(e){Mg.error("plugin error =>",e)}})),Promise.resolve()},e.prototype.reconnect=function(e){return this._isInternalConnected?Promise.resolve({code:Yg.CAN_NOT_RECONNECT}):this.connect(this._getTokenWithoutNavi(),!1,e)},e.prototype._getTokenWithoutNavi=function(){return this._token.replace(/@.+$/,"@")},e.prototype.getInfoFromCache=function(){return this._engine.getInfoFromCache(this._getTokenWithoutNavi())},e.prototype.registerMessageType=function(e,t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=!1),this._engine.registerMessageType(e,t,n,r,i)},e.prototype.sendMessage=function(e,t,n,r){if(e!==ng.ULTRA_GROUP){var i=this.getInfoFromCache();if(1===((null==i?void 0:i.grpRRVer)||0)&&n.messageType===Xg.READ_RECEIPT_RESPONSE)return Promise.resolve({code:Yg.READ_RECEIPT_ERROR})}var o=n.canIncludeExpansion,s=void 0!==o&&o,a=n.expansion;if(s){var c=Cg(a),u=c.isIllgalEx,l=c.isExKeyOrValLengthExceedLimit;if(c.isExceedLimit||l)return Promise.resolve({code:Yg.EXPANSION_LIMIT_EXCEET});if(u)return Promise.resolve({code:Yg.BIZ_ERROR_INVALID_PARAMETER})}var h=JSON.stringify(n.content);return Yc(h)>ea?Promise.resolve({code:Yg.RC_MSG_CONTENT_EXCEED_LIMIT}):e===ng.ULTRA_GROUP?this._engine.sendUltraMessage(t,n):this._engine.sendMessage(e,t,n,r)},e.prototype.sendExpansionMessage=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a,c,u,l,h;return da(this,(function(d){switch(d.label){case 0:return t=e.channelId,n=e.conversationType,r=e.targetId,i=e.messageUId,o=e.keys,s=e.expansion,a=e.removeAll,e.canIncludeExpansion?(c=Cg(s),u=c.isIllgalEx,l=c.isExKeyOrValLengthExceedLimit,c.isExceedLimit||l?[2,Promise.resolve({code:Yg.EXPANSION_LIMIT_EXCEET})]:u?[2,Promise.resolve({code:Yg.BIZ_ERROR_INVALID_PARAMETER})]:(h={mid:i},s&&(h.put=s),o&&(h.del=o),a&&(h.removeAll=1),[4,this._engine.sendMessage(n,r,{content:h,messageType:Xg.EXPANSION_NOTIFY,channelId:t})])):[2,{code:Yg.MESSAGE_KV_NOT_SUPPORT}];case 1:return[2,{code:d.sent().code}]}}))}))},e.prototype.sendReadReceiptMessage=function(e,t,n){return ha(this,void 0,void 0,(function(){var r;return da(this,(function(i){return r=this.getInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Yg.READ_RECEIPT_ERROR,data:"The read receipt switch is not on, please call the sendMessage method!"}]:[2,this._engine.sendReadReceiptMessage(e,t,n)]}))}))},e.prototype.getMessageReader=function(e,t,n){return ha(this,void 0,void 0,(function(){var r;return da(this,(function(i){return r=this.getInfoFromCache(),0===((null==r?void 0:r.grpRRVer)||0)?[2,{code:Yg.READ_RECEIPT_ERROR}]:[2,this._engine.getMessageReader(e,t,n)]}))}))},e.prototype._destroy=function(){var e;this._isInternalConnected=!1,this._watcher={batchMessage:void 0,message:void 0,conversationState:void 0,chatroomState:void 0,connectionState:void 0,rtcInnerWatcher:void 0,expansion:void 0,tag:void 0,conversationTagChanged:void 0,typingState:void 0,pullFinished:void 0,onConnecting:void 0,onConnected:void 0,onDisconnect:void 0,onSuspend:void 0},this._engine.disconnect(),this._pluginContextQueue.forEach((function(e){if(e.ondestroy)try{e.ondestroy()}catch(e){Mg.error("plugin error =>",e)}})),this._pluginContextQueue.length=0,this._pluginInstanseMap={},null===(e=Tg.getInstance())||void 0===e||e.distroy(),Sg.reset()},e.prototype.getHistoryMessage=function(e,t,n,r,i,o,s){if(void 0===n&&(n=0),void 0===r&&(r=20),void 0===i&&(i=0),void 0===o&&(o=""),void 0===s&&(s=""),e===ng.ULTRA_GROUP){var a={timestamp:n,count:r,order:i,channelId:o};return this._engine.getUltraHistoryMsg(t,a)}return this._engine.getHistoryMessage(e,t,n,r,i,o,s||"")},e.prototype.getConversationList=function(e,t,n,r,i){if(void 0===e&&(e=300),void 0===i&&(i=""),t===ng.ULTRA_GROUP){var o=Yg.METHOD_NOT_SUPPORT;return Promise.resolve({code:o,msg:Yg[o]})}return this._engine.getConversationList(e,t,n,r,i)},e.prototype.getConversation=function(e,t,n){return this._engine.getConversation(e,t,n)},e.prototype.removeConversation=function(e,t,n){return void 0===n&&(n=""),e===ng.ULTRA_GROUP?Promise.resolve(Yg.METHOD_NOT_SUPPORT):this._engine.removeConversation(e,t,n)},e.prototype.getUltraGroupList=function(){return this._engine.getUltraGroupList()},e.prototype.getBlockUltraGroupList=function(){return this._engine.getBlockUltraGroupList()},e.prototype.getTopUltraGroupList=function(){return this._engine.getTopUltraGroupList()},e.prototype.clearUnreadCount=function(e,t,n){return void 0===n&&(n=""),e===ng.ULTRA_GROUP?this._engine.clearUltraUnreadcount(t,n):this._engine.clearConversationUnreadCount(e,t,n)},e.prototype.clearAllUnreadCount=function(){return this._engine.clearAllUnreadCount()},e.prototype.getUnreadCount=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationUnreadCount(e,t,n)},e.prototype.getTotalUnreadCount=function(e,t,n){if(t&&t.includes(ng.ULTRA_GROUP)){var r=Yg.METHOD_NOT_SUPPORT;return Promise.resolve({code:r,msg:Yg[r]})}return this._engine.getAllConversationUnreadCount(e,t&&t.length>0?t:[ng.PRIVATE,ng.GROUP,ng.SYSTEM,ng.PUBLIC_SERVICE],!!n)},e.prototype.getFirstUnreadMessage=function(e,t,n){return void 0===n&&(n=""),this._engine.getFirstUnreadMessage(e,t,n)},e.prototype.setConversationNotificationLevel=function(e,t,n,r){return void 0===r&&(r=""),ha(this,void 0,void 0,(function(){var i;return da(this,(function(o){return i=[{conversationType:e,targetId:t,notificationLevel:n,channelId:r}],[2,this._engine.batchSetConversationStatus(i)]}))}))},e.prototype.setConversationStatus=function(e,t,n,r,i){if(void 0===i&&(i=""),e===ng.ULTRA_GROUP&&void 0!==n)return Promise.resolve(Yg.METHOD_NOT_SUPPORT);var o=[{conversationType:e,targetId:t,isTop:n,notificationStatus:r,channelId:i}];return this._engine.batchSetConversationStatus(o)},e.prototype.saveConversationMessageDraft=function(e,t,n,r){return void 0===r&&(r=""),this._engine.saveConversationMessageDraft(e,t,n,r)},e.prototype.getConversationMessageDraft=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationMessageDraft(e,t,n)},e.prototype.clearConversationMessageDraft=function(e,t,n){return void 0===n&&(n=""),this._engine.clearConversationMessageDraft(e,t,n)},e.prototype.recallMessage=function(e,t,n,r,i){return this._engine.recallMsg(e,t,n,r,i)},e.prototype.deleteRemoteMessage=function(e,t,n,r){return void 0===r&&(r=""),e===ng.ULTRA_GROUP?Promise.resolve(Yg.METHOD_NOT_SUPPORT):this._engine.deleteRemoteMessage(e,t,n,r)},e.prototype.deleteRemoteMessageByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.deleteRemoteMessageByTimestamp(e,t,n,r)},e.prototype.joinChatroom=function(e,t){return void 0===t&&(t=10),this._engine.joinChatroom(e,t)},e.prototype.joinExistChatroom=function(e,t){return void 0===t&&(t=10),this._engine.joinExistChatroom(e,t)},e.prototype.quitChatroom=function(e){return this._engine.quitChatroom(e)},e.prototype.getChatroomInfo=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),this._engine.getChatroomInfo(e,t,n)},e.prototype.setChatroomEntry=function(e,t){var n=t.key,r=t.value;return Fy(n)&&Ky(r)?this._engine.setChatroomEntry(e,t):Promise.resolve(Yg.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.setChatroomEntries=function(e,t){for(var n=0;n<t.entries.length;n++){var r=t.entries[n],i=r.key,o=r.value;if(!Fy(i)||!Ky(o))return Promise.resolve({code:Yg.BIZ_ERROR_INVALID_PARAMETER})}return this._engine.setChatroomEntries(e,t)},e.prototype.forceSetChatroomEntry=function(e,t){var n=t.key,r=t.value;return Fy(n)&&Ky(r)?this._engine.forceSetChatroomEntry(e,t):Promise.resolve(Yg.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.removeChatroomEntry=function(e,t){var n=t.key;return Fy(n)?this._engine.removeChatroomEntry(e,t):Promise.resolve(Yg.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.removeChatroomEntries=function(e,t){for(var n=0;n<t.entries.length;n++){var r=t.entries[n].key;if(!Fy(r))return Promise.resolve({code:Yg.BIZ_ERROR_INVALID_PARAMETER})}return this._engine.removeChatroomEntries(e,t)},e.prototype.forceRemoveChatroomEntry=function(e,t){var n=t.key;return Fy(n)?this._engine.forceRemoveChatroomEntry(e,t):Promise.resolve(Yg.BIZ_ERROR_INVALID_PARAMETER)},e.prototype.getChatroomEntry=function(e,t){return this._engine.getChatroomEntry(e,t)},e.prototype.getAllChatroomEntries=function(e){return this._engine.getAllChatroomEntry(e)},e.prototype.getChatroomHistoryMessages=function(e,t,n,r){return void 0===t&&(t=20),void 0===n&&(n=0),void 0===r&&(r=0),this._engine.getChatroomHistoryMessages(e,r,t,n)},e.prototype.getFileToken=function(e,t,n,r){return ha(this,void 0,void 0,(function(){var i,o,s,a,c,u,l;return da(this,(function(h){switch(h.label){case 0:return i=this.getInfoFromCache(),o=(null==i?void 0:i.bosAddr)||"",s=(null==i?void 0:i.uploadServer)||"",a=(null==i?void 0:i.ossConfig)||"",[4,this._engine.getFileToken(e,t,n,r)];case 1:return c=h.sent(),u=c.code,l=c.data,u===Yg.SUCCESS?[2,Promise.resolve(Object.assign(l,{bos:o,qiniu:s,ossConfig:a}))]:[2,Promise.reject(u)]}}))}))},e.prototype.getFileUrl=function(e,t,n,r,i){return void 0===i&&(i=ov.QINIU),ha(this,void 0,void 0,(function(){var o,s,a;return da(this,(function(c){switch(c.label){case 0:return(null==r?void 0:r.isBosRes)?[2,Promise.resolve(r)]:[4,this._engine.getFileUrl(e,i,t,n)];case 1:return o=c.sent(),s=o.code,a=o.data,s===Yg.SUCCESS?[2,Promise.resolve(a)]:[2,Promise.reject(s)]}}))}))},e.prototype.createTag=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.createTag(e)]}))}))},e.prototype.removeTag=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.removeTag(e)]}))}))},e.prototype.updateTag=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.updateTag(e)]}))}))},e.prototype.getTagList=function(){return ha(this,void 0,void 0,(function(){return da(this,(function(e){return[2,this._engine.getTagList()]}))}))},e.prototype.addTagForConversations=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return t.length>1e3?[2,Promise.reject(Yg.CONVER_OUT_LIMIT_ERROR)]:[2,this._engine.addTagForConversations(e,t)]}))}))},e.prototype.removeTagForConversations=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._engine.removeTagForConversations(e,t)]}))}))},e.prototype.removeTagsForConversation=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._engine.removeTagsForConversation(e,t)]}))}))},e.prototype.getConversationListByTag=function(e,t,n,r){return ha(this,void 0,void 0,(function(){return da(this,(function(i){return[2,this._engine.getConversationListByTag(e,t,n,r)]}))}))},e.prototype.getUnreadCountByTag=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._engine.getUnreadCountByTag(e,t)]}))}))},e.prototype.setConversationStatusInTag=function(e,t,n){return ha(this,void 0,void 0,(function(){return da(this,(function(r){return[2,this._engine.setConversationStatusInTag(e,t,n)]}))}))},e.prototype.getTagsForConversation=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.getTagsForConversation(e)]}))}))},e.prototype.getBlockConversationList=function(){return this._engine.getBlockConversationList()},e.prototype.getTopConversationList=function(){return this._engine.getTopConversationList()},e.prototype.getUnreadMentionedCount=function(e){return this._engine.getUnreadMentionedCount(e)},e.prototype.getAllUnreadMentionedCount=function(){return this._engine.getAllUnreadMentionedCount()},e.prototype.sendUltraGroupTypingStatus=function(e){if(e.conversationType!==ng.ULTRA_GROUP){var t=Yg.METHOD_ONLY_SUPPORT_ULTRA_GROUP;return Promise.resolve({code:t,msg:Yg[t]})}return this._engine.sendUltraGroupTypingStatus(e)},e.prototype.getUltraGroupMessageListByMessageUId=function(e){return this._engine.getUltraGroupMessageListByMessageUId(e)},e.prototype.expandUltraMessage=function(e){return ha(this,void 0,void 0,(function(){var t,n,r,i,o,s,a;return da(this,(function(c){switch(c.label){case 0:return t=e.conversationType,n=e.expansion,r=e.canIncludeExpansion,t!==ng.ULTRA_GROUP?[2,{code:i=Yg.METHOD_ONLY_SUPPORT_ULTRA_GROUP,msg:Yg[i]}]:r?(o=Cg(n),s=o.isIllgalEx,a=o.isExKeyOrValLengthExceedLimit,o.isExceedLimit||a?[2,{code:Yg.EXPANSION_LIMIT_EXCEET}]:s?[2,{code:Yg.BIZ_ERROR_INVALID_PARAMETER}]:[4,this._engine.expandUltraMessage(e)]):[2,{code:Yg.MESSAGE_KV_NOT_SUPPORT}];case 1:return[2,{code:c.sent().code}]}}))}))},e.prototype.modifyMessage=function(e){return ha(this,void 0,void 0,(function(){var t;return da(this,(function(n){switch(n.label){case 0:return e.conversationType!==ng.ULTRA_GROUP?[2,{code:t=Yg.METHOD_ONLY_SUPPORT_ULTRA_GROUP,msg:Yg[t]}]:[4,this._engine.modifyMessage(e)];case 1:return[2,{code:n.sent().code}]}}))}))},e.prototype.getUltraGroupUnreadMentionedCountByTargetId=function(e){return this._engine.getUltraGroupUnreadMentionedCountByTargetId(e)},e.prototype.getUltraGroupUnreadCountByTargetId=function(e){return this._engine.getUltraGroupUnreadCountByTargetId(e)},e.prototype.getAllUltraGroupUnreadCount=function(e){return void 0===e&&(e=!1),this._engine.getAllUltraGroupUnreadCount(e)},e.prototype.getAllConversationState=function(){return this._engine.getAllConversationState()},e.prototype.callExtra=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this._engine).callExtra.apply(t,fa([e],n,!1))},e.prototype.clearConversations=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){switch(n.label){case 0:return[4,this._engine.clearConversations(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.setUserStatusListener=function(e,t){return this._engine.setUserStatusListener(e,(function(e){try{t(e)}catch(e){Mg.error(e)}}))},e.prototype.addToBlacklist=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.addToBlacklist(e)]}))}))},e.prototype.removeFromBlacklist=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.removeFromBlacklist(e)]}))}))},e.prototype.getBlacklist=function(){return ha(this,void 0,void 0,(function(){return da(this,(function(e){return[2,this._engine.getBlacklist()]}))}))},e.prototype.getBlacklistStatus=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.getBlacklistStatus(e)]}))}))},e.prototype.insertMessage=function(e,t,n){return ha(this,void 0,void 0,(function(){return da(this,(function(r){return[2,this._engine.insertMessage(e,t,n)]}))}))},e.prototype.deleteMessages=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.deleteMessages(e)]}))}))},e.prototype.deleteMessagesByTimestamp=function(e,t,n,r,i){return void 0===i&&(i=""),ha(this,void 0,void 0,(function(){return da(this,(function(o){return[2,this._engine.deleteMessagesByTimestamp(e,t,n,r,i)]}))}))},e.prototype.clearMessages=function(e,t,n){return void 0===n&&(n=""),ha(this,void 0,void 0,(function(){return da(this,(function(r){return[2,this._engine.clearMessages(e,t,n)]}))}))},e.prototype.getMessage=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.getMessage(e)]}))}))},e.prototype.setMessageContent=function(e,t,n){return ha(this,void 0,void 0,(function(){return da(this,(function(r){return[2,this._engine.setMessageContent(e,t,n)]}))}))},e.prototype.setMessageSearchField=function(e,t,n){return ha(this,void 0,void 0,(function(){return da(this,(function(r){return[2,this._engine.setMessageSearchField(e,t,n)]}))}))},e.prototype.setMessageSentStatus=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._engine.setMessageSentStatus(e,t)]}))}))},e.prototype.setMessageReceivedStatus=function(e,t){return ha(this,void 0,void 0,(function(){return da(this,(function(n){return[2,this._engine.setMessageReceivedStatus(e,t)]}))}))},e.prototype.setUserStatus=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.setUserStatus(e)]}))}))},e.prototype.subscribeUserStatus=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.subscribeUserStatus(e)]}))}))},e.prototype.getUserStatus=function(e){return ha(this,void 0,void 0,(function(){return da(this,(function(t){return[2,this._engine.getUserStatus(e)]}))}))},e.prototype.searchConversationByContent=function(e,t,n,r){return void 0===t&&(t=[]),void 0===n&&(n=""),ha(this,void 0,void 0,(function(){return da(this,(function(i){return[2,this._engine.searchConversationByContent(e,t,n,r)]}))}))},e.prototype.searchMessageByContent=function(e,t,n,r,i,o,s){return void 0===s&&(s=""),ha(this,void 0,void 0,(function(){return da(this,(function(a){return[2,this._engine.searchMessageByContent(e,t,n,r,i,o,s)]}))}))},e.prototype.getUnreadMentionedMessages=function(e,t,n){return void 0===n&&(n=""),this._engine.getUnreadMentionedMessages(e,t,n)},e.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){return void 0===r&&(r=""),this._engine.clearUnreadCountByTimestamp(e,t,n,r)},e.prototype.getUltraGroupDefaultNotificationLevel=function(e,t){return void 0===t&&(t=""),this._engine.getUltraGroupDefaultNotificationLevel(e,t)},e.prototype.setUltraGroupDefaultNotificationLevel=function(e,t,n){return void 0===n&&(n=""),this._engine.setUltraGroupDefaultNotificationLevel(e,t,n)},e.prototype.getConversationNotificationLevel=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationNotificationLevel(e,t,n)},e.prototype.getConversationNotificationStatus=function(e,t,n){return void 0===n&&(n=""),this._engine.getConversationNotificationStatus(e,t,n)},e.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){return this._engine.getRemoteHistoryMessages(e,t,n,r,i,o)},e.prototype.getConversationListWithAllChannel=function(){return this._engine.getConversationListWithAllChannel()},e.prototype.getConversationListWithAllChannelByPage=function(e,t){return this._engine.getConversationListWithAllChannelByPage(e,t)},e.prototype.joinRTCRoom=function(e,t,n,r,i,o){return this._engine.joinRTCRoom(e,t,n,r,i,o)},e.prototype.quitRTCRoom=function(e){return this._engine.quitRTCRoom(e)},e.prototype.rtcPing=function(e,t,n){return this._engine.rtcPing(e,t,n)},e.prototype.getRTCRoomInfo=function(e){return this._engine.getRTCRoomInfo(e)},e.prototype.getRTCUserInfoList=function(e){return this._engine.getRTCUserInfoList(e)},e.prototype.getRTCUserInfo=function(e){return this._engine.getRTCUserInfo(e)},e.prototype.setRTCUserInfo=function(e,t,n){return this._engine.setRTCUserInfo(e,t,n)},e.prototype.removeRTCUserInfo=function(e,t){return this._engine.removeRTCUserInfo(e,t)},e.prototype.setRTCData=function(e,t,n,r,i,o){return this._engine.setRTCData(e,t,n,r,i,o)},e.prototype.setRTCTotalRes=function(e,t,n,r,i){return void 0===i&&(i=""),this._engine.setRTCTotalRes(e,t,n,r,i)},e.prototype.setRTCCDNUris=function(e,t,n){return this._engine.setRTCCDNUris(e,t,n)},e.prototype.getRTCData=function(e,t,n,r){return this._engine.getRTCData(e,t,n,r)},e.prototype.removeRTCData=function(e,t,n,r,i){return this._engine.removeRTCData(e,t,n,r,i)},e.prototype.setRTCOutData=function(e,t,n,r){return this._engine.setRTCOutData(e,t,n,r)},e.prototype.getRTCOutData=function(e,t){return this._engine.getRTCOutData(e,t)},e.prototype.getRTCToken=function(e,t,n){return this._engine.getRTCToken(e,t,n)},e.prototype.setRTCState=function(e,t){return this._engine.setRTCState(e,t)},e.prototype.getRTCUserList=function(e){return this._engine.getRTCUserList(e)},e.prototype.joinLivingRoomAsAudience=function(e,t,n){return this._engine.joinLivingRoomAsAudience(e,t,n)},e.prototype.quitLivingRoomAsAudience=function(e){return this._engine.quitLivingRoomAsAudience(e)},e.prototype.rtcIdentityChange=function(e,t,n){return this._engine.rtcIdentityChange(e,t,n)},e.prototype.getRTCJoinedUserInfo=function(e){return this._engine.getRTCJoinedUserInfo(e)},e.prototype.requestRoomPK=function(e){return this._engine.requestRoomPK(e)},e.prototype.cancelRoomPK=function(e){return this._engine.cancelRoomPK(e)},e.prototype.responseRoomPK=function(e){return this._engine.responseRoomPK(e)},e.prototype.endRoomPK=function(e){return this._engine.endRoomPK(e)},e.prototype.bindRTCRoomForChatroom=function(e){return this._engine.bindRTCRoomForChatroom(e)},e}();!function(e){e[e.add=1]="add",e[e.update=2]="update",e[e.delete=3]="delete"}(sL||(sL={}));var cL,uL=Object.freeze({__proto__:null,DelayTimer:$y,CometChannel:zA,WebSocketChannel:JA,AEngine:iU,version:"5.3.3",APIContext:aL,PluginContext:rL,RTCPluginContext:iL,get RTCMode(){return dv},get LiveType(){return fv},get LiveRole(){return pv},CallLibMsgType:_v,get RTCApiType(){return vv},get RTCIdentityChangeType(){return yv},get RTCJoinType(){return mv},FileType:cg,MessageDirection:Hg,ErrorCode:Yg,ConversationType:ng,ConnectionStatus:Qg,ReceivedStatus:Jr,ConnectResultCode:Jg,MessageType:Xg,NotificationStatus:$g,NotificationLevel:tv,MentionedType:rv,UploadMethod:ov,ChatroomEntryType:av,get LogLevel(){return e.LogLevel},get LogType(){return ig},ChatroomMemberChangeType:uv,MessageBlockType:hv,OperateStatus:gv,get HttpMethod(){return _w},get NetworkType(){return Cw},get TagChangeType(){return sL},isString:ug,isBoolean:lg,isNumber:hg,isArray:dg,isArrayBuffer:fg,notEmptyString:pg,notEmptyArray:function(e){return dg(e)&&e.length>0},isObject:gg,isFunction:vg,isUndefined:yg,isNull:mg,isHttpUrl:function(e){return ug(e)&&/https?:\/\//.test(e)},notEmptyObject:_g,isValidConversationType:function(e){return hg(e)&&Object.prototype.hasOwnProperty.call(ng,e)},isValidFileType:function(e){return hg(e)&&Object.prototype.hasOwnProperty.call(cg,e)},isValidExpansion:Cg,get AssertRules(){return kv},RCAssertError:Gv,assert:Fv,validate:Kv,getUploadFileName:Vy,getMimeKey:function(e){var t="application/octet-stream";switch(e){case cg.IMAGE:t="image/jpeg";break;case cg.AUDIO:t="audio/amr";break;case cg.VIDEO:t="video/3gpp";break;case cg.SIGHT:t="video/mpeg4";break;case cg.COMBINE_HTML:t="text/html"}return t},pushConfigsToJSON:By,pushJSONToConfigs:Gy,isValidChrmEntryKey:Fy,isValidChrmEntryValue:Ky,Logger:Sg,AppStorage:aa,todo:ga,appendUrl:Wc,EventEmitter:Kg,VersionManage:Vv,forEach:qy,map:Hy,indexOf:jy,isInclude:function(e,t){return-1!==jy(e,t)},isInObject:Yy,cloneByJSON:Wy,usingCppEngine:Qy,getBrowser:function(e){if("browser"!==e.tag)return{type:e.tag,version:"UnKonw"};var t,n,r=navigator.userAgent,i={IE:/rv:([\d.]+)\) like Gecko|MSIE ([\d.]+)/,Edge:/Edge\/([\d.]+)/,Firefox:/Firefox\/([\d.]+)/,Opera:/(?:OPERA|OPR).([\d.]+)/,WeChat:/MicroMessenger\/([\d.]+)/,QQBrowser:/QQBrowser\/([\d.]+)/,Chrome:/Chrome\/([\d.]+)/,Safari:/Version\/([\d.]+).*Safari/,iOSChrome:/Mobile\/([\d.]+).*Safari/};for(var o in i)if(i.hasOwnProperty(o)){var s=r.match(i[o]);if(s){n=o,t=s[1]||s[2];break}}return{type:n||"UnKonw",version:t||"UnKonw"}},formatConnectResponseCode:Jy,clone:Xy,NAVI_CACHE_DURATION:Qs,NAVI_REQ_TIMEOUT:1e4,PING_REQ_TIMEOUT:5e3,WEB_SOCKET_TIMEOUT:Js,PUBLIC_CLOUD_NAVI_URIS:zs,MINI_SOCKET_CONNECT_URIS:Xs,MINI_COMET_CONNECT_URIS:Zs,IM_SIGNAL_TIMEOUT:$s,IM_PING_INTERVAL_TIME:15e3,IM_PING_TIMEOUT:15e3,IM_PING_MIN_TIMEOUT:2e3,MAX_MESSAGE_CONTENT_BYTES:ea,IM_COMET_PULLMSG_TIMEOUT:45e3,IM_CHATROOM_PULL_INTERVAL_TIME:ta,STORAGE_ROOT_KEY:na,MAX_MESSAGE_EXPANSION_KEY_LENGTH:32,MAX_MESSAGE_EXPANSION_VAL_LENGTH:4096,SEND_MESSAGE_TYPE_OPTION:ra,CPP_PROTOCAL_MSGTYPE_OPTION:{"RC:DizNtf":{isCounted:!1,isPersited:!1}},STATUS_MESSAGE:ia,get CONNECTION_TYPE(){return Ys}});("undefined"!=typeof globalThis?globalThis:global||self).RCEngine=uL,function(e){e[e.SENDING=10]="SENDING",e[e.FAILED=20]="FAILED",e[e.SENT=30]="SENT",e[e.RECEIVED=40]="RECEIVED",e[e.READ=50]="READ",e[e.DESTROYED=60]="DESTROYED"}(cL||(cL={}));var lL,hL=cL;!function(e){e[e.NONE=0]="NONE",e[e.SQQUENCE=1]="SQQUENCE",e[e.REVERSE=2]="REVERSE"}(lL||(lL={}));var dL=lL,fL=function(){return!("undefined"==typeof uni||!function(e){for(var t=["canIUse","getSystemInfo"],n=0,r=t.length;n<r;n++)if(!e[t[n]])return!1;return!0}(uni))},pL=fL();var gL={tag:"browser",httpReq:function(e){var t=e.method||_w.GET,n=e.timeout||6e4,r=e.headers,i=e.query,o=e.body,s=Wc(e.url,i);return new Promise((function(e){var i,a=(i="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,"undefined"!=typeof XMLHttpRequest&&i?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")),c="[object XDomainRequest]"===Object.prototype.toString.call(a);if(a.open(t,s),r&&a.setRequestHeader)for(var u in r)a.setRequestHeader(u,r[u]);if(c){a.timeout=n,a.onload=function(){e({data:a.responseText,status:a.status||200})},a.onerror=function(){e({status:a.status||0})},a.ontimeout=function(){e({status:a.status||0})};var l="object"===zr(o)?JSON.stringify(o):o;a.send(l)}else a.onreadystatechange=function(){4===a.readyState&&e({data:a.responseText,status:a.status})},a.onerror=function(){e({status:a.status||0})},setTimeout((function(){a.abort(),e({status:a.status||0})}),n),a.send(o)}))},localStorage:null===window||void 0===window?void 0:window.localStorage,sessionStorage:null===window||void 0===window?void 0:window.sessionStorage,isSupportSocket:function(){var e="undefined"!=typeof WebSocket;return e||console.warn("websocket not support"),e},useNavi:!0,connectPlatform:"",isFromUniapp:pL,createWebSocket:function(e,t){var n=new WebSocket(e,t);return n.binaryType="arraybuffer",{onClose:function(e){n.onclose=function(t){var n=t.code,r=t.reason;e(n,r)}},onError:function(e){n.onerror=e},onMessage:function(e){n.onmessage=function(t){e(t.data)}},onOpen:function(e){n.onopen=e},send:function(e){n.send(e)},close:function(e,t){n.close()}}},createDataChannel:function(e,t){return this.isSupportSocket()&&"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=e.type,n=e.effectiveType,r=t||n||Cw.UNKONWN;return new Promise((function(e){e(r)}))}},vL=fL(),yL=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return wx[e].apply(wx,t)}catch(e){console.error(e)}}},mL={setItem:yL("setStorageSync"),getItem:yL("getStorageSync"),removeItem:yL("removeStorageSync"),clear:yL("clearStorageSync")},_L={tag:"wechat",httpReq:function(e){var t=e.method||_w.GET,n=e.timeout||6e4,r=e.headers,i=e.query,o=e.body,s=Wc(e.url,i);return new Promise((function(e){wx.request({url:s,method:t,headers:r,timeout:n,data:o,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:Yg.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:mL,sessionStorage:mL,isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:vL,createWebSocket:function(e,t){var n=wx.connectSocket({url:e,protocols:t});return{onClose:function(e){n.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){e(t.data)}))},onOpen:function(e){n.onOpen(e)},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){return new Promise((function(e){wx.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(Cw.UNKONWN)}})}))}},CL=fL(),EL=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return my[e].apply(my,t)}catch(e){console.error(e)}}},TL={setItem:EL("setStorageSync"),getItem:EL("getStorageSync"),removeItem:EL("removeStorageSync"),clear:EL("clearStorageSync")},IL={tag:"alipay",httpReq:function(e){var t=e.method||_w.GET,n=e.timeout||6e4,r=e.headers,i=e.query,o=e.body,s=Wc(e.url,i),a=e.dataType||"json";return new Promise((function(e){my.request({url:s,method:t,headers:r,timeout:n,data:o,dataType:a,success:function(t){e({data:t.data,status:t.status})},fail:function(){e({status:Yg.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:TL,sessionStorage:TL,isSupportSocket:function(){return!1},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:CL,createDataChannel:function(e,t){return"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){return new Promise((function(e){my.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(Cw.UNKONWN)}})}))}},RL=fL(),SL=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("tt",tt),tt[e].apply(tt,t)}catch(e){console.error(e)}}},ML={setItem:SL("setStorageSync"),getItem:SL("getStorageSync"),removeItem:SL("removeStorageSync"),clear:SL("clearStorageSync")},NL={tag:"toutiao",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:RL,localStorage:ML,sessionStorage:ML,httpReq:function(e){return new Promise((function(t,n){tt.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("è°ç¨æå",e.data);var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){console.log("è°ç¨å¤±è´¥",e.errMsg),n({data:e.errMsg})}})}))},createWebSocket:function(e,t){var n=tt.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){return new Promise((function(e){tt.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(Cw.UNKONWN)}})}))}},OL=fL(),wL=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return console.log("swan",swan),swan[e].apply(swan,t)}catch(e){console.error(e)}}},AL={setItem:wL("setStorageSync"),getItem:wL("getStorageSync"),removeItem:wL("removeStorageSync"),clear:wL("clearStorageSync")},UL={tag:"baidu",isSupportSocket:function(){return!0},useNavi:!1,connectPlatform:"MiniProgram",isFromUniapp:OL,localStorage:AL,sessionStorage:AL,httpReq:function(e){return new Promise((function(t,n){swan.request({url:e.url,data:e.body,header:e.headers,method:e.method,success:function(e){console.log("è°ç¨æå",e.data);var n=(null==e?void 0:e.data)||{},r={data:JSON.stringify(n),status:e.statusCode};t(r)},fail:function(e){console.log("è°ç¨å¤±è´¥",e.errorCode),n({data:e.errorCode})}})}))},createWebSocket:function(e,t){var n=swan.connectSocket({url:e,protocols:t});return{onOpen:function(e){n.onOpen(e)},onClose:function(e){n.onClose((function(t){return e(t.code,t.reason)}))},onError:function(e){n.onError((function(t){return e(t.errMsg)}))},onMessage:function(e){n.onMessage((function(t){return e(t.data)}))},send:function(e){n.send({data:e})},close:function(e,t){n.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){return ha(this,void 0,void 0,(function(){return da(this,(function(e){return[2,new Promise((function(e){swan.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(Cw.UNKONWN)}})}))]}))}))}},bL=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return uni[e].apply(uni,t)}catch(e){console.error(e)}}},LL={setItem:bL("setStorageSync"),getItem:bL("getStorageSync"),removeItem:bL("removeStorageSync"),clear:bL("clearStorageSync")},PL={tag:"uniapp",httpReq:function(e){var t=e.method||_w.GET,n=e.timeout||6e4,r=e.headers,i=e.query,o=e.body,s=Wc(e.url,i);return new Promise((function(e){uni.request({url:s,method:t,headers:r,timeout:n,data:o,success:function(t){e({data:t.data,status:t.statusCode})},fail:function(){e({status:Yg.RC_HTTP_REQ_TIMEOUT})}})}))},localStorage:LL,sessionStorage:LL,isSupportSocket:function(){return!0},useNavi:!0,connectPlatform:"",isFromUniapp:!0,createWebSocket:function(e,t){var n={complete:function(){},url:e,protocols:t},r=uni.connectSocket(n);return{onClose:function(e){r.onClose((function(t){e(t.code,t.reason)}))},onError:function(e){r.onError((function(t){e(t.errMsg)}))},onMessage:function(e){r.onMessage((function(t){e(t.data)}))},onOpen:function(e){r.onOpen(e)},send:function(e){r.send({data:e})},close:function(e,t){r.close({code:e,reason:t})}}},createDataChannel:function(e,t){return"websocket"===t?new JA(this,e):new zA(this,e)},getNetworkType:function(){return new Promise((function(e){uni.getNetworkType({success:function(t){var n=t.networkType;e(n)},fail:function(){e(Cw.UNKONWN)}})}))}},DL=function(e){return e&&e.canIUse&&e.getSystemInfo},xL="undefined"!=typeof uni&&DL(uni)?function(){switch(process.env.VUE_APP_PLATFORM){case"app-plus":return PL;case"mp-baidu":return UL;case"mp-toutiao":return NL;case"mp-alipay":return IL;case"mp-weixin":return _L;default:return gL}}():"undefined"!=typeof my&&DL(my)?IL:"undefined"!=typeof tt&&DL(tt)?NL:"undefined"!=typeof swan&&DL(swan)?UL:"undefined"!=typeof wx&&DL(wx)?_L:gL,kL=new Sg("RCIM");function VL(e,t,n){return e+"_"+t+"_"+n}var BL=function(){function e(){}return e.set=function(t){if(ra[t.messageType]&&ra[t.messageType].isPersited){var n=e.get(t.conversationType,t.targetId,t.channelId||"");if(!n||n.sentTime<t.sentTime){var r=VL(t.conversationType,t.targetId,t.channelId||"");e.map[r]=t}}},e.get=function(t,n,r){var i=VL(t,n,r);return e.map[i]||null},e.remove=function(t,n,r){var i=VL(t,n,r);delete e.map[i]},e.clear=function(){e.map={}},e.map={},e}(),GL={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:ReferenceMsg":"ReferenceMessage","RC:FileMsg":"FileMessage","RC:HQVCMsg":"HQVoiceMessage","RC:GIFMsg":"GIFMessage","RC:SightMsg":"SightMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage","RC:TypSts":"TypingStatusMessage","RC:CsChaR":"ChangeModeResponseMessage","RC:CsHsR":"HandShakeResponseMessage","RC:CsEnd":"TerminateMessage","RC:CsSp":"SuspendMessage","RC:CsUpdate":"CustomerStatusUpdateMessage","RC:ReadNtf":"ReadReceiptMessage","RC:VCAccept":"AcceptMessage","RC:VCRinging":"RingingMessage","RC:VCSummary":"SummaryMessage","RC:VCHangup":"HungupMessage","RC:VCInvite":"InviteMessage","RC:VCModifyMedia":"MediaModifyMessage","RC:VCModifyMem":"MemberModifyMessage","RC:CsContact":"CustomerContact","RC:PSImgTxtMsg":"PublicServiceRichContentMessage","RC:PSMultiImgTxtMsg":"PublicServiceMultiRichContentMessage","RC:GrpNtf":"GroupNotificationMessage","RC:PSCmd":"PublicServiceCommandMessage","RC:RcCmd":"RecallCommandMessage","RC:SRSMsg":"SyncReadStatusMessage","RC:RRReqMsg":"ReadReceiptRequestMessage","RC:RRRspMsg":"ReadReceiptResponseMessage","RCJrmf:RpMsg":"JrmfRedPacketMessage","RCJrmf:RpOpendMsg":"JrmfRedPacketOpenedMessage","RC:CombineMsg":"RCCombineMessage","RC:chrmKVNotiMsg":"ChrmKVNotificationMessage","RC:LogCmdMsg":"LogCommandMessage","RC:MsgExMsg":"ExpansionCommandMessage","RC:RRMsg":"GroupReadReceiptResponseMessage"},FL={},KL=new aa(xL,"API-V2");function qL(e){var t=e.channelId,n=e.conversationType,r=e.targetId,i=e.unreadMessageCount,o=e.latestMessage,s=e.isTop,a=e.notificationStatus,c=e.matchCount;if(!Qy()){var u=BL.get(n,r,t||"");o?u&&o.sentTime<u.sentTime&&(o=u):o=u}var l=o?HL(o):null;return{channelId:t||"",conversationType:n,targetId:r,unreadMessageCount:i,latestMessage:l,latestMessageId:null==l?void 0:l.messageId,objectName:null==l?void 0:l.messageType,sentTime:null==l?void 0:l.sentTime,isTop:s,notificationStatus:a,receivedStatus:null==l?void 0:l.receivedStatus,matchCount:c}}function HL(e){var t=e.conversationType,n=e.targetId,r=e.senderUserId,i=e.content,o=e.messageType,s=e.messageUId,a=e.messageDirection,c=e.isOffLineMessage,u=e.sentTime,l=e.receivedStatus,h=e.receivedTime,d=e.canIncludeExpansion,f=e.disableNotification,p=e.expansion,g=e.messageId,v=e.sentStatus,y=e.channelId,m=e.readReceiptInfo,_=e.pushConfig,C="";return o in GL?C=GL[o]:o in FL?C=FL[o]:(i={message:{content:i,objectName:o},messageName:"UnknownMessage"},C="UnknownMessage"),l||(l=Jr.UNREAD),void 0===g&&(g=~~(16777215*Math.random())),{channelId:y||"",conversationType:t,targetId:n,senderUserId:r,content:i,messageType:C,messageUId:s,messageDirection:a,offLineMessage:c,sentTime:u,receivedStatus:l,receivedTime:h,objectName:o,messageId:g,sentStatus:v||hL.SENT,disableNotification:f,canIncludeExpansion:d,expansion:p,readReceiptInfo:m,pushConfig:_}}function jL(e,t,n,r){var i=new Date(n-1e3*r*60*60*24).getTime()-e.sentTime<0,o=e.messageType,s=e.messageDirection;if("ReadReceiptRequestMessage"===o&&i&&s===Hg.SEND){var a="".concat(t).concat(e.content.messageUId,"SENT");KL.set(a,{count:0,dealtime:e.sentTime,userIds:{}})}else if("ReadReceiptRequestMessage"===o&&i){var c="".concat(t).concat(e.conversationType).concat(e.targetId,"RECEIVED"),u=KL.get(c);if(u)if(e.senderUserId in u)u[e.senderUserId].uIds&&-1===u[e.senderUserId].uIds.indexOf(e.content.messageUId)&&(u[e.senderUserId].uIds.push(e.content.messageUId),u[e.senderUserId].dealtime=e.sentTime,u[e.senderUserId].isResponse=!1,KL.set(c,u));else{var l={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1};u[e.senderUserId]=l,KL.set(c,u)}else{var h={};h[e.senderUserId]={uIds:[e.content.messageUId],dealtime:e.sentTime,isResponse:!1},KL.set(c,h)}}}function YL(e,t,n){try{e(t,n)}catch(e){kL.error(e)}}function WL(e,t,n){try{e(t,n)}catch(e){kL.error(e)}}var QL=function(e,t,n,r,i){void 0===r&&(r=!0),void 0===i&&(i=!0),this.messageType=e,this.objectName=t,this.content=n,this.isPersited=r,this.isCounted=i};function JL(e,t,n,r){void 0===n&&(n=!0),void 0===r&&(r=!0);var i=function(i){return new QL(e,t,i,n,r)};return i.MessageType=e,i.ObjectName=t,i}var zL,XL,ZL=JL("ReadReceiptResponseMessage","RC:RRRspMsg"),$L=function(){function e(e,t,n,r){this._context=e,this.channelId=t,this._isCPPMode=n,this._readReceiptTimeout=r,this._storage=KL,this._draftMap={}}return e.prototype.getConversationList=function(e,t,n){Fv("callback",e,kv.CALLBACK),Fv("conversationTypes",t,kv.ARRAY),Fv("count",n,kv.NUMBER),this._context.getConversationList(n,void 0,0,0,this.channelId).then((function(n){var r=n.code,i=n.data,o=[];i=i||[],r===Yg.SUCCESS?(t?i.forEach((function(e){t.indexOf(e.conversationType)>-1&&o.push(qL(e))})):i.forEach((function(e){o.push(qL(e))})),YL(e.onSuccess,o)):(kL.warn("getConversationList -> code:"+r),WL(e.onError,r))}))},e.prototype.getConversation=function(e,t,n){var r=this;Fv("callback",n,kv.CALLBACK),Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),kL.info("getConversation ->targetId:"+t+",conversationType:"+e),ha(r,void 0,void 0,(function(){var r,i,o;return da(this,(function(s){switch(s.label){case 0:return[4,this._context.getConversation(e,t,this.channelId)];case 1:return r=s.sent(),i=r.code,o=r.data,i!==Yg.SUCCESS?(kL.warn("getConversation ->code:"+i+",targetId:"+t),n.onError(i),[2]):(n.onSuccess(o?qL(o):null),[2])}}))}))},e.prototype.removeConversation=function(e,t,n){var r=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),kL.info("removeConversation ->targetId:"+t+",conversationType:"+e),this._context.removeConversation(e,t,this.channelId).then((function(i){i===Yg.SUCCESS?(r._isCPPMode||BL.remove(e,t,r.channelId),YL(n.onSuccess)):(kL.warn("removeConversation ->code:"+i+",targetId:"+t),WL(n.onError,i))}))},e.prototype.saveTextMessageDraft=function(e,t,n){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("draftText",n,kv.STRING,!0),kL.info("saveTextMessageDraft ->targetId:"+t+",conversationType:"+e);var r=this._context.getCurrentUserId();return!!r&&((this._draftMap[r]=this._draftMap[r]||{})["".concat(e,"_").concat(t,"_").concat(this.channelId)]=n,!0)},e.prototype.getTextMessageDraft=function(e,t){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),kL.info("getTextMessageDraft ->targetId:"+t+",conversationType:"+e);var n=this._context.getCurrentUserId();if(n)return(this._draftMap[n]||{})["".concat(e,"_").concat(t,"_").concat(this.channelId)]},e.prototype.clearTextMessageDraft=function(e,t){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),kL.info("clearTextMessageDraft ->targetId:"+t+",conversationType:"+e);var n=this._context.getCurrentUserId();return!!n&&delete(this._draftMap[n]||{})["".concat(e,"_").concat(t,"_").concat(this.channelId)]},e.prototype.getTotalUnreadCount=function(e,t,n){Fv("callback",e,kv.CALLBACK),kL.info("getTotalUnreadCount ->conversationTypes:"+t),this._context.getTotalUnreadCount(this.channelId,t,n).then((function(t){var n=t.code,r=t.data;n===Yg.SUCCESS?YL(e.onSuccess,r):(kL.warn("getTotalUnreadCount ->code:"+n),WL(e.onError,n))}))},e.prototype.getUnreadCount=function(e,t,n){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),kL.info("getUnreadCount ->targetId:"+t+",conversationType:"+e),this._context.getUnreadCount(e,t,this.channelId).then((function(e){var r=e.code,i=e.data;r===Yg.SUCCESS?YL(n.onSuccess,i):(kL.warn("getUnreadCount ->code:"+r+",targetId:"+t),WL(n.onError,r))}))},e.prototype.clearConversations=function(e,t){kL.info("clearConversations -> conversationTypes:"+t),this._isCPPMode?this._context.clearConversations(t,this.channelId).then((function(t){t===Yg.SUCCESS?YL(e.onSuccess,!0):(kL.warn("clearConversations ->code:"+t),WL(e.onError,t))})):kL.error("Method is only available in cppProtocol mode")},e.prototype.clearUnreadCount=function(e,t,n){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),kL.info("clearUnreadCount ->targetId:"+t+",conversationType:"+e),this._context.clearUnreadCount(e,t,this.channelId).then((function(e){e===Yg.SUCCESS?YL(n.onSuccess,!0):(kL.warn("clearUnreadCount ->code:"+e+",targetId:"+t),WL(n.onError,e))}))},e.prototype.clearAllUnreadCount=function(e){Fv("callback",e,kv.CALLBACK),kL.info("clearUnreadCount ->"),this._context.clearAllUnreadCount().then((function(t){t===Yg.SUCCESS?YL(e.onSuccess,!0):(kL.warn("clearUnreadCount ->code:"+t),WL(e.onError,t))}))},e.prototype.getFirstUnreadMessage=function(e,t,n){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),kL.info("getFirstUnreadMessage ->targetId:"+t+",conversationType:"+e),this._context.getFirstUnreadMessage(e,t,this.channelId).then((function(e){e.code===Yg.SUCCESS?YL(n.onSuccess,e.data?HL(e.data):null):(kL.warn("getFirstUnreadMessage ->code:"+e.code+",targetId:"+t),WL(n.onError,e.code))}))},e.prototype.setConversationStatus=function(e,t,n,r){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",r,kv.CALLBACK),Fv("status",n,kv.OBJECT,!0),kL.info("setConversationStatus ->targetId:"+t+",status:"+n);var i=n.isTop,o=n.notificationStatus;this._context.setConversationStatus(e,t,i,o,this.channelId).then((function(e){e===Yg.SUCCESS?YL(r.onSuccess):(kL.warn("setConversationStatus ->code:"+e+",targetId:"+t),WL(r.onError,e))}))},e.prototype.sendMessage=function(e,t,n,r,i,o,s,a){var c=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("msg",n,kv.OBJECT,!0),Fv("callback",r,kv.CALLBACK),Fv("isMentioned",i,kv.BOOLEAN),Fv("pushContent",o,kv.ONLY_STRING),Fv("pushData",s,kv.ONLY_STRING),Fv("options.userIds",null==a?void 0:a.userIds,kv.ARRAY),Fv("options.isVoipPush",null==a?void 0:a.isVoipPush,kv.BOOLEAN),Fv("options.disableNotification",null==a?void 0:a.disableNotification,kv.BOOLEAN),Fv("options.canIncludeExpansion",null==a?void 0:a.canIncludeExpansion,kv.BOOLEAN),Fv("options.expansion",null==a?void 0:a.expansion,kv.OBJECT),Fv("options.pushConfig",null==a?void 0:a.pushConfig,kv.OBJECT),kL.info("sendMessage ->targetId:"+t+",conversationType:"+e);var u=!(!(null==a?void 0:a.isStatusMessage)&&!(null==a?void 0:a.isStatus)),l=function(e,t,n){var r,i=e||{},o=i.userIds,s=i.isVoipPush,a=i.disableNotification,c=i.isFilerWhiteBlacklist,u=i.expansion,l=i.canIncludeExpansion,h=i.pushConfig,d=[];if(t){var f=(n||{}).content.mentionedInfo;d=f.userIdList,r=f.type}return{mentionedType:r,mentionedUserIdList:d,directionalUserIdList:o,isVoipPush:s,disableNotification:a,isFilerWhiteBlacklist:c,expansion:u,canIncludeExpansion:l,pushConfig:h}}(a,i,n),h=Object.assign(n,la(la({isMentioned:i,pushContent:o,pushData:s},l),{messageType:n.objectName,channelId:this.channelId,isStatusMessage:u})),d=this._context.getCurrentUserId();this._context.sendMessage(e,t,h,r.onBefore).then((function(i){var o=i.code,s=i.data;if(o===Yg.SUCCESS){c._isCPPMode||BL.set(s);var l=HL(s);jL(l,d,c._context.getConnectedTime(),c._readReceiptTimeout),YL(r.onSuccess,l)}else kL.warn("sendMessage ->code:"+o+",targetId:"+t),WL(r.onError,o,HL({isMentioned:!!h.isMentioned,content:n.content,messageType:n.messageType,isPersited:n.isPersited,isCounted:n.isCounted,disableNotification:!!(null==a?void 0:a.disableNotification),canIncludeExpansion:!!(null==a?void 0:a.canIncludeExpansion),expansion:(null==a?void 0:a.expansion)||null,conversationType:e,targetId:t,senderUserId:d,messageUId:"",messageDirection:Hg.SEND,isOffLineMessage:!1,sentTime:(null==s?void 0:s.sentTime)||0,receivedTime:0,isStatusMessage:u,receivedStatus:Jr.UNREAD,messageId:null==s?void 0:s.messageId,sentStatus:hL.FAILED}))}))},e.prototype.sendRecallMessage=function(e,t,n){var r=this;Fv("message.conversationType",e.conversationType,kv.NUMBER,!0),Fv("message.targetId",e.targetId,kv.STRING,!0),Fv("message.messageUId",e.messageUId,kv.STRING,!0),Fv("message.sentTime",e.sentTime,kv.NUMBER,!0),Fv("callback",t,kv.CALLBACK),Fv("options.disableNotification",null==n?void 0:n.disableNotification,kv.BOOLEAN),Fv("options.pushConfig",null==n?void 0:n.pushConfig,kv.OBJECT),Fv("options.extra",null==n?void 0:n.extra,kv.STRING);var i=e.conversationType,o=e.targetId,s=e.messageUId,a=e.sentTime;kL.info("sendRecallMessage ->targetId:"+o+",conversationType:"+i+",messageUId:"+s);var c=la({channelId:this.channelId},n);this._context.recallMessage(i,o,s,a,c).then((function(e){var n=e.code,i=e.data;n===Yg.SUCCESS?(r._isCPPMode||BL.set(i),YL(t.onSuccess,HL(i))):(kL.warn("sendRecallMessage ->code:"+n+",targetId:"+o+",messageUId:"+s),WL(t.onError,n))}))},e.prototype.sendTypingStatusMessage=function(e,t,n,r){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("typingContentType",n,kv.STRING,!0),Fv("callback",r,kv.CALLBACK),kL.info("sendTypingStatusMessage ->targetId:"+t+",conversationType:"+e);var i={messageType:"RC:TypSts",content:{typingContentType:n},isStatusMessage:!0,channelId:this.channelId};this._context.sendMessage(e,t,i).then((function(e){var n=e.code,i=e.data;n===Yg.SUCCESS?YL(r.onSuccess,HL(i)):(kL.warn("sendTypingStatusMessage ->code:"+n+",targetId:"+t),WL(r.onError,n))}))},e.prototype.sendReceiptResponse=function(e,t,n){var r=this;kL.info("sendReceiptResponse ->targetId:"+t+",conversationType:"+e);var i=this._context.getCurrentUserId(),o="".concat(i).concat(e).concat(t,"RECEIVED"),s=this._storage.get(o);if(s){var a=[];for(var c in s){var u={};u[c]=s[c].uIds,s[c].isResponse||a.push(u)}if(0===a.length)return void n.onSuccess(null);var l=setInterval((function(){1===a.length&&clearInterval(l);var i=a.splice(0,1)[0],c=new ZL({receiptMessageDic:i});r.sendMessage(e,t,c,{onSuccess:function(e){var t=Object.keys(i)[0];s[t].isResponse=!0,r._storage.set(o,s),YL(n.onSuccess,e)},onError:function(e){kL.warn("sendReceiptResponse ->code:"+e+",targetId:"+t),WL(n.onError,e)}})}),200)}else n.onSuccess(null)},e.prototype.sendReadReceiptMessage=function(e,t,n){Fv("messageUIds",e,kv.ARRAY,!0),Fv("targetId",t,kv.STRING,!0),kL.info("sendReadReceiptMessage ->targetId:"+t+",messageUIds:"+e);for(var r=0,i=e;r<i.length;r++){var o=i[r];Fv("messageUId",o,kv.STRING)}this._context.sendReadReceiptMessage(t,e,this.channelId).then((function(r){var i=r.code;i===Yg.SUCCESS?n.onSuccess():(kL.warn("sendReadReceiptMessage ->code:"+i+",targetId:"+t+",messageUIds:"+e),n.onError(i))})).catch((function(r){kL.warn("sendReadReceiptMessage ->code:"+r+",targetId:"+t+",messageUIds:"+e),n.onError(r)}))},e.prototype.getMessageReader=function(e,t,n){Fv("messageUId",e,kv.STRING,!0),Fv("targetId",t,kv.STRING,!0),kL.info("getMessageReader ->targetId:"+t+",messageUId:"+e),this._context.getMessageReader(t,e,this.channelId).then((function(r){var i=r.code,o=r.data;i===Yg.SUCCESS?n.onSuccess(o):(kL.warn("getMessageReader ->code:"+i+",targetId:"+t+",messageUId:"+e),n.onError(i))})).catch((function(r){kL.warn("getMessageReader ->code:"+r+",targetId:"+t+",messageUId:"+e),n.onError(r)}))},e.prototype.updateMessageExpansion=function(e,t,n){Fv("expansion",e,kv.OBJECT,!0),Fv("message",t,kv.OBJECT,!0);var r=t.conversationType,i=t.targetId,o=t.messageUId,s=t.canIncludeExpansion,a=t.expansion;kL.info("updateMessageExpansion ->targetId:"+i+",messageUId:"+o+",conversationType:"+r),this._context.sendExpansionMessage({conversationType:r,targetId:i,messageUId:o,canIncludeExpansion:s,originExpansion:a,expansion:e,channelId:this.channelId}).then((function(e){var t=e.code;t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("updateMessageExpansion ->code:"+t+",targetId:"+i+",messageUId:"+o),WL(n.onError,t))}))},e.prototype.removeMessageExpansionForKey=function(e,t,n){Fv("keys",e,kv.ARRAY,!0),Fv("message",t,kv.OBJECT,!0);var r=t.conversationType,i=t.targetId,o=t.messageUId,s=t.canIncludeExpansion;kL.info("removeMessageExpansionForKey ->targetId:"+i+",messageUId:"+o+",conversationType:"+r),this._context.sendExpansionMessage({conversationType:r,targetId:i,messageUId:o,canIncludeExpansion:s,keys:e,channelId:this.channelId}).then((function(e){var t=e.code;t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("removeMessageExpansionForKey ->code:"+t+",targetId:"+i+",messageUId:"+o),WL(n.onError,t))}))},e.prototype.getHistoryMessages=function(e,t,n,r,i,o,s){Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("timestamp",n,kv.NUMBER,!0),Fv("count",r,kv.NUMBER,!0),Fv("callback",i,kv.CALLBACK,!0),Fv("order",s,kv.NUMBER),kL.info("getHistoryMessages ->targetId:"+t+",conversationType:"+e+",timestamp:"+n),this._context.getHistoryMessage(e,t,n,r,s,this.channelId,o).then((function(e){var n=e.code,r=e.data;if(n===Yg.SUCCESS)if(r){var o=r.list,s=r.hasMore,a=o.map((function(e){return HL(e)}));YL(i.onSuccess,a,s)}else YL(i.onSuccess,[],!1);else kL.warn("getHistoryMessages ->code:"+n+",targetId:"+t),WL(i.onError,n)}))},e.prototype.deleteRemoteMessages=function(e,t,n,r){var i=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("messages",n,kv.ARRAY,!0),Fv("callback",r,kv.CALLBACK),kL.info("deleteRemoteMessages ->targetId:"+t+",conversationType:"+e),this._context.deleteRemoteMessage(e,t,n,this.channelId).then((function(o){if(o===Yg.SUCCESS){if(!i._isCPPMode){var s=BL.get(e,t,i.channelId);s&&n.forEach((function(n){s.messageUId===n.messageUId&&BL.remove(e,t,i.channelId)}))}YL(r.onSuccess)}else kL.warn("deleteRemoteMessages ->code:"+o+",targetId:"+t),WL(r.onError,o)}))},e.prototype.clearRemoteHistoryMessages=function(e,t){Fv("param.conversationType",e.conversationType,kv.NUMBER,!0),Fv("param.targetId",e.targetId,kv.STRING,!0),Fv("param.timestamp",e.timestamp,kv.NUMBER,!0),Fv("callback",t,kv.CALLBACK);var n=e.conversationType,r=e.targetId,i=e.timestamp;kL.info("clearRemoteHistoryMessages ->targetId:"+r+",conversationType:"+n),this._context.deleteRemoteMessageByTimestamp(n,r,i,this.channelId).then((function(e){e===Yg.SUCCESS?YL(t.onSuccess):(kL.warn("clearRemoteHistoryMessages ->code:"+e),WL(t.onError,e))}))},e.prototype.getConversationListWithAllChannel=function(e){Fv("callback",e,kv.CALLBACK),this._context.getConversationListWithAllChannel().then((function(t){var n=t.code,r=t.data;n===Yg.SUCCESS?YL(e.onSuccess,r.map(qL)):WL(e.onError,n)}))},e.prototype.getConversationListWithAllChannelByPage=function(e,t,n){Fv("callback",e,kv.CALLBACK),Fv("index",t,kv.NUMBER),Fv("limit",n,kv.NUMBER),this._context.getConversationListWithAllChannelByPage(t,n).then((function(t){var n=t.code,r=t.data;n===Yg.SUCCESS?YL(e.onSuccess,r.map(qL)):WL(e.onError,n)}))},e.prototype.insertMessage=function(e,t,n,r,i){void 0===i&&(i={});var o=n.senderUserId,s=n.objectName,a=n.content,c=n.messageDirection,u=n.messageUId,l=n.canIncludeExpansion,h=n.expansion,d=n.disableNotification,f=n.sentTime,p=n.sentStatus;kL.info("insertMessage ->targetId:"+t+",conversationType:"+e);var g=i.isUnread,v={senderUserId:o,messageType:s,content:a,messageDirection:c,sentTime:f,sentStatus:p,searchContent:i.searchContent,isUnread:g,messageUId:u,disableNotification:d,canIncludeExpansion:l,expansionMsg:JSON.stringify(h),channelId:this.channelId};this._context.insertMessage(e,t,v).then((function(e){var n=e.code,i=e.data;n===Yg.SUCCESS?YL(r.onSuccess,HL(i)):(kL.warn("insertMessage ->code:"+n+",targetId:"+t),WL(r.onError,n))}))},e.prototype.deleteLocalMessagesByTimestamp=function(e,t,n,r,i){kL.info("deleteLocalMessagesByTimestamp ->targetId:"+t+",conversationType:"+e+",timestamp:"+n),this._context.deleteMessagesByTimestamp(e,t,n,r,this.channelId).then((function(e){e===Yg.SUCCESS?YL(i.onSuccess,!0):(kL.warn("deleteLocalMessagesByTimestamp ->code:"+e+",targetId:"+t),WL(i.onError,e))}))},e.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){kL.info("getRemoteHistoryMessages ->targetId:"+t+",conversationType:"+e);var s=o.order||0;this._context.getRemoteHistoryMessages(e,t,n,r,s,this.channelId).then((function(e){var n=e.code,r=e.data;if(n===Yg.SUCCESS)if(r){var o=r.list,s=r.hasMore,a=o.map((function(e){return HL(e)}));YL(i.onSuccess,a,s)}else YL(i.onSuccess,[],!1);else kL.warn("getRemoteHistoryMessages ->code:"+n+",targetId:"+t),WL(i.onError,n)}))},e.prototype.clearMessages=function(e,t,n){var r=this;kL.info("clearMessages ->targetId:"+t+",conversationType:"+e),this._context.clearMessages(e,t,this.channelId).then((function(i){i===Yg.SUCCESS?(r._isCPPMode||BL.remove(e,t,r.channelId),YL(n.onSuccess,!0)):(kL.warn("clearMessages ->code:"+i+",targetId:"+t),WL(n.onError,i))}))},e.prototype.searchConversationByContent=function(e,t,n,r){kL.info("searchConversationByContent ->keyword:"+e),this._context.searchConversationByContent(e,r,this.channelId,n).then((function(n){var r=n.code,i=n.data,o=[];i=i||[],r===Yg.SUCCESS?(i.forEach((function(e){o.push(qL(e))})),YL(t.onSuccess,o)):(kL.warn("searchConversationByContent ->code:"+r+",keyword:"+e),WL(t.onError,r))}))},e.prototype.searchMessageByContent=function(e,t,n,r,i,o,s){kL.info("setConversationStatus ->targetId:"+t+",conversationType:"+e+",keyword:"+n),this._context.searchMessageByContent(e,t,n,r,i,o,this.channelId).then((function(e){var n=e.code,r=e.data,i=[];if(n===Yg.SUCCESS){var o=r=r||{},a=o.messages,c=o.count;a.forEach((function(e){i.push(HL(e))})),YL(s.onSuccess,i,c)}else kL.warn("searchMessageByContent ->code:"+n+",targetId:"+t),WL(s.onError,n)}))},e.prototype.getUnreadMentionedMessages=function(e,t){return kL.info("getUnreadMentionedMessages ->targetId:"+t+",conversationType:"+e),this._context.getUnreadMentionedMessages(e,t,this.channelId).map((function(e){return HL(e)}))},e.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){kL.info("clearUnreadCountByTimestamp ->targetId:"+t+",conversationType:"+e),this._context.clearUnreadCountByTimestamp(e,t,n,this.channelId).then((function(e){e===Yg.SUCCESS?YL(r.onSuccess,!0):(kL.warn("clearUnreadCountByTimestamp ->code:"+e+",targetId:"+t),WL(r.onError,e))}))},e.prototype.getConversationNotificationStatus=function(e,t,n){kL.info("getConversationNotificationStatus ->targetId:"+t+",conversationType:"+e),this._context.getConversationNotificationStatus(e,t,this.channelId).then((function(e){var r=e.code,i=e.data;r===Yg.SUCCESS?YL(n.onSuccess,i):(kL.warn("getConversationNotificationStatus ->code:"+r+",targetId:"+t),WL(n.onError,r))}))},e}(),eP=function(e){return{targetId:e.targetId,channelId:e.channelId,conversationType:e.type}},tP=function(){function e(e,t){this._context=e,this._options=t,this._channelClient={},this._isCPPMode=Qy(),this._defaultChannelClient=new $L(e,"",this._isCPPMode,t.readReceiptTimeout)}return e.prototype.assertCPPMode=function(e,t,n){if(!this._isCPPMode)return n&&n.onError(Yg.NOT_SUPPORT),void kL.error("'".concat(t,"' is unusable!"));e()},e.prototype.install=function(e,t){return this._context.install(e,t)},e.prototype.getChannel=function(e){return kL.info("getChannel ->channelId:"+e),this._isCPPMode?(Fv("channelId",e,kv.STRING,!0),e.length>20?(kL.error("The channelId cannot exceed 20 characters"),null):e in this._channelClient?this._channelClient[e]:Object.keys(this._channelClient).length>1e3?(kL.error("Only 1000 channels can be obtained"),null):(this._channelClient[e]=new $L(this._context,e,this._isCPPMode,this._options.readReceiptTimeout),this._channelClient[e])):(kL.error("getChannel method is only available in protocol stack mode"),null)},e.prototype.deleteChannels=function(e){var t=this;Fv("channelIds",e,kv.ARRAY,!0),kL.info("deleteChannels ->channelIds:"+e),this.assertCPPMode((function(){e.forEach((function(e){delete t._channelClient[e]}))}),"deleteChannels")},e.prototype.getNavi=function(){return this._context.getInfoFromCache()||{}},e.prototype.getSDKInfo=function(){return{version:this._context.apiVersion}},e.prototype.getAppInfo=function(){return{appKey:this._context.appkey}},e.prototype.getCurrentUserId=function(){return this._context.getCurrentUserId()},e.prototype.disconnect=function(){return ha(this,void 0,void 0,(function(){return da(this,(function(e){switch(e.label){case 0:return[4,this._context.disconnect()];case 1:return e.sent(),[2]}}))}))},e.prototype.logout=function(){return this.disconnect()},e.prototype.clearCache=function(){},e.prototype.getConversationList=function(e,t,n){this._defaultChannelClient.getConversationList(e,t,n)},e.prototype.getConversationListWithAllChannel=function(e){this._defaultChannelClient.getConversationListWithAllChannel(e)},e.prototype.getConversationListWithAllChannelByPage=function(e,t,n){void 0===n&&(n=30),this._defaultChannelClient.getConversationListWithAllChannelByPage(e,t,n)},e.prototype.getConversation=function(e,t,n){return this._defaultChannelClient.getConversation(e,t,n)},e.prototype.removeConversation=function(e,t,n){return this._defaultChannelClient.removeConversation(e,t,n)},e.prototype.saveTextMessageDraft=function(e,t,n){return this._defaultChannelClient.saveTextMessageDraft(e,t,n)},e.prototype.getTextMessageDraft=function(e,t){return this._defaultChannelClient.getTextMessageDraft(e,t)},e.prototype.clearTextMessageDraft=function(e,t){return this._defaultChannelClient.clearTextMessageDraft(e,t)},e.prototype.getTotalUnreadCount=function(e,t,n){return this._defaultChannelClient.getTotalUnreadCount(e,t,n)},e.prototype.getUnreadCount=function(e,t,n){return this._defaultChannelClient.getUnreadCount(e,t,n)},e.prototype.getConversationUnreadCount=function(e,t){kL.error("Method is deprecated")},e.prototype.clearConversations=function(e,t){return this._defaultChannelClient.clearConversations(e,t)},e.prototype.clearUnreadCount=function(e,t,n){this._defaultChannelClient.clearUnreadCount(e,t,n)},e.prototype.clearAllUnreadCount=function(e){this._defaultChannelClient.clearAllUnreadCount(e)},e.prototype.setConversationStatus=function(e,t,n,r){return this._defaultChannelClient.setConversationStatus(e,t,n,r)},e.prototype.sendMessage=function(e,t,n,r,i,o,s,a,c){return this._defaultChannelClient.sendMessage(e,t,n,r,i,o,s,c)},e.prototype.sendRecallMessage=function(e,t,n){return this._defaultChannelClient.sendRecallMessage(e,t,n)},e.prototype.sendTypingStatusMessage=function(e,t,n,r){return this._defaultChannelClient.sendTypingStatusMessage(e,t,n,r)},e.prototype.sendReceiptResponse=function(e,t,n){return this._defaultChannelClient.sendReceiptResponse(e,t,n)},e.prototype.sendReadReceiptMessage=function(e,t,n){return this._defaultChannelClient.sendReadReceiptMessage(e,t,n)},e.prototype.getMessageReader=function(e,t,n){this._defaultChannelClient.getMessageReader(e,t,n)},e.prototype.updateMessageExpansion=function(e,t,n){this._defaultChannelClient.updateMessageExpansion(e,t,n)},e.prototype.removeMessageExpansionForKey=function(e,t,n){this._defaultChannelClient.removeMessageExpansionForKey(e,t,n)},e.prototype.getHistoryMessages=function(e,t,n,r,i,o,s){return this._defaultChannelClient.getHistoryMessages(e,t,n,r,i,o,s)},e.prototype.joinChatRoom=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("count",t,kv.NUMBER,!0),Fv("callback",n,kv.CALLBACK),kL.info("joinChatRoom ->chatRoomId:"+e),this._context.joinChatroom(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("joinChatRoom ->code:"+t+",chatRoomId:"+e),WL(n.onError,t))}))},e.prototype.quitChatRoom=function(e,t){Fv("chatRoomId",e,kv.STRING,!0),Fv("callback",t,kv.CALLBACK),kL.info("quitChatRoom ->chatRoomId:"+e),this._context.quitChatroom(e).then((function(n){n===Yg.SUCCESS?YL(t.onSuccess):(kL.warn("quitChatRoom ->code:"+n+",chatRoomId:"+e),WL(t.onError,n))}))},e.prototype.getChatRoomInfo=function(e,t,n,r){Fv("chatRoomId",e,kv.STRING,!0),Fv("count",t,kv.NUMBER,!0),Fv("order",n,kv.NUMBER,!0),Fv("callback",r,kv.CALLBACK),kL.info("getChatRoomInfo ->chatRoomId:"+e),this._context.getChatroomInfo(e,t,n).then((function(t){var n=t.code,i=t.data;n===Yg.SUCCESS?YL(r.onSuccess,{userInfos:(null==i?void 0:i.userInfos)||[],userTotalNums:(null==i?void 0:i.userCount)||0}):(kL.warn("getChatRoomInfo ->code:"+n+",chatRoomId:"+e),WL(r.onError,n))}))},e.prototype.setChatroomEntry=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("chatroomEntry",t,kv.OBJECT,!0),Fv("callback",n,kv.CALLBACK),kL.info("setChatroomEntry ->chatRoomId:"+e),this._context.setChatroomEntry(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("setChatroomEntry ->code:"+t+",chatRoomId:"+e),WL(n.onError,t))}))},e.prototype.setChatRoomEntries=function(e,t,n){if(Fv("chatRoomId",e,kv.STRING,!0),function(e){e.entries.forEach((function(e){Fv("entry.key",e.key,kv.STRING,!0),Fv("entry.value",e.value,kv.STRING,!0)})),Fv("options.isAutoDelete",e.isAutoDelete,kv.BOOLEAN)}(t),Fv("callback",n,kv.CALLBACK),t.entries.length>10)WL(n.onError,Yg.CHATROOM_KV_STORE_OUT_LIMIT);else{var r="id:"+e;kL.info("set chatroom entry->"+r),this._context.setChatroomEntries(e,t).then((function(e){var t=e.code,i=e.data;t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("set chatroom entry fail ->code+:"+t+","+r),WL(n.onError,t,i))}))}},e.prototype.forceSetChatroomEntry=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("chatroomEntry",t,kv.OBJECT,!0),Fv("callback",n,kv.CALLBACK),kL.info("forceSetChatroomEntry ->chatRoomId:"+e),this._context.forceSetChatroomEntry(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("forceSetChatroomEntry ->code:"+t+",chatRoomId:"+e),WL(n.onError,t))}))},e.prototype.removeChatroomEntry=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("chatroomEntry",t,kv.OBJECT,!0),Fv("callback",n,kv.CALLBACK),kL.info("removeChatroomEntry ->chatRoomId:"+e),this._context.removeChatroomEntry(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("removeChatroomEntry ->code:"+t+",chatRoomId:"+e),WL(n.onError,t))}))},e.prototype.removeChatRoomEntries=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),function(e){e.entries.forEach((function(e){Fv("key",e,kv.STRING,!0)}))}(t);var r="id:"+e;kL.debug("remove chatroom entry->"+r);var i=Object.assign({},t);i.entries=t.entries.map((function(e){return{key:e}})),this._context.removeChatroomEntries(e,i).then((function(e){var t=e.code,i=e.data;t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("remove chatroom entry fail ->code+:"+t+","+r),WL(n.onError,t,i))}))},e.prototype.forceRemoveChatroomEntry=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("chatroomEntry",t,kv.OBJECT,!0),Fv("callback",n,kv.CALLBACK),kL.info("forceRemoveChatroomEntry ->chatRoomId:"+e),this._context.forceRemoveChatroomEntry(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess):(kL.warn("forceRemoveChatroomEntry ->code:"+t+",chatRoomId:"+e),WL(n.onError,t))}))},e.prototype.getChatroomEntry=function(e,t,n){Fv("chatRoomId",e,kv.STRING,!0),Fv("key",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),kL.info("getChatroomEntry ->chatRoomId:"+e+",key:"+t),this._context.getChatroomEntry(e,t).then((function(t){var r=t.code,i=t.data;r===Yg.SUCCESS?YL(n.onSuccess,i||""):(kL.warn("getChatroomEntry ->code:"+r+",chatRoomId:"+e),WL(n.onError,r))}))},e.prototype.getAllChatroomEntries=function(e,t){Fv("chatRoomId",e,kv.STRING,!0),Fv("callback",t,kv.CALLBACK),kL.info("getAllChatroomEntries ->chatRoomId:"+e),this._context.getAllChatroomEntries(e).then((function(n){var r=n.code,i=n.data;r===Yg.SUCCESS?YL(t.onSuccess,i):(kL.warn("getAllChatroomEntries ->code:"+r+",chatRoomId:"+e),WL(t.onError,r))}))},e.prototype.getChatRoomHistoryMessages=function(e,t,n,r,i){void 0===i&&(i=0),Fv("chatRoomId",e,kv.STRING,!0),Fv("count",t,kv.NUMBER,!0),Fv("order",n,kv.NUMBER,!0),Fv("callback",r,kv.CALLBACK),Fv("timestamp",i,kv.NUMBER),kL.info("getChatRoomHistoryMessages ->chatRoomId:"+e),this._context.getChatRoomHistoryMessages(e,t,n,i).then((function(t){var n=t.code,i=t.data;if(n===Yg.SUCCESS)if(i){var o=i.list,s=i.hasMore,a=o.map((function(e){return HL(e)}));YL(r.onSuccess,a,s)}else YL(r.onSuccess,[],!1);else kL.warn("getChatRoomHistoryMessages ->code:"+n+",chatRoomId:"+e),WL(r.onError,n)}))},e.prototype.setDeviceInfo=function(e){},e.prototype.getCurrentConnectionStatus=function(){return this._context.getConnectionStatus()},e.prototype.deleteRemoteMessages=function(e,t,n,r){return this._defaultChannelClient.deleteRemoteMessages(e,t,n,r)},e.prototype.clearRemoteHistoryMessages=function(e,t){return this._defaultChannelClient.clearRemoteHistoryMessages(e,t)},e.prototype.getFileToken=function(e,t,n,r,i){Fv("fileType",e,kv.NUMBER,!0),Fv("fileName",n,kv.STRING),Fv("callback",t,kv.CALLBACK),kL.info("getFileToken ->fileType:"+e+",fileName:"+n+",queryString:"+i),this._context.getFileToken(e,n,r,i).then(t.onSuccess).catch(t.onError)},e.prototype.getFileUrl=function(e,t,n,r,i,o){Fv("fileType",e,kv.NUMBER,!0),Fv("fileName",t,kv.STRING,!0),Fv("saveName",n,kv.STRING),Fv("callback",r,kv.CALLBACK),Fv("serverType",o,kv.NUMBER),Fv("uploadRes",i,kv.OBJECT),kL.info("getFileUrl ->fileType:"+e+",fileName:"+t),this._context.getFileUrl(e,t,n,i,o).then(r.onSuccess).catch(r.onError)},e.prototype.createTag=function(e,t){Fv("tag.tagId",e.tagId,kv.STRING,!0),Fv("tag.tagId",e.tagId,(function(e){return e.length<=10})),Fv("tag.tagName",e.tagName,(function(e){return e.length<=15})),Fv("tag.tagName",e.tagName,kv.STRING,!0),Fv("callback",t,kv.CALLBACK),kL.info("createTag ->tagId:"+e.tagId+",tagName:"+e.tagName),this._context.createTag(e).then((function(n){var r=n.code;r===Yg.SUCCESS?t.onSuccess():(kL.warn("createTag ->code:"+r+",tagId:"+e.tagId),t.onError(r))})).catch((function(n){kL.warn("createTag ->code:"+n+",tagId:"+e.tagId),t.onError(n)}))},e.prototype.removeTag=function(e,t){Fv("tagId",e,kv.STRING,!0),Fv("callback",t,kv.CALLBACK),kL.info("removeTag ->tagId:"+e),this._context.removeTag(e).then((function(n){var r=n.code;r===Yg.SUCCESS?t.onSuccess():(kL.warn("removeTag ->code:"+r+",tagId:"+e),t.onError(r))})).catch((function(n){kL.warn("removeTag ->code:"+n+",tagId:"+e),t.onError(n)}))},e.prototype.updateTag=function(e,t){Fv("tag.tagId",e.tagId,kv.STRING,!0),Fv("tag.tagName",e.tagName,kv.STRING,!0),Fv("tag.tagName",e.tagName,(function(e){return e.length<=15})),Fv("callback",t,kv.CALLBACK),kL.info("updateTag ->tagId:"+e.tagId+",tagName:"+e.tagName),this._context.updateTag(e).then((function(n){var r=n.code;r===Yg.SUCCESS?t.onSuccess():(kL.warn("updateTag ->code:"+r+",tagId:"+e.tagId),t.onError(r))})).catch((function(n){kL.warn("updateTag ->reason:"+n+",tagId:"+e.tagId),t.onError(n)}))},e.prototype.getTagList=function(e){Fv("callback",e,kv.CALLBACK),this._context.getTagList().then((function(t){var n=t.code,r=t.data;n===Yg.SUCCESS?e.onSuccess(r||[]):(kL.warn("getTagList ->code:"+n),e.onError(n))})).catch((function(t){kL.warn("getTagList ->reason:"+t),e.onError(t)}))},e.prototype.getTagsForConversation=function(e,t){Fv("conversationType",e.type,kv.NUMBER),Fv("targetId",e.targetId,kv.STRING),Fv("channelId",e.channelId,kv.ONLY_STRING),Fv("callback",t,kv.CALLBACK),kL.info("getTagsForConversation ->targetId:"+e.targetId+",conversationType:"+e.type),this._context.getTagsForConversation(eP(e)).then((function(e){var n=e.code,r=e.data;n===Yg.SUCCESS?t.onSuccess(r||[]):(kL.warn("getTagsForConversation ->code:"+n),t.onError(n))})).catch((function(e){kL.warn("getTagsForConversation ->reason:"+e),t.onError(e)}))},e.prototype.addTagForConversations=function(e,t,n){Fv("tagId",e,kv.STRING,!0),Fv("conversations",t,kv.ARRAY,!0),Fv("callback",n,kv.CALLBACK),t.forEach((function(e){Fv("conversation.type",e.type,kv.NUMBER,!0),Fv("conversation.targetId",e.targetId,kv.STRING,!0),Fv("conversation.channelId",e.channelId,kv.ONLY_STRING)})),kL.info("addTagForConversations ->tagId:"+e),this._context.addTagForConversations(e,t.map((function(e){return eP(e)}))).then((function(t){var r=t.code;t.data,r===Yg.SUCCESS?n.onSuccess():(kL.warn("addTagForConversations ->code:"+r+",tagId:"+e),n.onError(r))})).catch((function(t){kL.warn("addTagForConversations ->reason:"+t+",tagId:"+e),n.onError(t)}))},e.prototype.removeTagForConversations=function(e,t,n){Fv("tagId",e,kv.STRING,!0),Fv("conversations",t,kv.ARRAY,!0),Fv("callback",n,kv.CALLBACK),t.forEach((function(e){Fv("conversation.type",e.type,kv.NUMBER,!0),Fv("conversation.targetId",e.targetId,kv.STRING,!0),Fv("conversation.channelId",e.channelId,kv.ONLY_STRING)})),kL.info("removeTagForConversations ->tagId:"+e),this._context.removeTagForConversations(e,t.map((function(e){return eP(e)}))).then((function(t){var r=t.code;t.data,r===Yg.SUCCESS?n.onSuccess():(kL.warn("removeTagForConversations ->code:"+r+",tagId:"+e),n.onError(r))})).catch((function(t){kL.warn("removeTagForConversations ->reason:"+t+",tagId:"+e),n.onError(t)}))},e.prototype.removeTagsForConversation=function(e,t,n){Fv("conversation.type",e.type,kv.NUMBER,!0),Fv("conversation.targetId",e.targetId,kv.STRING,!0),Fv("conversation.channelId",e.channelId,kv.ONLY_STRING),Fv("tagIds",t,kv.ARRAY,!0),Fv("callback",n,kv.CALLBACK),t.forEach((function(e){Fv("tagId",e,kv.STRING,!0)})),kL.info("removeTagsForConversation ->tagIds:"+t+",targetId:"+e.targetId+",type:"+e.type),this._context.removeTagsForConversation(eP(e),t).then((function(e){var r=e.code;e.data,r===Yg.SUCCESS?n.onSuccess():(kL.warn("removeTagsForConversation ->code:"+r+",tagIds:"+t),n.onError(r))})).catch((function(e){kL.warn("removeTagsForConversation ->reason:"+e+",tagIds:"+t),n.onError(e)}))},e.prototype.getConversationListByTag=function(e,t,n,r){Fv("tagId",e,kv.STRING,!0),Fv("count",t,kv.NUMBER,!0),Fv("startTime",n,kv.NUMBER,!0),Fv("callback",r,kv.CALLBACK,!0),kL.info("getConversationListByTag ->tagId:"+e),this._context.getConversationListByTag(e,n,t).then((function(t){var n=t.code,i=t.data,o=[];n===Yg.SUCCESS?((i=i||[]).forEach((function(e){o.push(function(e){var t=e.channelId,n=e.conversationType,r=e.targetId,i=e.unreadMessageCount,o=e.latestMessage,s=e.isTop,a=e.notificationStatus,c=e.isTopInTag,u=o?HL(o):null,l=u||{};return l.messageType,l.sentTime,l.receivedStatus,l.messageId,{channelId:t||"",conversationType:n,targetId:r,unreadMessageCount:i,latestMessage:u,isTopInTag:c,latestMessageId:null==u?void 0:u.messageId,objectName:null==u?void 0:u.messageType,sentTime:null==u?void 0:u.sentTime,isTop:s,notificationStatus:a,receivedStatus:null==u?void 0:u.receivedStatus}}(e))})),r.onSuccess(o)):(kL.warn("getConversationListByTag ->code:"+n+",tagId:"+e),r.onError(n))})).catch((function(t){kL.warn("getConversationListByTag ->reason:"+t+",tagId:"+e),r.onError(t)}))},e.prototype.getUnreadCountByTag=function(e,t,n){Fv("tagId",e,kv.STRING,!0),Fv("containMuted",t,kv.BOOLEAN,!0),Fv("callback",n,kv.CALLBACK),kL.info("getUnreadCountByTag ->tagId:"+e),this._context.getUnreadCountByTag(e,t).then((function(t){var r=t.code,i=t.data;kL.info(r,i),r===Yg.SUCCESS?n.onSuccess(i||0):(kL.warn("getUnreadCountByTag ->code:"+r+",tagId:"+e),n.onError(r))})).catch((function(t){kL.warn("getUnreadCountByTag ->reason:"+t+",tagId:"+e),n.onError(t)}))},e.prototype.setConversationStatusInTag=function(e,t,n,r){Fv("tagId",e,kv.STRING,!0),Fv("conversation.targetId",t.targetId,kv.STRING,!0),Fv("conversation.type",t.type,kv.NUMBER,!0),Fv("conversation.channelId",t.channelId,kv.ONLY_STRING),Fv("status.isTop",null==n?void 0:n.isTop,kv.BOOLEAN,!0),Fv("callback",r,kv.CALLBACK),kL.info("setConversationStatusInTag ->tagId:"+e+",targetId:"+t.targetId+",type"+t.type),this._context.setConversationStatusInTag(e,eP(t),n).then((function(t){var n=t.code;t.data,n===Yg.SUCCESS?r.onSuccess():(kL.warn("setConversationStatusInTag ->code:"+n+",tagId:"+e),r.onError(n))})).catch((function(t){kL.warn("setConversationStatusInTag ->reason:"+t+",tagId:"+e),r.onError(t)}))},e.prototype.callExtra=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];kL.info("callExtra ->method:"+e),(n=this._context).callExtra.apply(n,fa([e],r,!1)).then((function(n){var r=n.code,i=n.data;if(r!==Yg.SUCCESS)kL.warn("callExtra ->code:"+r),t.onError&&WL(t.onError,r);else{if("getConversationsByPage"===e&&i.forEach((function(e){e.latestMessage=e.latestMessage?HL(e.latestMessage):null})),"getHistoryMessagesByObjectNames"===e){var o=i,s=o.list,a=o.hasMore,c=s.map((function(e){return HL(e)}));return void YL(t.onSuccess,c,a)}t.onSuccess&&YL(t.onSuccess,i)}}))},e.prototype.hasRemoteUnreadMessages=function(e,t){Fv("callback",t,kv.CALLBACK),kL.info("hasRemoteUnreadMessages ->token:"+e),this.assertCPPMode((function(){YL(t.onSuccess,!1)}),"hasRemoteUnreadMessages",t)},e.prototype.setUserStatusListener=function(e,t){var n=this;kL.info("setUserStatusListener ->userIds:"+e.userIds),this.assertCPPMode((function(){n._context.setUserStatusListener(e,t)}),"setUserStatusListener")},e.prototype.setUserStatus=function(e,t){var n=this;Fv("status",e,kv.NUMBER),Fv("callback",t,kv.CALLBACK),kL.info("setUserStatus ->status:"+e),this.assertCPPMode((function(){n._context.setUserStatus(e).then((function(e){e===Yg.SUCCESS?YL(t.onSuccess,!0):(kL.warn("setUserStatus ->code:"+e),WL(t.onError,e))}))}),"setUserStatus",t)},e.prototype.getUserStatus=function(e,t){var n=this;Fv("userId",e,kv.STRING),Fv("callback",t,kv.CALLBACK),kL.info("getUserStatus ->userId:"+e),this.assertCPPMode((function(){n._context.getUserStatus(e).then((function(n){var r=n.code,i=n.data;r===Yg.SUCCESS?YL(t.onSuccess,i):(kL.warn("getUserStatus ->code:"+r+",useerId:"+e),WL(t.onError,r))}))}),"getUserStatus",t)},e.prototype.addToBlacklist=function(e,t){var n=this;Fv("userId",e,kv.STRING),Fv("callback",t,kv.CALLBACK),kL.info("addToBlacklist ->userId:"+e),this.assertCPPMode((function(){n._context.addToBlacklist(e).then((function(n){n===Yg.SUCCESS?YL(t.onSuccess):(kL.warn("addToBlacklist ->code:"+n+",useerId:"+e),WL(t.onError,n))}))}),"addToBlacklist",t)},e.prototype.removeFromBlacklist=function(e,t){var n=this;Fv("userId",e,kv.STRING),Fv("callback",t,kv.CALLBACK),kL.info("removeFromBlacklist ->userId:"+e),this.assertCPPMode((function(){n._context.removeFromBlacklist(e).then((function(n){n===Yg.SUCCESS?YL(t.onSuccess):(kL.warn("removeFromBlacklist ->code:"+n+",useerId:"+e),WL(t.onError,n))}))}),"removeFromBlacklist",t)},e.prototype.getBlacklist=function(e){var t=this;Fv("callback",e,kv.CALLBACK),this.assertCPPMode((function(){t._context.getBlacklist().then((function(t){var n=t.code,r=t.data;n===Yg.SUCCESS?YL(e.onSuccess,r):(kL.warn("getBlacklist ->code:"+n),WL(e.onError,n))}))}),"getBlacklist",e)},e.prototype.getBlacklistStatus=function(e,t){var n=this;Fv("userId",e,kv.STRING),Fv("callback",t,kv.CALLBACK),kL.info("getBlacklistStatus ->userId:"+e),this.assertCPPMode((function(){n._context.getBlacklistStatus(e).then((function(n){var r=n.code,i=n.data;r===Yg.SUCCESS?YL(t.onSuccess,i):(kL.warn("getBlacklistStatus ->code:"+r+",userId:"+e),WL(t.onError,r))}))}),"getBlacklistStatus",t)},e.prototype.insertMessage=function(e,t,n,r,i){var o=this;void 0===i&&(i={}),Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("content.senderUserId",n.senderUserId,kv.STRING,!0),Fv("callback",r,kv.CALLBACK),kL.info("insertMessage ->targetId:"+t+",conversationType:"+e+",senderUserId:"+n.senderUserId),this.assertCPPMode((function(){o._defaultChannelClient.insertMessage(e,t,n,r,i)}),"insertMessage",r)},e.prototype.getRemoteHistoryMessages=function(e,t,n,r,i,o){var s=this;void 0===o&&(o={}),Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("timestamp",n,kv.NUMBER,!0),Fv("count",r,kv.NUMBER,!0),Fv("callback",i,kv.CALLBACK),Fv("options.order",o.order,kv.NUMBER),this.assertCPPMode((function(){s._defaultChannelClient.getRemoteHistoryMessages(e,t,n,r,i,o)}),"getRemoteHistoryMessages",i)},e.prototype.deleteLocalMessages=function(e,t,n,r){var i=this;Fv("messageIds",n,kv.ARRAY,!0),Fv("callback",r,kv.CALLBACK),kL.info("deleteLocalMessages ->messageIds:"+n),this.assertCPPMode((function(){i._context.deleteMessages(n).then((function(e){e===Yg.SUCCESS?YL(r.onSuccess,!0):(kL.warn("deleteLocalMessages ->code:"+e+",messageIds:"+n),WL(r.onError,e))}))}),"deleteLocalMessages",r)},e.prototype.deleteLocalMessagesByTimestamp=function(e,t,n,r,i){var o=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("timestamp",n,kv.NUMBER,!0),Fv("cleanSpace",r,kv.BOOLEAN),Fv("callback",i,kv.CALLBACK),this.assertCPPMode((function(){o._defaultChannelClient.deleteLocalMessagesByTimestamp(e,t,n,r,i)}),"deleteLocalMessagesByTimestamp",i)},e.prototype.clearMessages=function(e,t,n){var r=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("callback",n,kv.CALLBACK),this.assertCPPMode((function(){r._defaultChannelClient.clearMessages(e,t,n)}),"clearMessages",n)},e.prototype.getMessage=function(e,t){var n=this;Fv("callback",t,kv.CALLBACK),this.assertCPPMode((function(){n._context.getMessage(e).then((function(n){var r=n.code,i=n.data;r===Yg.SUCCESS?YL(t.onSuccess,HL(i)):(kL.warn("getMessage ->code:"+r+",messageId:"+e),WL(t.onError,r))}))}),"getMessage",t)},e.prototype.setMessageSentStatus=function(e,t,n){var r=this;Fv("messageId",e,kv.NUMBER,!0),Fv("sentStatus",t,kv.NUMBER,!0),kL.info("setMessageSentStatus ->messageId:"+e+",sentStatus:"+t),this.assertCPPMode((function(){r._context.setMessageSentStatus(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess,!0):(kL.warn("setMessageSentStatus ->code:"+t+",messageId:"+e),WL(n.onError,t))}))}),"setMessageSentStatus",n)},e.prototype.setMessageReceivedStatus=function(e,t,n){var r=this;Fv("messageId",e,kv.NUMBER,!0),Fv("receivedStatus",t,kv.NUMBER,!0),kL.info("setMessageReceivedStatus ->messageId:"+e+",receivedStatus:"+t),this.assertCPPMode((function(){r._context.setMessageReceivedStatus(e,t).then((function(t){t===Yg.SUCCESS?YL(n.onSuccess,!0):(kL.warn("setMessageReceivedStatus ->code:"+t+",messageId:"+e),WL(n.onError,t))}))}),"setMessageReceivedStatus",n)},e.prototype.setMessageContent=function(e,t,n){var r=this;Fv("messageId",e,kv.NUMBER,!0),Fv("objectName",n,kv.ONLY_STRING,!0),kL.info("setMessageContent ->messageId:"+e+",objectName:"+n),this.assertCPPMode((function(){r._context.setMessageContent(e,t,n)}),"setMessageContent")},e.prototype.setMessageSearchField=function(e,t,n){var r=this;Fv("messageId",e,kv.NUMBER,!0),Fv("searchFiles",n,kv.STRING,!0),kL.info("setMessageSearchField ->messageId:"+e+",searchFiles:"+n),this.assertCPPMode((function(){r._context.setMessageSearchField(e,t,n)}),"setMessageSearchField")},e.prototype.searchConversationByContent=function(e,t,n,r){var i=this;Fv("keyword",e,kv.STRING,!0),Fv("callback",t,kv.CALLBACK),Fv("conversationTypes",n,kv.ARRAY),Fv("customMessageType",r,kv.ARRAY),this.assertCPPMode((function(){i._defaultChannelClient.searchConversationByContent(e,t,n,r)}),"searchConversationByContent",t)},e.prototype.searchMessageByContent=function(e,t,n,r,i,o,s){var a=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("keyword",n,kv.STRING,!0),Fv("timestamp",r,kv.NUMBER),Fv("count",i,kv.NUMBER),Fv("total",o,kv.NUMBER),Fv("callback",s,kv.CALLBACK),this.assertCPPMode((function(){a._defaultChannelClient.searchMessageByContent(e,t,n,r,i,o,s)}),"searchMessageByContent",s)},e.prototype.getUnreadMentionedMessages=function(e,t){return this._isCPPMode?(Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),this._defaultChannelClient.getUnreadMentionedMessages(e,t)):(kL.error("getUnreadMentionedMessages method is not supported in a browser!"),null)},e.prototype.clearUnreadCountByTimestamp=function(e,t,n,r){var i=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),Fv("timestamp",n,kv.NUMBER,!0),this.assertCPPMode((function(){i._defaultChannelClient.clearUnreadCountByTimestamp(e,t,n,r)}),"clearUnreadCountByTimestamp",r)},e.prototype.getFirstUnreadMessage=function(e,t,n){return this._defaultChannelClient.getFirstUnreadMessage(e,t,n)},e.prototype.getConversationNotificationStatus=function(e,t,n){var r=this;Fv("conversationType",e,kv.NUMBER,!0),Fv("targetId",t,kv.STRING,!0),this.assertCPPMode((function(){r._defaultChannelClient.getConversationNotificationStatus(e,t,n)}),"getConversationNotificationStatus",n)},e.prototype.getServerTime=function(){return this._context.getServerTime()},e.prototype.getRTCUserInfoList=function(e,t){kL.info("getRTCUserInfoList ->roomId:"+e.id),this._context.getRTCUserInfoList(e.id).then((function(n){var r=n.code,i=n.data;if(r!==Yg.SUCCESS)kL.warn("getRTCUserInfoList ->code:"+r+",roomId:"+e.id),t.onError(r);else{var o=null==i?void 0:i.users;t.onSuccess(o)}})).catch((function(n){kL.warn("getRTCUserInfoList ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.getRTCUserList=function(e,t){kL.info("getRTCUserList ->roomId:"+e.id),this._context.getRTCUserList(e.id).then((function(n){var r=n.code,i=n.data;r!==Yg.SUCCESS?(kL.warn("getRTCUserList ->code:"+r+",roomId:"+e.id),t.onError(r)):t.onSuccess(i)})).catch((function(n){kL.warn("getRTCUserList ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.setRTCUserInfo=function(e,t,n){kL.info("setRTCUserInfo ->roomId:"+e.id+",info:"+JSON.stringify(t||{})),this._context.setRTCUserInfo(e.id,t.key,t.value).then((function(r){r!==Yg.SUCCESS?(kL.warn("setRTCUserInfo ->code:"+r+",roomId:"+e.id+",key:"+t.key+",value:"+t.value),n.onError(r)):n.onSuccess(!0)})).catch((function(r){kL.warn("setRTCUserInfo ->code:"+r+",roomId:"+e.id+",key:"+t.key+",value:"+t.value),n.onError(r)}))},e.prototype.removeRTCUserInfo=function(e,t,n){kL.info("removeRTCUserInfo ->roomId:"+e.id+"keys:"+t.keys),this._context.removeRTCUserInfo(e.id,t.keys).then((function(t){t!==Yg.SUCCESS?(kL.warn("removeRTCUserInfo ->code:"+t+",roomId:"+e.id),n.onError(t)):n.onSuccess(!0)})).catch((function(t){kL.warn("removeRTCUserInfo ->error:"+t+",roomId:"+e.id),n.onError(t)}))},e.prototype.getRTCRoomInfo=function(e,t){kL.info("getRTCRoomInfo ->roomId:"+e.id),this._context.getRTCRoomInfo(e.id).then((function(n){var r=n.code,i=n.data;r!==Yg.SUCCESS?(kL.warn("getRTCRoomInfo ->code:"+r+",roomId:"+e.id),t.onError(r)):t.onSuccess(i)})).catch((function(n){kL.warn("getRTCRoomInfo ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.setRTCRoomInfo=function(e,t,n){throw ga("setRTCRoomInfo")},e.prototype.removeRTCRoomInfo=function(e,t,n){throw ga("removeRTCRoomInfo")},e.prototype.joinRTCRoom=function(e,t){kL.info("joinRTCRoom ->roomId:"+e.id);var n=e.mode||0;this._context.joinRTCRoom(e.id,n).then((function(n){var r=n.code,i=n.data;r!==Yg.SUCCESS?(kL.warn("joinRTCRoom ->code:"+r+",roomId:"+e.id),t.onError(r)):t.onSuccess(i)})).catch((function(n){kL.warn("joinRTCRoom ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.quitRTCRoom=function(e,t){kL.info("quitRTCRoom ->roomId:"+e.id),this._context.quitRTCRoom(e.id).then((function(n){n!==Yg.SUCCESS?(kL.warn("quitRTCRoom ->code:"+n+",roomId:"+e.id),t.onError(n)):t.onSuccess(!0)})).catch((function(n){kL.warn("quitRTCRoom ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.RTCPing=function(e,t){kL.info("RTCPing ->roomId:"+e.id);var n=e.mode||0;this._context.rtcPing(e.id,n).then((function(n){n!==Yg.SUCCESS?(kL.warn("RTCPing ->code:"+n+",roomId:"+e.id),t.onError(n)):t.onSuccess(!0)})).catch((function(n){kL.warn("RTCPing ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.setRTCData=function(e,t,n,r,i,o,s){kL.info("setRTCData ->roomId:"+e+",key:"+t),this._context.setRTCData(e,t,n,r,i,s).then((function(t){t!==Yg.SUCCESS?(kL.warn("setRTCData ->code:"+t+",roomId:"+e),o.onError(t)):o.onSuccess(!0)})).catch((function(t){kL.warn("setRTCData ->error:"+t+",roomId:"+e),o.onError(t)}))},e.prototype.getRTCData=function(e,t,n,r,i){kL.info("getRTCData ->roomId:"+e+",keys:"+t),this._context.getRTCData(e,t,n,r).then((function(t){var n=t.code,r=t.data;n!==Yg.SUCCESS?(kL.warn("getRTCData ->code:"+n+",roomId:"+e),i.onError(n)):i.onSuccess(r)})).catch((function(t){kL.warn("setRTCUserInfo ->error:"+t+",roomId:"+e),i.onError(t)}))},e.prototype.removeRTCData=function(e,t,n,r,i,o){kL.info("removeRTCData ->roomId:"+e+",keys:"+t),this._context.removeRTCData(e,t,n,r,o).then((function(t){t!==Yg.SUCCESS?(kL.warn("removeRTCData ->code:"+t+",roomId:"+e),i.onError(t)):i.onSuccess(!0)})).catch((function(t){kL.warn("removeRTCData ->error:"+t+",roomId:"+e),i.onError(t)}))},e.prototype.setRTCUserData=function(e,t,n,r,i,o){this.setRTCData(e,t,n,r,vv.PERSON,i,o)},e.prototype.setRTCUserTotalRes=function(e,t,n,r,i){kL.info("setRTCUserTotalRes ->roomId:"+e),this._context.setRTCTotalRes(e,t,n,r).then((function(t){t!==Yg.SUCCESS?(kL.warn("setRTCUserTotalRes ->code:"+t+",roomId:"+e),i.onError(t)):i.onSuccess(!0)})).catch((function(t){kL.warn("setRTCUserTotalRes ->error:"+t+",roomId:"+e),i.onError(t)}))},e.prototype.getRTCUserData=function(e,t,n,r){this.getRTCData(e,t,n,vv.PERSON,r)},e.prototype.removeRTCUserData=function(e,t,n,r,i){this.removeRTCData(e,t,n,vv.PERSON,r,i)},e.prototype.setRTCRoomData=function(e,t,n,r,i,o){this.setRTCData(e,t,n,r,vv.ROOM,i,o)},e.prototype.getRTCRoomData=function(e,t,n,r){this.getRTCData(e,t,n,vv.ROOM,r)},e.prototype.removeRTCRoomData=function(e,t,n,r,i){this.removeRTCData(e,t,n,vv.ROOM,r,i)},e.prototype.setRTCOutData=function(e,t,n,r,i){throw ga("setRTCOutData")},e.prototype.getRTCOutData=function(e,t,n){throw ga("getRTCOutData")},e.prototype.getRTCToken=function(e,t){kL.info("getRTCToken ->roomId:"+e.id),this._context.getRTCToken(e.id,e.mode,e.broadcastType).then((function(n){var r=n.code,i=n.data;r!==Yg.SUCCESS?(kL.warn("getRTCToken ->code:"+r+",roomId:"+e.id),t.onError(r)):t.onSuccess(i)})).catch((function(n){kL.warn("getRTCToken ->error:"+n+",roomId:"+e.id),t.onError(n)}))},e.prototype.setRTCState=function(e,t,n){kL.info("setRTCState ->roomId:"+e.id),this._context.setRTCState(e.id,t.report).then((function(t){t!==Yg.SUCCESS?(kL.warn("setRTCState ->code:"+t+",roomId:"+e.id),n.onError(t)):n.onSuccess(!0)})).catch((function(t){kL.warn("setRTCState ->error:"+t+",roomId:"+e.id),n.onError(t)}))},e}(),nP=[],rP=[],iP={message:function(e){nP.forEach((function(t){return t(HL(e))}))},status:function(e){rP.forEach((function(t){return t(e)}))}},oP=1;Vv.add("imlib-v2-adapter","5.3.3");var sP,aP={init:function(e,t,n){void 0===n&&(n={}),Fv("appkey",e,kv.STRING,!0),kL.setLogLevel(n.logLevel),kL.setLogStdout(n.logStdout),kL.info("RongIMLib Version: ".concat("5.3.3",", Commit: ").concat("925bcb5e5bdb7b280cfecb8939ec6f729242cbcb",",appkey:")+e);var r=null==n?void 0:n.connectionType;r?Ys.WEBSOCKET!==r&&Ys.COMET!==r&&(kL.warn("RongIMLib connectionType must be ".concat(Ys.WEBSOCKET," or ").concat(Ys.COMET)),r=Ys.WEBSOCKET):r=Ys.WEBSOCKET,XL=aL.init(xL,{appkey:e,apiVersion:"5.3.3",navigators:n.navi?[n.navi]:[],miniCMPProxy:[],connectionType:r,logLevel:n.logLevel,logStdout:n.logStdout,typingExpireTime:n.typingExpireTime,indexDBSwitch:n.indexDBSwitch,checkCA:n.checkCA}),oP=Math.min(15,Math.max(n.readReceiptTimeout||1,1)),zL=new tP(XL,{readReceiptTimeout:oP})},getInstance:function(){return zL},setConnectionStatusListener:function(e){XL.assignWatcher({connectionState:function(t){BL.clear(),e.onChanged(t)}})},setOnReceiveMessageListener:function(e){XL.assignWatcher({message:function(t,n,r){try{var i=HL(t),o=XL.getCurrentUserId(),s=XL.getConnectedTime();jL(i,o,s,oP),i=function(e,t,n,r){var i=new Date(n-1e3*r*60*60*24).getTime()-e.sentTime<0;if("ReadReceiptResponseMessage"!==e.messageType||!i)return e;var o=e.content,s=((o=o||{}).receiptMessageDic||{})[t],a="",c={};if(e.receiptResponse||(e.receiptResponse={}),s){for(var u=[],l=0;l<s.length;l++)a="".concat(t).concat(s[l],"SENT"),(c=KL.get(a))&&!(e.senderUserId in c.userIds)&&(u.push(s[l]),c.count+=1,c.userIds[e.senderUserId]=e.sentTime,e.receiptResponse[s[l]]=c.count,KL.set(a,c));o.receiptMessageDic[t]=u,e.content=o}return e}(i,o,s,oP),Qy()||BL.set(t),e.onReceived(i,void 0,r)}catch(e){kL.error("setOnReceiveMessageListener ->error:"+e)}}})},setConversationStatusListener:function(e){XL.assignWatcher({conversationState:function(t){try{var n=[];t.forEach((function(e){var t=e.updatedItems,r=e.conversationType,i=e.targetId,o=e.channelId,s=(t=t||{}).notificationStatus,a=t.isTop;s&&a&&n.push({notificationStatus:s.val,isTop:a.val,conversationType:r,targetId:i,channelId:o||"",updatedTime:s.time})})),n.length>0&&e.onChanged(n)}catch(e){kL.error("setConversationStatusListener ->error:"+e)}}})},setMessageExpansionListener:function(e){XL.assignWatcher({expansion:function(t){try{t.updatedExpansion&&e.onUpdated(t.updatedExpansion),t.deletedExpansion&&e.onDeleted(t.deletedExpansion)}catch(e){kL.error("setMessageExpansionListener ->error:"+e)}}})},setTagListener:function(e){XL.assignWatcher({tag:function(){e.onChanged()}})},setConversationTagListener:function(e){XL.assignWatcher({conversationTagChanged:function(){e.onChanged()}})},setPullOffLineFinished:function(e){XL.assignWatcher({pullFinished:function(){e.onFinished()}})},setTypingStatusListener:function(e){XL.assignWatcher({typingState:function(t){e.onChanged(t)}})},setMessageBlockedListener:function(e){XL.assignWatcher({messageBlocked:function(t){e.onReceived(t)}})},setChatRoomStatusListener:function(e){XL.assignWatcher({chatroomState:function(t){e.onChanged(t)}})},connect:function(e,t){return ha(this,void 0,void 0,(function(){var n,r;return da(this,(function(i){switch(i.label){case 0:return kL.info("connect ->token:"+e),[4,XL.connect(e)];case 1:return(n=i.sent()).code===Yg.SUCCESS?(t.onSuccess(n.userId),r=new Date(XL.getConnectedTime()-1e3*oP*60*60*24).getTime(),KL.getKeys().forEach((function(e){if(/SENT$/.test(e)){var t=KL.get(e).dealtime;t&&r-t>0&&KL.remove(e)}else if(/RECEIVED$/.test(e)){var n=KL.get(e),i=Object.keys(n).length;Object.keys(n).forEach((function(e){var t=n[e].dealtime;t&&r-t>0&&delete n[e]})),Object.keys(n).length!==i&&(0===n.length?KL.remove(e):KL.set(e,n))}}))):n.code===Yg.RC_CONN_USER_OR_PASSWD_ERROR?(kL.warn("connect ->code:"+n.code+",token:"+e),t.onTokenIncorrect()):(kL.warn("connect ->code:"+n.code+",token:"+e),t.onError(n.code)),[2]}}))}))},reconnect:function(e,t){XL.reconnect().then((function(t){t.code===Yg.SUCCESS?e.onSuccess(t.userId):(kL.warn("reconnect ->code:"+t.code),e.onError(t.code))})).catch(e.onError)},RegisterMessage:{},RegisterMessageTypeMapping:FL,getMessageObjectName:function(e){var t=la(la({},GL),FL);return Object.keys(t).find((function(n){return t[n]===e}))||e},registerMessageType:function(e,t,n,r){this.RegisterMessage[e]=JL(e,t,n.isPersited,n.isCounted),this.RegisterMessageTypeMapping[t]=e,XL.registerMessageType(t,n.isPersited,n.isCounted,r)},createLogger:function(e,t){return/^(RC)/.test(e)?(kL.error("Tag error. Tags that start with RC are used internally by the SDK !"),null):["IM","RTC"].includes(t)?new Sg(e,t,"A"):(kL.error("The parameter type must be one of IM, or RTC !"),null)},messageWatch:function(e){var t=this;nP.push((function(n){kL.info("messageWatch ->message:"+JSON.stringify(n||{}));try{e(n),t._voipProvider.onReceived&&t._voipProvider.onReceived(n)}catch(e){kL.error("messageWatch ->error:"+e)}})),XL.assignWatcher({rtcInnerWatcher:iP})},statusWatch:function(e){rP.push((function(t){kL.info("statusWatch ->status:"+t);try{e(t)}catch(e){kL.error("statusWatch ->error:"+e)}}))},MessageType:{TextMessage:"TextMessage",ImageMessage:"ImageMessage",ReferenceMessage:"ReferenceMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage",TypingStatusMessage:"TypingStatusMessage",ChangeModeResponseMessage:"ChangeModeResponseMessage",ChangeModeMessage:"ChangeModeMessage",EvaluateMessage:"EvaluateMessage",HandShakeMessage:"HandShakeMessage",HandShakeResponseMessage:"HandShakeResponseMessage",SuspendMessage:"SuspendMessage",TerminateMessage:"TerminateMessage",CustomerContact:"CustomerContact",CustomerStatusUpdateMessage:"CustomerStatusUpdateMessage",SyncReadStatusMessage:"SyncReadStatusMessage",ReadReceiptRequestMessage:"ReadReceiptRequestMessage",ReadReceiptResponseMessage:"ReadReceiptResponseMessage",FileMessage:"FileMessage",HQVoiceMessage:"HQVoiceMessage",GIFMessage:"GIFMessage",SightMessage:"SightMessage",AcceptMessage:"AcceptMessage",RingingMessage:"RingingMessage",SummaryMessage:"SummaryMessage",HungupMessage:"HungupMessage",InviteMessage:"InviteMessage",MediaModifyMessage:"MediaModifyMessage",MemberModifyMessage:"MemberModifyMessage",JrmfRedPacketMessage:"JrmfRedPacketMessage",JrmfRedPacketOpenedMessage:"JrmfRedPacketOpenedMessage",GroupNotificationMessage:"GroupNotificationMessage",PublicServiceRichContentMessage:"PublicServiceRichContentMessage",PublicServiceMultiRichContentMessage:"PublicServiceMultiRichContentMessage",PublicServiceCommandMessage:"PublicServiceCommandMessage",RecallCommandMessage:"RecallCommandMessage",ReadReceiptMessage:"ReadReceiptMessage",RCCombineMessage:"RCCombineMessage",ChrmKVNotificationMessage:"ChrmKVNotificationMessage",LogCommandMessage:"LogCommandMessage"},_voipProvider:{}},cP=function(e,t,n){this.type=e,this.userIdList=t,this.mentionedContent=n},uP=function(e,t){this.isCounted=e,this.isPersited=t},lP=JL("TextMessage","RC:TxtMsg"),hP=JL("LocationMessage","RC:LBSMsg"),dP=JL("TypingStatusMessage","RC:TypSts"),fP=JL("ImageMessage","RC:ImgMsg"),pP=JL("RichContentMessage","RC:ImgTextMsg"),gP=JL("VoiceMessage","RC:VcMsg"),vP=JL("HQVoiceMessage","RC:HQVCMsg"),yP=JL("FileMessage","RC:FileMsg"),mP=JL("SightMessage","RC:SightMsg"),_P=JL("GIFMessage","RC:GIFMsg"),CP=JL("ReadReceiptMessage","RC:ReadNtf"),EP=JL("ReadReceiptRequestMessage","RC:RRReqMsg"),TP=JL("RCCombineMessage","RC:CombineMsg"),IP=function(e,t,n,r,i,o,s,a,c,u,l,h,d,f,p,g,v,y){this.conversationType=e,this.targetId=t,this.senderUserId=n,this.content=r,this.objectName=i,this.messageType=o,this.messageId=s,this.messageUId=a,this.messageDirection=c,this.offLineMessage=u,this.sentStatus=l,this.sentTime=h,this.receivedStatus=d,this.receivedTime=f,this.canIncludeExpansion=p,this.expansion=g,this.receiptResponse=v,this.disableNotification=y};e.VoIPMediaType=void 0,(sP=e.VoIPMediaType||(e.VoIPMediaType={}))[sP.MEDIA_AUDIO=1]="MEDIA_AUDIO",sP[sP.MEDIA_VEDIO=2]="MEDIA_VEDIO",sP[sP.MEDIA_VIDEO=2]="MEDIA_VIDEO";var RP,SP=JL("AcceptMessage","RC:VCAccept"),MP=JL("RingingMessage","RC:VCRinging"),NP=JL("SummaryMessage","RC:VCSummary"),OP=JL("HungupMessage","RC:VCHangup"),wP=JL("InviteMessage","RC:VCInvite"),AP=JL("MediaModifyMessage","RC:VCModifyMedia"),UP=JL("MemberModifyMessage","RC:VCModifyMem"),bP=JL("lastMessageSendTime","RC:SRSMsg"),LP=JL("ReferenceMessage","RC:ReferenceMsg");!function(e){e[e.ALL=1]="ALL",e[e.PART=2]="PART"}(RP||(RP={}));var PP=RP,DP=JL("PublicServiceRichContentMessage","RC:PSImgTxtMsg"),xP=JL("PublicServiceMultiRichContentMessage","RC:PSMultiImgTxtMsg"),kP=Jg;window&&(window.RongIMClient=aP),e.AcceptMessage=SP,e.ChannelClient=$L,e.ConnectionState=kP,e.ConnectionStatus=Qg,e.ConversationType=ng,e.ErrorCode=Yg,e.FileMessage=yP,e.FileType=cg,e.GIFMessage=_P,e.GetChatRoomType=dL,e.HQVoiceMessage=vP,e.HungupMessage=OP,e.IMClient=tP,e.ImageMessage=fP,e.InviteMessage=wP,e.LocationMessage=hP,e.MediaModifyMessage=AP,e.MemberModifyMessage=UP,e.MentionedInfo=cP,e.MentionedType=PP,e.Message=IP,e.MessageDirection=Hg,e.MessageTag=uP,e.PublicServiceMultiRichContentMessage=xP,e.PublicServiceRichContentMessage=DP,e.RCCombineMessage=TP,e.ReadReceiptMessage=CP,e.ReadReceiptRequestMessage=EP,e.ReadReceiptResponseMessage=ZL,e.ReceivedStatus=Jr,e.ReferenceMessage=LP,e.RichContentMessage=pP,e.RingingMessage=MP,e.RongIMClient=aP,e.SentStatus=hL,e.SightMessage=mP,e.SummaryMessage=NP,e.SyncReadStatusMessage=bP,e.TextMessage=lP,e.TypingStatusMessage=dP,e.UploadMethod=ov,e.VoiceMessage=gP,Object.defineProperty(e,"__esModule",{value:!0})}));
